{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Neovim version (nvim -v)\n\nv0.7.0-dev+nightly-1466-g08616571f\n\n### Language server name/version\n\nany\n\n### Operating system/version\n\nMacOS\n\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\n\nOpen a buffer\r\nDelete the buffer\r\n:LspInfo\r\n\r\n-> Buffer is still attached to the client\n\n### Expected behavior\n\nAfter deleting the buffer, the buffer should also be detached from the client\r\n\r\n\r\nThis seems to do the trick but I expect this to be in neovim core:\r\n```lua\r\nfunction DetachBufferFromClients(bufnr)\r\n  local clients = vim.lsp.buf_get_clients(bufnr)\r\n  for client_id, _ in pairs(clients) do\r\n    vim.lsp.buf_detach_client(bufnr, client_id)\r\n  end\r\nend\r\nautocmd BufDelete <buffer> lua DetachBufferFromClients(tonumber(vim.fn.expand(\"<abuf>\")))\r\n```\n\n### Actual behavior\n\nIt doesn't detach the buffer from the client on BufDelete\n\n### Log file\n\n_No response_",
    "closed_at": "2022-08-31T14:17:44Z",
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "With `:bd` the buffer isn't completely deleted, it just removes the buffer from the buffer list (see `:help unlisted buffer`). I don't see why we would forcibly detach the buffer from the client when the buffer is unloaded (this doesn't buy you anything, it only adds additional latency for the next time you call a definition request). I only added the buf_detach_client function because it was requested, I really don't want to surface this to users.\r\n\r\nWe also don't map any autocommands (or auto-anything) by convention with the client in core, if users want `:bd` to have side effects for the built-in client I'd rather they explicitly opt-in by mapping their own autocommand.",
            "created_at": "2022-01-13T10:18:33Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1011992984",
            "id": 1011992984,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC1848UcmY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1011992984/reactions"
            },
            "updated_at": "2022-01-13T10:23:56Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1011992984",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/13316262?v=4",
                "events_url": "https://api.github.com/users/mjlbach/events{/privacy}",
                "followers_url": "https://api.github.com/users/mjlbach/followers",
                "following_url": "https://api.github.com/users/mjlbach/following{/other_user}",
                "gists_url": "https://api.github.com/users/mjlbach/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mjlbach",
                "id": 13316262,
                "login": "mjlbach",
                "node_id": "MDQ6VXNlcjEzMzE2MjYy",
                "organizations_url": "https://api.github.com/users/mjlbach/orgs",
                "received_events_url": "https://api.github.com/users/mjlbach/received_events",
                "repos_url": "https://api.github.com/users/mjlbach/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mjlbach/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mjlbach/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mjlbach"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Even when the buffer is wiped-out, it's still connected to the LSP client at the moment. And with the above fix in place, the buffer is still attached again when it's re-listed.\r\n\r\nI noticed neovim was getting slow and it was because I used \"go to definition\" which was in a definition file where the formatting was not as expected by my eslint lsp server so it was sending large json with diagnostics all the time for this file that was not even shown anymore. \r\n\r\n> We also don't map any autocommands (or auto-anything) by convention with the client in core\r\n\r\nWho's attaching the client then on buffer load? Is this done by nvim-lspconfig? Do you think it belongs there instead? ",
            "created_at": "2022-01-13T10:42:51Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1012012535",
            "id": 1012012535,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC1848UhX3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1012012535/reactions"
            },
            "updated_at": "2022-01-13T10:42:51Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1012012535",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/896093?v=4",
                "events_url": "https://api.github.com/users/entropitor/events{/privacy}",
                "followers_url": "https://api.github.com/users/entropitor/followers",
                "following_url": "https://api.github.com/users/entropitor/following{/other_user}",
                "gists_url": "https://api.github.com/users/entropitor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/entropitor",
                "id": 896093,
                "login": "entropitor",
                "node_id": "MDQ6VXNlcjg5NjA5Mw==",
                "organizations_url": "https://api.github.com/users/entropitor/orgs",
                "received_events_url": "https://api.github.com/users/entropitor/received_events",
                "repos_url": "https://api.github.com/users/entropitor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/entropitor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/entropitor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/entropitor"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> ho's attaching the client then on buffer load? Is this done by nvim-lspconfig? \r\n\r\nYes\r\n\r\n> Do you think it belongs there instead?\r\n\r\nI am still not convinced this should be the default behavior, it's pretty easily added via autocommand.\r\n\r\n> \r\n\r\nI noticed neovim was getting slow and it was because I used \"go to definition\" which was in a definition file where the formatting was not as expected by my eslint lsp server so it was sending large json with diagnostics all the time for this file that was not even shown anymore.\r\n\r\nHmm, that surprises me. Our json encoder is extremely fast.",
            "created_at": "2022-01-14T16:19:00Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1013264671",
            "id": 1013264671,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC1848ZTEf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1013264671/reactions"
            },
            "updated_at": "2022-01-14T16:19:00Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1013264671",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/13316262?v=4",
                "events_url": "https://api.github.com/users/mjlbach/events{/privacy}",
                "followers_url": "https://api.github.com/users/mjlbach/followers",
                "following_url": "https://api.github.com/users/mjlbach/following{/other_user}",
                "gists_url": "https://api.github.com/users/mjlbach/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mjlbach",
                "id": 13316262,
                "login": "mjlbach",
                "node_id": "MDQ6VXNlcjEzMzE2MjYy",
                "organizations_url": "https://api.github.com/users/mjlbach/orgs",
                "received_events_url": "https://api.github.com/users/mjlbach/received_events",
                "repos_url": "https://api.github.com/users/mjlbach/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mjlbach/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mjlbach/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mjlbach"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@entropitor  does this problem still exists?",
            "created_at": "2022-08-23T11:18:28Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1223923978",
            "id": 1223923978,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185I85kK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1223923978/reactions"
            },
            "updated_at": "2022-08-23T11:18:28Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1223923978",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@glepnir yes, this issue still exists for me",
            "created_at": "2022-08-31T13:32:26Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1232944650",
            "id": 1232944650,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185JfT4K",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1232944650/reactions"
            },
            "updated_at": "2022-08-31T13:32:26Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1232944650",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/896093?v=4",
                "events_url": "https://api.github.com/users/entropitor/events{/privacy}",
                "followers_url": "https://api.github.com/users/entropitor/followers",
                "following_url": "https://api.github.com/users/entropitor/following{/other_user}",
                "gists_url": "https://api.github.com/users/entropitor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/entropitor",
                "id": 896093,
                "login": "entropitor",
                "node_id": "MDQ6VXNlcjg5NjA5Mw==",
                "organizations_url": "https://api.github.com/users/entropitor/orgs",
                "received_events_url": "https://api.github.com/users/entropitor/received_events",
                "repos_url": "https://api.github.com/users/entropitor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/entropitor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/entropitor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/entropitor"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I can reproduce with an error throw out.",
            "created_at": "2022-08-31T14:05:38Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1232985836",
            "id": 1232985836,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185Jfd7s",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1232985836/reactions"
            },
            "updated_at": "2022-08-31T14:05:38Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1232985836",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "closed. open in https://github.com/neovim/neovim/issues/20025",
            "created_at": "2022-08-31T14:17:44Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1233000692",
            "id": 1233000692,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185Jfhj0",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233000692/reactions"
            },
            "updated_at": "2022-08-31T14:17:44Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233000692",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "For me, the work-around works just fine (not erroring). The problem I was raising was that I'd expect it to be part of this repo / neovim-core. Not something every user would have to do themselves...",
            "created_at": "2022-08-31T15:27:05Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1233088671",
            "id": 1233088671,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185Jf3Cf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233088671/reactions"
            },
            "updated_at": "2022-08-31T15:27:05Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233088671",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/896093?v=4",
                "events_url": "https://api.github.com/users/entropitor/events{/privacy}",
                "followers_url": "https://api.github.com/users/entropitor/followers",
                "following_url": "https://api.github.com/users/entropitor/following{/other_user}",
                "gists_url": "https://api.github.com/users/entropitor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/entropitor",
                "id": 896093,
                "login": "entropitor",
                "node_id": "MDQ6VXNlcjg5NjA5Mw==",
                "organizations_url": "https://api.github.com/users/entropitor/orgs",
                "received_events_url": "https://api.github.com/users/entropitor/received_events",
                "repos_url": "https://api.github.com/users/entropitor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/entropitor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/entropitor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/entropitor"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@entropitor  right . it not remove the buffer from on_detach callback. ",
            "created_at": "2022-08-31T22:21:31Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1233478835",
            "id": 1233478835,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185JhWSz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233478835/reactions"
            },
            "updated_at": "2022-08-31T22:21:31Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233478835",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "on my test both not work . so before I deal this on upstream I wonder these test work for you @entropitor ?  you said that patch work for you . no error but the buffer still exist on attached buffers\r\n\r\n```vim\r\nset rtp+=~/Workspace/nvim-lspconfig/\r\n\r\nlua << EOF\r\nlocal lspconfig = require('lspconfig')\r\nlspconfig.sumneko_lua.setup{}\r\n\r\nfunction DetachBufferFromClients(bufnr)\r\n  local clients = vim.lsp.buf_get_clients(bufnr)\r\n  for client_id, _ in pairs(clients) do\r\n    vim.lsp.buf_detach_client(bufnr, client_id)\r\n  end\r\nend\r\nEOF\r\n\r\nautocmd LspAttach * autocmd BufDelete <buffer> lua DetachBufferFromClients(tonumber(vim.fn.expand(\"<abuf>\")))\r\n```\r\n\r\n```lua\r\nvim.opt.runtimepath:append('~/Workspace/nvim-lspconfig/')\r\n\r\nlocal lspconfig = require('lspconfig')\r\nlspconfig.sumneko_lua.setup{}\r\nlspconfig.tsserver.setup{}\r\n\r\nvim.api.nvim_create_autocmd('LspAttach',{\r\n  callback = function()\r\n    vim.api.nvim_create_autocmd('BufDelete',{\r\n      buffer = vim.api.nvim_get_current_buf(),\r\n      callback = function(opts)\r\n        local bufnr = opts.buf\r\n        local clients = vim.lsp.buf_get_clients(bufnr)\r\n        for client_id, _ in pairs(clients) do\r\n          vim.lsp.buf_detach_client(bufnr, client_id)\r\n        end\r\n      end\r\n    })\r\n  end\r\n\r\n})\r\n\r\n```",
            "created_at": "2022-08-31T22:32:23Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1233487621",
            "id": 1233487621,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185JhYcF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233487621/reactions"
            },
            "updated_at": "2022-08-31T22:38:45Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233487621",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I have the following snippet in my local config and that seems to remove the buffer just fine (according to `:LspInfo`)\r\n\r\n```lua\r\nlocal lspconfig = require('lspconfig')\r\n\r\nlocal function buffer_augroup(group, bufnr, cmds)\r\n  vim.api.nvim_create_augroup(group, { clear = false })\r\n  vim.api.nvim_clear_autocmds({ group = group, buffer = bufnr })\r\n  for _, cmd in ipairs(cmds) do\r\n    local event = cmd.event\r\n    cmd.event = nil\r\n    vim.api.nvim_create_autocmd(event, vim.tbl_extend(\"keep\", { group = group, buffer = bufnr }, cmd))\r\n  end\r\nend\r\n\r\nlocal function on_attach(client, bufnr)\r\n  local detach = function()\r\n    vim.lsp.buf_detach_client(bufnr, client.id)\r\n  end\r\n  buffer_augroup(\"entropitor:lsp:closing\", bufnr, {\r\n    { event = \"BufDelete\", callback = detach },\r\n  })\r\nend\r\n\r\nlspconfig.sumneko_lua.setup{on_attach=on_attach}\r\n```",
            "created_at": "2022-09-01T07:17:12Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1233850243",
            "id": 1233850243,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185Jiw-D",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233850243/reactions"
            },
            "updated_at": "2022-09-01T07:17:12Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233850243",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/896093?v=4",
                "events_url": "https://api.github.com/users/entropitor/events{/privacy}",
                "followers_url": "https://api.github.com/users/entropitor/followers",
                "following_url": "https://api.github.com/users/entropitor/following{/other_user}",
                "gists_url": "https://api.github.com/users/entropitor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/entropitor",
                "id": 896093,
                "login": "entropitor",
                "node_id": "MDQ6VXNlcjg5NjA5Mw==",
                "organizations_url": "https://api.github.com/users/entropitor/orgs",
                "received_events_url": "https://api.github.com/users/entropitor/received_events",
                "repos_url": "https://api.github.com/users/entropitor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/entropitor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/entropitor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/entropitor"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "you can use LspAttach event. if you are on 0.8 I make my snippet code works. should be add remove the buffer in on_detach .",
            "created_at": "2022-09-01T07:27:24Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1233860999",
            "id": 1233860999,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185JizmH",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233860999/reactions"
            },
            "updated_at": "2022-09-01T12:30:04Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1233860999",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "But the issue remains that we need some code, right? I created this original issue as I don't think everyone should be adding this but it should be part of the core LSP implementation",
            "created_at": "2022-09-02T15:41:51Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1235648967",
            "id": 1235648967,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185JpoHH",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1235648967/reactions"
            },
            "updated_at": "2022-09-02T15:41:51Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1235648967",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/896093?v=4",
                "events_url": "https://api.github.com/users/entropitor/events{/privacy}",
                "followers_url": "https://api.github.com/users/entropitor/followers",
                "following_url": "https://api.github.com/users/entropitor/following{/other_user}",
                "gists_url": "https://api.github.com/users/entropitor/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/entropitor",
                "id": 896093,
                "login": "entropitor",
                "node_id": "MDQ6VXNlcjg5NjA5Mw==",
                "organizations_url": "https://api.github.com/users/entropitor/orgs",
                "received_events_url": "https://api.github.com/users/entropitor/received_events",
                "repos_url": "https://api.github.com/users/entropitor/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/entropitor/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/entropitor/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/entropitor"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "yup .I will add this support .",
            "created_at": "2022-09-04T04:46:39Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-1236259138",
            "id": 1236259138,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185Jr9FC",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1236259138/reactions"
            },
            "updated_at": "2022-09-04T04:46:39Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1236259138",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I got something working at https://github.com/neovim/nvim-lspconfig/issues/2626#issuecomment-2117022664 .",
            "created_at": "2024-05-17T08:29:35Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659#issuecomment-2117023438",
            "id": 2117023438,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
            "node_id": "IC_kwDODTQC185-LzbO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 2,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/2117023438/reactions"
            },
            "updated_at": "2024-05-17T08:29:35Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/2117023438",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10998835?v=4",
                "events_url": "https://api.github.com/users/doronbehar/events{/privacy}",
                "followers_url": "https://api.github.com/users/doronbehar/followers",
                "following_url": "https://api.github.com/users/doronbehar/following{/other_user}",
                "gists_url": "https://api.github.com/users/doronbehar/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/doronbehar",
                "id": 10998835,
                "login": "doronbehar",
                "node_id": "MDQ6VXNlcjEwOTk4ODM1",
                "organizations_url": "https://api.github.com/users/doronbehar/orgs",
                "received_events_url": "https://api.github.com/users/doronbehar/received_events",
                "repos_url": "https://api.github.com/users/doronbehar/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/doronbehar/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/doronbehar/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/doronbehar"
            }
        }
    ],
    "comments": 15,
    "comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659/comments",
    "created_at": "2022-01-13T09:59:33Z",
    "events_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659/events",
    "html_url": "https://github.com/neovim/nvim-lspconfig/issues/1659",
    "id": 1103858382,
    "labels": [],
    "labels_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDODTQC185By4rO",
    "number": 1659,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/nvim-lspconfig",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659/timeline",
    "title": "BufDelete doesn't detach the buffer from the LSP client",
    "updated_at": "2024-05-17T08:29:36Z",
    "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/1659",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/896093?v=4",
        "events_url": "https://api.github.com/users/entropitor/events{/privacy}",
        "followers_url": "https://api.github.com/users/entropitor/followers",
        "following_url": "https://api.github.com/users/entropitor/following{/other_user}",
        "gists_url": "https://api.github.com/users/entropitor/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/entropitor",
        "id": 896093,
        "login": "entropitor",
        "node_id": "MDQ6VXNlcjg5NjA5Mw==",
        "organizations_url": "https://api.github.com/users/entropitor/orgs",
        "received_events_url": "https://api.github.com/users/entropitor/received_events",
        "repos_url": "https://api.github.com/users/entropitor/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/entropitor/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/entropitor/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/entropitor"
    }
}