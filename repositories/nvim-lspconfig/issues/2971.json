{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Language server\r\n\r\npyright\r\n\r\n### Requested feature\r\n\r\nThe behaviour of `lspconfig.util.root_pattern` is \"depth-first\":\r\nhttps://github.com/neovim/nvim-lspconfig/blob/7eed8b2150192e5ad05e1886fdf133493ddf2928/lua/lspconfig/util.lua#L251-L262\r\n\r\ni.e., it checks the existence of a given `root_file` (e.g. `pyproject.toml` in the current working dir), ascends as far up if it can, then tries the next `root_file` in the current working dir.\r\n\r\nAs a result, the existence of a hypothetical `~/pyproject.toml` (which, in real world situations, should probably not exist):\r\n```\r\n~/pyproject.toml\r\n~/project/.git\r\n~/project/file1\r\n~/project/pyrightconfig.json\r\n~/project/subproject/.git\r\n~/project/subproject/file2\r\n```\r\nwould override any other `root_file`. Since pyright has no problems with being initiated from `$HOME`, it will go on ahead, but take a very long time to init (up to 2 minutes on a convoluted macos system). A warning is produced in `LspLog`, but otherwise, the user has no idea that something might be off.\r\n\r\nShort of reworking `root_pattern` to allow breadth-first search (which is, in itself, undesirable, since in the above example, setting the project root to be `~/project` when working on `file2` is fairly sane behaviour), the minimum change would be to raise a warning if pyright is being started from `$HOME`. In most foreseeable cases, users will not have any of the following files in `$HOME`.\r\n\r\nhttps://github.com/neovim/nvim-lspconfig/blob/7eed8b2150192e5ad05e1886fdf133493ddf2928/lua/lspconfig/server_configurations/pyright.lua#L3-L11\r\n\r\nThe only notable exception is `$HOME/.git` for dotfiles containing python files. Such situations are not unheard of, so I'm not sure if the warning would be useful.\r\n\r\nNB: I saw that `root_pattern` has been slated for deprecation (since 2022-08 -- https://github.com/neovim/nvim-lspconfig/issues/2079), but I haven't looked at the corresponding `vim.fs` equivalent.\r\n\r\n### Other clients which have this feature\r\n\r\n_No response_",
    "closed_at": "2024-02-15T11:32:50Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "It's #2885 that \"cleaned\" some configurations (#2904), but broke many others like #2975 and this one. It also broke my setup because I have a `.eslintrc.js` in `$HOME` and `.eslintrc.cjs` in my project.\r\n\r\nI suggest that #2885 should be reimplemented in a backward-compatible way that does not change the behavior of the old configurations. e.g. use a new function or argument for the new behavior.\r\n",
            "created_at": "2024-02-15T06:56:53Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2971#issuecomment-1945470299",
            "id": 1945470299,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971",
            "node_id": "IC_kwDODTQC185z9YVb",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 1,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945470299/reactions"
            },
            "updated_at": "2024-02-15T06:56:53Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945470299",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/30581822?v=4",
                "events_url": "https://api.github.com/users/ouuan/events{/privacy}",
                "followers_url": "https://api.github.com/users/ouuan/followers",
                "following_url": "https://api.github.com/users/ouuan/following{/other_user}",
                "gists_url": "https://api.github.com/users/ouuan/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ouuan",
                "id": 30581822,
                "login": "ouuan",
                "node_id": "MDQ6VXNlcjMwNTgxODIy",
                "organizations_url": "https://api.github.com/users/ouuan/orgs",
                "received_events_url": "https://api.github.com/users/ouuan/received_events",
                "repos_url": "https://api.github.com/users/ouuan/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ouuan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ouuan/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ouuan"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> the existence of a hypothetical `~/pyproject.toml` (which, in real world situations, should probably not exist):\r\n\r\nAnd if it does exist, then the behavior is correct. \r\n\r\nhttps://github.com/neovim/nvim-lspconfig/pull/2885 changed the behavior to be more deterministic and avoid lots of hand written code in the configs.\r\n\r\n\r\n\r\n> It also broke my setup because I have a `.eslintrc.js` in `$HOME` and `.eslintrc.cjs` in my project.\r\n\r\nIf you have an eslintrc in your HOME then presumably your HOME is a eslint project.",
            "created_at": "2024-02-15T11:32:50Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2971#issuecomment-1945913755",
            "id": 1945913755,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971",
            "node_id": "IC_kwDODTQC185z_Emb",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 1,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945913755/reactions"
            },
            "updated_at": "2024-02-15T11:32:50Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945913755",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "The problem is that, almost all configurations were not using `root_pattern(pattern1) or root_pattern(pattern2) or root_pattern(pattern3)`. They were using `root_pattern(pattern1, pattern2, pattern3)` or `root_pattern(pattern1, pattern2) or root_pattern(pattern3, pattern4)`. So #2885 is not just a clean-up, but rather changes the behavior of most of them. Are you sure the new behavior is desired in all these servers? e.g. I'm sure that prioritizing `eslintrc.js` over `eslintrc.cjs` is incorrect.",
            "created_at": "2024-02-15T11:50:48Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2971#issuecomment-1945943479",
            "id": 1945943479,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971",
            "node_id": "IC_kwDODTQC185z_L23",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945943479/reactions"
            },
            "updated_at": "2024-02-15T11:53:08Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945943479",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/30581822?v=4",
                "events_url": "https://api.github.com/users/ouuan/events{/privacy}",
                "followers_url": "https://api.github.com/users/ouuan/followers",
                "following_url": "https://api.github.com/users/ouuan/following{/other_user}",
                "gists_url": "https://api.github.com/users/ouuan/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ouuan",
                "id": 30581822,
                "login": "ouuan",
                "node_id": "MDQ6VXNlcjMwNTgxODIy",
                "organizations_url": "https://api.github.com/users/ouuan/orgs",
                "received_events_url": "https://api.github.com/users/ouuan/received_events",
                "repos_url": "https://api.github.com/users/ouuan/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ouuan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ouuan/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ouuan"
            }
        },
        {
            "author_association": "NONE",
            "body": "I think we should be able to specify that several patterns are of the same priority.",
            "created_at": "2024-02-15T11:52:35Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2971#issuecomment-1945946241",
            "id": 1945946241,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971",
            "node_id": "IC_kwDODTQC185z_MiB",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945946241/reactions"
            },
            "updated_at": "2024-02-15T11:52:35Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945946241",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/30581822?v=4",
                "events_url": "https://api.github.com/users/ouuan/events{/privacy}",
                "followers_url": "https://api.github.com/users/ouuan/followers",
                "following_url": "https://api.github.com/users/ouuan/following{/other_user}",
                "gists_url": "https://api.github.com/users/ouuan/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ouuan",
                "id": 30581822,
                "login": "ouuan",
                "node_id": "MDQ6VXNlcjMwNTgxODIy",
                "organizations_url": "https://api.github.com/users/ouuan/orgs",
                "received_events_url": "https://api.github.com/users/ouuan/received_events",
                "repos_url": "https://api.github.com/users/ouuan/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ouuan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ouuan/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ouuan"
            }
        },
        {
            "author_association": "NONE",
            "body": "> If you have an eslintrc in your HOME then presumably your HOME is a eslint project.\r\n\r\n1. The actually correct behavior is to check for the `root` option in eslintrc, and stop at `root: true`. But that's complicated and it's acceptable to just approach the correct behavior in most situations.\r\n2. Let's just assume that what you say is correct. Then it's still irrelevant to prioritizing some eslintrc file formats. What if `eslintrc.cjs` is at `$HOME` and `eslintrc.js` is in my project?\r\n\r\n> #2885 changed the behavior to be more deterministic\r\n\r\nGuessing which file format is prioritized is non-deterministic for me.",
            "created_at": "2024-02-15T11:55:44Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2971#issuecomment-1945950862",
            "id": 1945950862,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971",
            "node_id": "IC_kwDODTQC185z_NqO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945950862/reactions"
            },
            "updated_at": "2024-02-15T11:58:14Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1945950862",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/30581822?v=4",
                "events_url": "https://api.github.com/users/ouuan/events{/privacy}",
                "followers_url": "https://api.github.com/users/ouuan/followers",
                "following_url": "https://api.github.com/users/ouuan/following{/other_user}",
                "gists_url": "https://api.github.com/users/ouuan/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ouuan",
                "id": 30581822,
                "login": "ouuan",
                "node_id": "MDQ6VXNlcjMwNTgxODIy",
                "organizations_url": "https://api.github.com/users/ouuan/orgs",
                "received_events_url": "https://api.github.com/users/ouuan/received_events",
                "repos_url": "https://api.github.com/users/ouuan/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ouuan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ouuan/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ouuan"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971/comments",
    "created_at": "2024-01-16T09:19:11Z",
    "events_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971/events",
    "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2971",
    "id": 2083410721,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "New feature or request",
            "id": 1674892767,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWwxNjc0ODkyNzY3",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/labels/enhancement"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDODTQC1858LlMh",
    "number": 2971,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/nvim-lspconfig",
    "state": "closed",
    "state_reason": "not_planned",
    "timeline_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971/timeline",
    "title": "Warn if pyright is started from $HOME",
    "updated_at": "2024-02-15T11:58:14Z",
    "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2971",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11556924?v=4",
        "events_url": "https://api.github.com/users/hejops/events{/privacy}",
        "followers_url": "https://api.github.com/users/hejops/followers",
        "following_url": "https://api.github.com/users/hejops/following{/other_user}",
        "gists_url": "https://api.github.com/users/hejops/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/hejops",
        "id": 11556924,
        "login": "hejops",
        "node_id": "MDQ6VXNlcjExNTU2OTI0",
        "organizations_url": "https://api.github.com/users/hejops/orgs",
        "received_events_url": "https://api.github.com/users/hejops/received_events",
        "repos_url": "https://api.github.com/users/hejops/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/hejops/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hejops/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/hejops"
    }
}