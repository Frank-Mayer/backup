{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Description\n\nI explicitly disable flake8 and other plugins, but I still receive diagnostics from pylsp\n\n### Neovim version\n\nNVIM v0.9.1\r\nBuild type: Release\r\nLuaJIT 2.1.0-beta3\n\n### Nvim-lspconfig version\n\n458fa2ee2115c693ca48a04afa65f6de6b40a2db\n\n### Operating system and version\n\nArch Linux\n\n### Affected language servers\n\npython\n\n### Steps to reproduce\n\nInstall nvim with pylsp and test my config\n\n### Actual behavior\n\nMy config seems to be correctly sent to pylsp\r\n\r\n```\r\n[DEBUG][2023-06-08 11:54:54] .../vim/lsp/rpc.lua:284\t\"rpc.send\"\t{  jsonrpc = \"2.0\",\r\nmethod = \"workspace/didChangeConfiguration\",  params = {    settings = {      pylsp = {\r\nplugins = {          flake8 = {            enabled = false          },          mccabe =\r\n{            enabled = false          },          pycodestyle = {            enabled =\r\nfalse          },          pyflakes = {            enabled = false          },\r\nruff = {            enabled = true,            extendSelect = { \"I\" },\r\nlineLength = 88          },          yapf = {            enabled = false          }\r\n}      }    }  }}\r\n[INFO][2023-06-08 11:54:54] .../lua/vim/lsp.lua:1345\t\"LSP[pylsp]\"\r\n\"server_capabilities\"\t{  server_capabilities = {    codeActionProvider = true,\r\ncodeLensProvider = {      resolveProvider = false    },    completionProvider = {\r\nresolveProvider = true,      triggerCharacters = { \".\" }    },    definitionProvider =\r\ntrue,    documentFormattingProvider = true,    documentHighlightProvider = true,\r\ndocumentRangeFormattingProvider = true,    documentSymbolProvider = true,\r\nexecuteCommandProvider = {      commands = {}    },    experimental = vim.empty_dict(),\r\nfoldingRangeProvider = true,    hoverProvider = true,    referencesProvider = true,\r\nrenameProvider = true,    signatureHelpProvider = {      triggerCharacters = { \"(\", \",\",\r\n\"=\" }    },    textDocumentSync = {      change = 2,      openClose = true,      save =\r\n{        includeText = true      }    },    workspace = {      workspaceFolders = {\r\nchangeNotifications = true,        supported = true      }    }  }}\r\n```\r\n\r\nBut then pylsp is sending diagnostics from flake8\r\n\r\n```\r\n[DEBUG][2023-06-08 11:54:55] .../vim/lsp/rpc.lua:387\t\"rpc.receive\"\t{  jsonrpc = \"2.0\",\r\nmethod = \"textDocument/publishDiagnostics\",  params = {    diagnostics = { {        code\r\n= \"D100\",        message = \"Missing docstring in public module\",        range = {\r\n[\"end\"] = {            character = 6,            line = 0          },          start = {\r\ncharacter = 0,            line = 0          }        },        severity = 2,\r\nsource = \"HIDDEN\"      }, {        code = \"D103\",        message = \"Missing docstring in\r\npublic function\",        range = {          [\"end\"] = {            character = 3,\r\nline = 34          },          start = {            character = 0,            line = 34\r\n}        },        severity = 2,        source = \"flake8\"      }, {        code =\r\n\"F841\",        message = \"local variable 'HIDDEN' is assigned to but never used\",\r\nrange = {          [\"end\"] = {            character = 15,            line = 44\r\n},          start = {            character = 4,            line = 44          }\r\n},        severity = 2,        source = \"flake8\"      }, {        code = \"E501\",\r\nmessage = \"line too long (87 > 79 characters)\",        range = {          [\"end\"] = {\r\ncharacter = 98,            line = 46          },          start = {            character\r\n= 79,            line = 46          }        },        severity = 2,        source =\r\n\"flake8\"      }, {        code = \"F821\",        message = \"undefined name 'HIDDEN'\",\r\nrange = {          [\"end\"] = {            character = 39,            line = 74\r\n},          start = {            character = 30,            line = 74          }\r\n},        severity = 1,        source = \"flake8\"      }, {        code = \"F821\",\r\nmessage = \"undefined name 'HIDDEN'\",        range = {          [\"end\"] = {\r\ncharacter = 27,            line = 94          },          start = {            character\r\n= 18,            line = 94          }        },        severity = 1,        source =\r\n\"flake8\"      }, {        code = \"E501\",        message = \"line too long (86 > 79\r\ncharacters)\",        range = {          [\"end\"] = {            character = 84,\r\nline = 99          },          start = {            character = 79,            line = 99\r\n}        },        severity = 2,        source = \"flake8\"      }, {        code =\r\n\"F821\",        message = \"undefined name 'HIDDEN'\",        range = {          [\"end\"] =\r\n{            character = 31,            line = 100          },          start = {\r\ncharacter = 22,            line = 100          }        },        severity = 1,\r\nsource = \"flake8\"      }, {        code = \"F821\",        message = \"undefined name 'c'\",\r\nrange = {          [\"end\"] = {            character = 9,            line = 109\r\n},          start = {            character = 8,            line = 109          }\r\n},        severity = 1,        source = \"flake8\"      }, {        code = \"F821\",\r\nmessage = \"undefined name 'HIDDEN'\",        range = {          [\"end\"] = {\r\ncharacter = 20,            line = 110          },          start = {\r\ncharacter = 13,            line = 110          }        },        severity = 1,\r\nsource = \"flake8\"      }, {        code = \"F821\",        message = \"undefined name\r\n'HIDDEN'\",        range = {          [\"end\"] = {            character = 30,\r\nline = 110          },          start = {            character = 27,            line =\r\n110          }        },        severity = 1,        source = \"flake8\"      }, {\r\ncode = \"F821\",        message = \"undefined name 'ba'\",        range = {          [\"end\"]\r\n= {            character = 45,            line = 110          },          start = {\r\ncharacter = 43,            line = 110          }        },        severity = 1,\r\nsource = \"flake8\"      }, {        code = \"F821\",        message = \"undefined name\r\n'HIDDEN'\",        range = {          [\"end\"] = {            character = 15,\r\nline = 111          },          start = {            character = 12,            line =\r\n111          }        },        severity = 1,        source = \"flake8\"      }, {\r\ncode = \"F821\",        message = \"undefined name 'HIDDEN'\",        range = {\r\n[\"end\"] = {            character = 31,            line = 111          },          start\r\n= {            character = 27,            line = 111          }        },\r\nseverity = 1,        source = \"flake8\"      }, {        code = \"F841\",        data = {\r\nedits = { {              content = \"\",              end_location = {\r\ncolumn = 18,                row = 45              },              location = {\r\ncolumn = 4,                row = 45              }            } },          message =\r\n\"Remove assignment to unused variable `HIDDEN`\"        },        message = \"Local\r\nvariable `HIDDEN` is assigned to but never used\",        range = {          [\"end\"] = {\r\ncharacter = 15,            line = 44          },          start = {            character\r\n= 4,            line = 44          }        },        severity = 1,        source =\r\n\"ruff\",        tags = { 1 }      }, {        code = \"F821\",        message = \"Undefined\r\nname `HIDDEN`\",        range = {          [\"end\"] = {            character = 39,\r\nline = 74          },          start = {            character = 30,            line = 74\r\n}        },        severity = 1,        source = \"ruff\",        tags = {}      }, {\r\ncode = \"F821\",        message = \"Undefined name `HIDDEN`\",        range = {\r\n[\"end\"] = {            character = 27,            line = 94          },          start =\r\n{            character = 18,            line = 94          }        },        severity =\r\n1,        source = \"ruff\",        tags = {}      }, {        code = \"F821\",\r\nmessage = \"Undefined name `HIDDEN`\",        range = {          [\"end\"] = {\r\ncharacter = 31,            line = 100          },          start = {\r\ncharacter = 22,            line = 100          }        },        severity = 1,\r\nsource = \"ruff\",        tags = {}      }, {        code = \"F821\",        message =\r\n\"Undefined name `c`\",        range = {          [\"end\"] = {            character = 9,\r\nline = 109          },          start = {            character = 8,            line =\r\n109          }        },        severity = 1,        source = \"ruff\",        tags = {}\r\n}, {        code = \"F821\",        message = \"Undefined name `HIDDEN`\",        range = {\r\n[\"end\"] = {            character = 20,            line = 110          },          start\r\n= {            character = 13,            line = 110          }        },\r\nseverity = 1,        source = \"ruff\",        tags = {}      }, {        code = \"F821\",\r\nmessage = \"Undefined name `age`\",        range = {          [\"end\"] = {\r\ncharacter = 30,            line = 110          },          start = {\r\ncharacter = 27,            line = 110          }        },        severity = 1,\r\nsource = \"ruff\",        tags = {}      }, {        code = \"F821\",        message =\r\n\"Undefined name `HIDDEN`\",        range = {          [\"end\"] = {            character =\r\n45,            line = 110          },          start = {            character = 43,\r\nline = 110          }        },        severity = 1,        source = \"ruff\",        tags\r\n= {}      }, {        code = \"F821\",        message = \"Undefined name `HIDDEN`\",\r\nrange = {          [\"end\"] = {            character = 15,            line = 111\r\n},          start = {            character = 12,            line = 111          }\r\n},        severity = 1,        source = \"ruff\",        tags = {}      }, {        code =\r\n\"F821\",        message = \"Undefined name `HIDDEN`\",        range = {          [\"end\"] =\r\n{            character = 31,            line = 111          },          start = {\r\ncharacter = 27,            line = 111          }        },        severity = 1,\r\nsource = \"ruff\",        tags = {}      } },    uri = \"file:///HIDDEN.py\"  }}\r\n```\r\n\n\n### Expected behavior\n\nI would expect flake8 to be correctly disabled, as requested according to my config\n\n### Minimal config\n\n```Lua\nrequire('lspconfig').pylsp.setup{\r\n    on_attach = on_attach,\r\n    settings = {\r\n        pylsp = {\r\n            plugins = {\r\n                ruff = {\r\n                    enabled = true,\r\n                    extendSelect = { \"I\" },\r\n                    lineLength = 88,\r\n                },\r\n                flake8 = { enabled = false },\r\n                mccabe = { enabled = false },\r\n                pycodestyle = { enabled = false },\r\n                pyflakes = { enabled = false },\r\n                yapf = { enabled = false },\r\n            },\r\n        }\r\n    }\r\n}\r\n```\n```\n\n\n### LSP log\n\nSee logs above",
    "closed_at": "2023-06-08T10:57:11Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "have you tried https://github.com/neovim/nvim-lspconfig/blob/master/test/minimal_init.lua  for test?",
            "created_at": "2023-06-08T10:22:05Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2660#issuecomment-1582317821",
            "id": 1582317821,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660",
            "node_id": "IC_kwDODTQC185eUED9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1582317821/reactions"
            },
            "updated_at": "2023-06-08T10:22:05Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1582317821",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "NONE",
            "body": "yes, it's pretty incredible. i started looking at the logs of pylsp\r\n\r\npylsp receives the config and acknowledges that `flake8` is disabled\r\n\r\n```\r\n2023-06-08 12:34:49,624 CEST - DEBUG - pylsp.config.config - With configuration:\r\n{'plugins': {'pyls_isort': {'enabled': False}, 'preload': {'modules': ['OpenGL', 'PIL',\r\n'array', 'audioop', 'binascii', 'cPickle', 'cStringIO', 'cmath', 'collections',\r\n'datetime', 'errno', 'exceptions', 'gc', 'imageop', 'imp', 'itertools', 'marshal',\r\n'math', 'matplotlib', 'mmap', 'mpmath', 'msvcrt', 'networkx', 'nose', 'nt', 'numpy',\r\n'operator', 'os', 'os.path', 'pandas', 'parser', 'rgbimg', 'scipy', 'signal', 'skimage',\r\n'sklearn', 'statsmodels', 'strop', 'sympy', 'sys', 'thread', 'time', 'wx', 'xxsubtype',\r\n'zipimport', 'zlib']}, 'autopep8': {'enabled': False}, 'yapf': {'enabled': False},\r\n'mccabe': {'enabled': False}, 'ruff': {'exclude': None, 'ignore': None, 'enabled': True,\r\n'format': None, 'select': None, 'extendIgnore': None, 'lineLength': 88, 'executable':\r\n'ruff', 'extendSelect': ['I'], 'perFileIgnores': None, 'config': None}, 'pyflakes':\r\n{'enabled': False}, 'pycodestyle': {'enabled': False}, 'pylint': {'enabled': False,\r\n'args': [], 'executable': None}, 'pydocstyle': {'enabled': False}, 'flake8': {'enabled':\r\nFalse}, 'flake8_lint': {'enabled': False}, 'rope_rename': {'enabled': False},\r\n'rope_completion': {'enabled': False, 'eager': False}}, 'rope': {'extensionModules':\r\n['OpenGL', 'PIL', 'array', 'audioop', 'binascii', 'cPickle', 'cStringIO', 'cmath',\r\n'collections', 'datetime', 'errno', 'exceptions', 'gc', 'imageop', 'imp', 'itertools',\r\n'marshal', 'math', 'matplotlib', 'mmap', 'mpmath', 'msvcrt', 'networkx', 'nose', 'nt',\r\n'numpy', 'operator', 'os', 'os.path', 'pandas', 'parser', 'rgbimg', 'scipy', 'signal',\r\n'skimage', 'sklearn', 'statsmodels', 'strop', 'sympy', 'sys', 'thread', 'time', 'wx',\r\n'xxsubtype', 'zipimport', 'zlib']}, 'configurationSources': ['ruff']}\r\n```\r\n\r\nthen it proceeds to call ruff\r\n\r\n```\r\n2023-06-08 12:34:49,625 CEST - DEBUG - pylsp_ruff.plugin - Calling ruff with args:\r\n['--quiet', '--format=json', '--no-fix', '--force-exclude',\r\n'--stdin-filename=HIDDEN.py',\r\n'--line-length=88', '--extend-select=I', '--', '-'] on\r\n'HIDDEN.py'\r\n```\r\n\r\nand then it receives diagnostics from both sources `flake8` and `ruff`...\r\n\r\ni have no idea what's going on\r\n\r\n```\r\n2023-06-08 12:34:49,636 CEST - DEBUG - pylsp.config.config -   finish pylsp_lint -->\r\n[\r\n  [\r\n    {\r\n      \"source\": \"flake8\",\r\n      \"range\": {\r\n        \"start\": { \"line\": 0, \"character\": 0 },\r\n        \"end\": { \"line\": 0, \"character\": 6 }\r\n      },\r\n      \"code\": \"D100\",\r\n      \"message\": \"Missing docstring in public module\",\r\n      \"severity\": 2\r\n    },\r\n    {\r\n      \"source\": \"flake8\",\r\n      \"range\": {\r\n        \"start\": { \"line\": 46, \"character\": 79 },\r\n        \"end\": { \"line\": 46, \"character\": 98 }\r\n      },\r\n      \"code\": \"E501\",\r\n      \"message\": \"line too long (87 > 79 characters)\",\r\n      \"severity\": 2\r\n    },\r\n    {\r\n      \"range\": {\r\n        \"start\": { \"line\": 74, \"character\": 30 },\r\n        \"end\": { \"line\": 74, \"character\": 39 }\r\n      },\r\n      \"message\": \"Undefined name `HIDDEN`\",\r\n      \"severity\": 1,\r\n      \"code\": \"F821\",\r\n      \"source\": \"ruff\",\r\n      \"tags\": []\r\n    },\r\n  ]\r\n]\r\n```\r\n\r\ntagging @ccordoba12 who might have a better idea",
            "created_at": "2023-06-08T10:42:02Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2660#issuecomment-1582351739",
            "id": 1582351739,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660",
            "node_id": "IC_kwDODTQC185eUMV7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1582351739/reactions"
            },
            "updated_at": "2023-06-08T10:42:02Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1582351739",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/694873?v=4",
                "events_url": "https://api.github.com/users/tgy/events{/privacy}",
                "followers_url": "https://api.github.com/users/tgy/followers",
                "following_url": "https://api.github.com/users/tgy/following{/other_user}",
                "gists_url": "https://api.github.com/users/tgy/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tgy",
                "id": 694873,
                "login": "tgy",
                "node_id": "MDQ6VXNlcjY5NDg3Mw==",
                "organizations_url": "https://api.github.com/users/tgy/orgs",
                "received_events_url": "https://api.github.com/users/tgy/received_events",
                "repos_url": "https://api.github.com/users/tgy/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tgy/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tgy/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tgy"
            }
        },
        {
            "author_association": "NONE",
            "body": "Fixed it, I had `pyls-flake8` installed and pylsp was by default loading it",
            "created_at": "2023-06-08T10:57:11Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2660#issuecomment-1582369300",
            "id": 1582369300,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660",
            "node_id": "IC_kwDODTQC185eUQoU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1582369300/reactions"
            },
            "updated_at": "2023-06-08T10:57:11Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/1582369300",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/694873?v=4",
                "events_url": "https://api.github.com/users/tgy/events{/privacy}",
                "followers_url": "https://api.github.com/users/tgy/followers",
                "following_url": "https://api.github.com/users/tgy/following{/other_user}",
                "gists_url": "https://api.github.com/users/tgy/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tgy",
                "id": 694873,
                "login": "tgy",
                "node_id": "MDQ6VXNlcjY5NDg3Mw==",
                "organizations_url": "https://api.github.com/users/tgy/orgs",
                "received_events_url": "https://api.github.com/users/tgy/received_events",
                "repos_url": "https://api.github.com/users/tgy/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tgy/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tgy/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tgy"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660/comments",
    "created_at": "2023-06-08T10:05:33Z",
    "events_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660/events",
    "html_url": "https://github.com/neovim/nvim-lspconfig/issues/2660",
    "id": 1747544859,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "Something isn't working",
            "id": 1674892761,
            "name": "bug",
            "node_id": "MDU6TGFiZWwxNjc0ODkyNzYx",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/labels/bug"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDODTQC185oKWsb",
    "number": 2660,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/nvim-lspconfig",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660/timeline",
    "title": "Explicitely disabling flake8, but flake8 still sending diagnostics",
    "updated_at": "2023-06-08T10:57:11Z",
    "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/2660",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/694873?v=4",
        "events_url": "https://api.github.com/users/tgy/events{/privacy}",
        "followers_url": "https://api.github.com/users/tgy/followers",
        "following_url": "https://api.github.com/users/tgy/following{/other_user}",
        "gists_url": "https://api.github.com/users/tgy/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tgy",
        "id": 694873,
        "login": "tgy",
        "node_id": "MDQ6VXNlcjY5NDg3Mw==",
        "organizations_url": "https://api.github.com/users/tgy/orgs",
        "received_events_url": "https://api.github.com/users/tgy/received_events",
        "repos_url": "https://api.github.com/users/tgy/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tgy/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tgy/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tgy"
    }
}