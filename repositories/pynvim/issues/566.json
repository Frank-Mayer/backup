{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "I have created a sample plugin that recreates my issue below.\r\n\r\n- lua in `test_plugin/lua/test_plugin/init.lua`\r\n```lua\r\nM = {}\r\n\r\nfunction M.run()\r\n    vim.fn.Start(1)\r\n    vim.fn.Start(2)\r\nend\r\n\r\nfunction M.update(data)\r\n    print(vim.fn.GetData(data))\r\nend\r\n\r\nreturn M\r\n\r\n```\r\n\r\n- python in `test_plugin/rplugin/python3/test_plugin.py`\r\n```python\r\nimport pynvim\r\nimport logging\r\n\r\n@pynvim.plugin\r\nclass TestPlugin(object):\r\n    def __init__(self, nvim : pynvim.Nvim):\r\n        logging.basicConfig(filename = 'test.log', level='DEBUG')\r\n        self.nvim = nvim\r\n\r\n    @pynvim.function('Start', sync=False)\r\n    def start(self, args):\r\n        logging.debug('start called')\r\n        d = args[0]\r\n        self.nvim.exec_lua(\"require'test_plugin'.update(...)\", d, async_ = True)\r\n\r\n    @pynvim.function('GetData', sync = True)\r\n    def getData(self, args):\r\n        logging.debug('getdata called')\r\n        d = args[0]\r\n        return d\r\n\r\n```\r\nHere, when i call `lua require'test_plugin'.run()` I could see both `start` and `getData` functions in python getting called twice but the return values of the `getData` function is never captured by the neovim \r\n\r\nAlso, if I remove one of the `vim.fn.Start` calls in `run()` function, everything works fine. \r\n\r\nAppreciate if someone can help me with this and check if I'm not using the `pynvim` apis incorrectly",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> but the return values of the `getData` function is never captured by the neovim\r\n\r\nThe code is only calling print() on the values. Maybe the printed message is not shown because of redraw? Try appending the GetData() results to a list, then check the contents of that list. \r\n\r\n",
            "created_at": "2024-04-22T19:57:26Z",
            "html_url": "https://github.com/neovim/pynvim/issues/566#issuecomment-2070847363",
            "id": 2070847363,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/566",
            "node_id": "IC_kwDOASpKTs57bp-D",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/2070847363/reactions"
            },
            "updated_at": "2024-04-22T19:57:26Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/2070847363",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/pynvim/issues/566/comments",
    "created_at": "2024-04-19T10:37:30Z",
    "events_url": "https://api.github.com/repos/neovim/pynvim/issues/566/events",
    "html_url": "https://github.com/neovim/pynvim/issues/566",
    "id": 2252655530,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": null,
            "id": 97892276,
            "name": "bug",
            "node_id": "MDU6TGFiZWw5Nzg5MjI3Ng==",
            "url": "https://api.github.com/repos/neovim/pynvim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 6369313496,
            "name": "asyncio",
            "node_id": "LA_kwDOASpKTs8AAAABe6QC2A",
            "url": "https://api.github.com/repos/neovim/pynvim/labels/asyncio"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/pynvim/issues/566/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOASpKTs6GRMuq",
    "number": 566,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/pynvim/issues/566/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/pynvim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/pynvim/issues/566/timeline",
    "title": "Synchronous call initiated through a response of an async call drops the results of the sync call.",
    "updated_at": "2024-04-22T19:57:40Z",
    "url": "https://api.github.com/repos/neovim/pynvim/issues/566",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/10277051?v=4",
        "events_url": "https://api.github.com/users/Badhi/events{/privacy}",
        "followers_url": "https://api.github.com/users/Badhi/followers",
        "following_url": "https://api.github.com/users/Badhi/following{/other_user}",
        "gists_url": "https://api.github.com/users/Badhi/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Badhi",
        "id": 10277051,
        "login": "Badhi",
        "node_id": "MDQ6VXNlcjEwMjc3MDUx",
        "organizations_url": "https://api.github.com/users/Badhi/orgs",
        "received_events_url": "https://api.github.com/users/Badhi/received_events",
        "repos_url": "https://api.github.com/users/Badhi/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Badhi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Badhi/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Badhi"
    }
}