{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "The line to test is `:py import vim; vim.current.buffer[100000]`. In regular vim you'll get:\n\n```\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nIndexError: line number out of range\n```\n\nIn nvim no error is thrown. \n\nThis was surfaced through [this UltiSnips test](https://github.com/SirVer/ultisnips/blob/master/test/test_ContextSnippets.py#L118) which is the last one failing with neovim in my current test branch, which is nice. \n\nOn another note: I found out the hard way that nvim sets a bunch of options differently on startup (for example `smarttab`, `autoindent` and `backspace`) when started using `-u NONE` than vim. Is that intentional?\n",
    "closed_at": "2015-07-16T11:41:40Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/842846?v=4",
        "events_url": "https://api.github.com/users/tarruda/events{/privacy}",
        "followers_url": "https://api.github.com/users/tarruda/followers",
        "following_url": "https://api.github.com/users/tarruda/following{/other_user}",
        "gists_url": "https://api.github.com/users/tarruda/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tarruda",
        "id": 842846,
        "login": "tarruda",
        "node_id": "MDQ6VXNlcjg0Mjg0Ng==",
        "organizations_url": "https://api.github.com/users/tarruda/orgs",
        "received_events_url": "https://api.github.com/users/tarruda/received_events",
        "repos_url": "https://api.github.com/users/tarruda/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tarruda/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tarruda/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tarruda",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "> I found out the hard way that nvim sets a bunch of options differently on startup (for example smarttab, autoindent and backspace) when started using -u NONE than vim. Is that intentional?\n\nSee neovim/neovim#2676.\n",
            "created_at": "2015-07-16T04:27:24Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-121825799",
            "id": 121825799,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTgyNTc5OQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121825799/reactions"
            },
            "updated_at": "2015-07-16T04:27:24Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121825799",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1585463?v=4",
                "events_url": "https://api.github.com/users/bohrshaw/events{/privacy}",
                "followers_url": "https://api.github.com/users/bohrshaw/followers",
                "following_url": "https://api.github.com/users/bohrshaw/following{/other_user}",
                "gists_url": "https://api.github.com/users/bohrshaw/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bohrshaw",
                "id": 1585463,
                "login": "bohrshaw",
                "node_id": "MDQ6VXNlcjE1ODU0NjM=",
                "organizations_url": "https://api.github.com/users/bohrshaw/orgs",
                "received_events_url": "https://api.github.com/users/bohrshaw/received_events",
                "repos_url": "https://api.github.com/users/bohrshaw/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bohrshaw/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bohrshaw/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bohrshaw",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@SirVer this needs to be fixed on the Neovim side, could you reopen on the main repository?\n",
            "created_at": "2015-07-16T11:41:40Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-121932628",
            "id": 121932628,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTkzMjYyOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121932628/reactions"
            },
            "updated_at": "2015-07-16T11:41:40Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121932628",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/842846?v=4",
                "events_url": "https://api.github.com/users/tarruda/events{/privacy}",
                "followers_url": "https://api.github.com/users/tarruda/followers",
                "following_url": "https://api.github.com/users/tarruda/following{/other_user}",
                "gists_url": "https://api.github.com/users/tarruda/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tarruda",
                "id": 842846,
                "login": "tarruda",
                "node_id": "MDQ6VXNlcjg0Mjg0Ng==",
                "organizations_url": "https://api.github.com/users/tarruda/orgs",
                "received_events_url": "https://api.github.com/users/tarruda/received_events",
                "repos_url": "https://api.github.com/users/tarruda/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tarruda/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tarruda/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tarruda",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "It's because of https://github.com/neovim/neovim/pull/2846 which is a feature.\n",
            "created_at": "2015-07-16T13:31:25Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-121956044",
            "id": 121956044,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTk1NjA0NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121956044/reactions"
            },
            "updated_at": "2015-07-16T13:31:25Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121956044",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> It's because of neovim/neovim#2846 which is a feature.\n\nEven so, we might be able to emulate this vim behavior with a session hook on script_host.py, see how `vim.eval` is emulated without compromising the API for newer interfaces: https://github.com/neovim/neovim/blob/master/runtime/autoload/provider/script_host.py#L173-L187\n",
            "created_at": "2015-07-16T13:59:30Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-121965318",
            "id": 121965318,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTk2NTMxOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121965318/reactions"
            },
            "updated_at": "2015-07-16T13:59:30Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121965318",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/842846?v=4",
                "events_url": "https://api.github.com/users/tarruda/events{/privacy}",
                "followers_url": "https://api.github.com/users/tarruda/followers",
                "following_url": "https://api.github.com/users/tarruda/following{/other_user}",
                "gists_url": "https://api.github.com/users/tarruda/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tarruda",
                "id": 842846,
                "login": "tarruda",
                "node_id": "MDQ6VXNlcjg0Mjg0Ng==",
                "organizations_url": "https://api.github.com/users/tarruda/orgs",
                "received_events_url": "https://api.github.com/users/tarruda/received_events",
                "repos_url": "https://api.github.com/users/tarruda/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tarruda/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tarruda/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tarruda",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Sure, that sounds good. Just wanted to point it out.\n",
            "created_at": "2015-07-16T14:51:12Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-121979428",
            "id": 121979428,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyMTk3OTQyOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121979428/reactions"
            },
            "updated_at": "2015-07-16T14:51:12Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/121979428",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Reopened as requested. I think @tarruda  is right that this should be emulated - after all the promise is for the neovim python client to provide a vim compatible python interface. \n",
            "created_at": "2015-07-18T16:29:50Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-122561582",
            "id": 122561582,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyMjU2MTU4Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/122561582/reactions"
            },
            "updated_at": "2015-07-18T16:29:50Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/122561582",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/140115?v=4",
                "events_url": "https://api.github.com/users/SirVer/events{/privacy}",
                "followers_url": "https://api.github.com/users/SirVer/followers",
                "following_url": "https://api.github.com/users/SirVer/following{/other_user}",
                "gists_url": "https://api.github.com/users/SirVer/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/SirVer",
                "id": 140115,
                "login": "SirVer",
                "node_id": "MDQ6VXNlcjE0MDExNQ==",
                "organizations_url": "https://api.github.com/users/SirVer/orgs",
                "received_events_url": "https://api.github.com/users/SirVer/received_events",
                "repos_url": "https://api.github.com/users/SirVer/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/SirVer/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/SirVer/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/SirVer",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "The implemented solution to this issue still doesn't raise **IndexError**. It raises **NvimError**, but python iteration expects IndexError.\n\nTake this example:\n```\nimport vim\n\nclass VimBuffer:\n    # A vim plugin might have a wrapper around the current Vim buffer.\n\n    def __getitem__(self, idx):\n        return vim.current.buffer[idx]\n\n\ndef dump(b):\n    for line in b:\n        print(line.upper())\n\n\n# This works fine in both nvim and vim.\ndump(vim.current.buffer)\n\n# In nvim, the iteration fails with \"pynvim.api.common.NvimError: Index out of bounds\"\ndump(VimBuffer())\n```\n\nCould solve it by changing `Buffer` in buffer.py to check for index errors:\n```\n    def __getitem__(self, idx: Union[int, slice]) -> Union[str, List[str]]:\n        if not isinstance(idx, slice):\n            i = adjust_index(idx)\n            if i >= self.request('nvim_buf_line_count'):\n                # Python iteration *expects* to request invalid lines and stops on IndexError.\n                raise IndexError()\n            return self.request('nvim_buf_get_lines', i, i + 1, True)[0]\n        start = adjust_index(idx.start, 0)\n        end = adjust_index(idx.stop, -1)\n        return self.request('nvim_buf_get_lines', start, end, False)\n```\n\nSlices don't raise IndexErrors, so the second block doesn't need this check.\n\n\n----\n\nWorkaround: Add `__iter__()` to VimBuffer so we use Buffer's specialized iteration instead of the fallback:\n\n```python\nclass VimBuffer:\n...\n\n    def __iter__(self):\n        return iter(vim.current.buffer)\n```\n\nThis is an easy fix for vim plugins that also works in vim, but relies on plugin authors working around this incompatibility.",
            "created_at": "2025-01-06T23:36:35Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-2574111956",
            "id": 2574111956,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "IC_kwDOASpKTs6ZbdTU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/2574111956/reactions"
            },
            "updated_at": "2025-01-06T23:36:35Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/2574111956",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/43559?v=4",
                "events_url": "https://api.github.com/users/idbrii/events{/privacy}",
                "followers_url": "https://api.github.com/users/idbrii/followers",
                "following_url": "https://api.github.com/users/idbrii/following{/other_user}",
                "gists_url": "https://api.github.com/users/idbrii/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/idbrii",
                "id": 43559,
                "login": "idbrii",
                "node_id": "MDQ6VXNlcjQzNTU5",
                "organizations_url": "https://api.github.com/users/idbrii/orgs",
                "received_events_url": "https://api.github.com/users/idbrii/received_events",
                "repos_url": "https://api.github.com/users/idbrii/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/idbrii/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/idbrii/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/idbrii",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "PR welcome",
            "created_at": "2025-01-07T00:46:23Z",
            "html_url": "https://github.com/neovim/pynvim/issues/128#issuecomment-2574181246",
            "id": 2574181246,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/128",
            "node_id": "IC_kwDOASpKTs6ZbuN-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/2574181246/reactions"
            },
            "updated_at": "2025-01-07T00:46:23Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/2574181246",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 8,
    "comments_url": "https://api.github.com/repos/neovim/pynvim/issues/128/comments",
    "created_at": "2015-07-14T07:37:48Z",
    "events_url": "https://api.github.com/repos/neovim/pynvim/issues/128/events",
    "html_url": "https://github.com/neovim/pynvim/issues/128",
    "id": 94886158,
    "labels": [],
    "labels_url": "https://api.github.com/repos/neovim/pynvim/issues/128/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU5NDg4NjE1OA==",
    "number": 128,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/pynvim/issues/128/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/pynvim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/pynvim/issues/128/timeline",
    "title": "nvim does not throw IndexError when out of line in vim.current.buffer. ",
    "updated_at": "2025-01-07T00:46:24Z",
    "url": "https://api.github.com/repos/neovim/pynvim/issues/128",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/140115?v=4",
        "events_url": "https://api.github.com/users/SirVer/events{/privacy}",
        "followers_url": "https://api.github.com/users/SirVer/followers",
        "following_url": "https://api.github.com/users/SirVer/following{/other_user}",
        "gists_url": "https://api.github.com/users/SirVer/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/SirVer",
        "id": 140115,
        "login": "SirVer",
        "node_id": "MDQ6VXNlcjE0MDExNQ==",
        "organizations_url": "https://api.github.com/users/SirVer/orgs",
        "received_events_url": "https://api.github.com/users/SirVer/received_events",
        "repos_url": "https://api.github.com/users/SirVer/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/SirVer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/SirVer/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/SirVer",
        "user_view_type": "public"
    }
}