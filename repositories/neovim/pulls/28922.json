{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/28922/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/28922/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/28922"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/28922"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/28922/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/27cf5a0d735c6f5fde42915fdd68ed427e14196b"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 5414,
            "forks_count": 5414,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 1725,
            "open_issues_count": 1725,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2024-05-27T22:51:37Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 271477,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 78533,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2024-05-28T01:40:20Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 78533,
            "watchers_count": 78533,
            "web_commit_signoff_required": false
        },
        "sha": "43a2019f09e855c4eae33bfdbdec4cc7b2985075",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim"
        }
    },
    "body": "Problem:\r\n1 - When interacting with multiple InspectTree and the source buffer\r\nwindows there was a high chance of errors due to the window ids not\r\nbeing updated and validated.\r\n\r\n2 - Not all InspectTree windows were closed when\r\nthe source buffer was closed.\r\n\r\nSolution:\r\n1- Update InspectTree window id on `CursorMoved` event\r\nand validate source buffer window id before trying to navigate to\r\nit.\r\n2- Close all InspectTree windows\r\n\r\nLet me know if there is something that I need to change!",
    "closed_at": "2024-05-27T11:20:03Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611522693"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611522693"
                }
            },
            "author_association": "MEMBER",
            "body": "finding an item is a good use-case for vim.iter. untested example:\r\n\r\n    win = vim.iter(windows):find(function(w) return w ~= win end)",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T11:40:15Z",
            "diff_hunk": "@@ -501,12 +501,21 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[=[@as integer[]]=]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true\n+      end\n+      for _, new_win in pairs(windows) do\n+        if new_win ~= win then\n+          win = new_win\n+          break\n+        end\n+      end",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611522693",
            "id": 1611522693,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gDeKF",
            "original_commit_id": "53ae15e06b8d7ece069cbb772ec437299e1373d7",
            "original_line": 541,
            "original_position": 21,
            "original_start_line": 513,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2073699650,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611522693/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-23T11:41:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611522693",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611588693"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611588693"
                }
            },
            "author_association": "MEMBER",
            "body": "I would do `vim.iter(pairs(windows))`. ArrayIter doesn't really help with find AFAIK",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T12:15:30Z",
            "diff_hunk": "@@ -501,12 +501,21 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[=[@as integer[]]=]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true\n+      end\n+      for _, new_win in pairs(windows) do\n+        if new_win ~= win then\n+          win = new_win\n+          break\n+        end\n+      end",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611588693",
            "id": 1611588693,
            "in_reply_to_id": 1611522693,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gDuRV",
            "original_commit_id": "53ae15e06b8d7ece069cbb772ec437299e1373d7",
            "original_line": 541,
            "original_position": 21,
            "original_start_line": 513,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2073794626,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611588693/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-23T12:15:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611588693",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611629444"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611629444"
                }
            },
            "author_association": "MEMBER",
            "body": "This is somewhat subtle (updating shared state that is \"far\" from this scope). So worth a comment.\r\n```suggestion\r\n      -- Maintain a valid window, if the original window was closed.\r\n      win = vim.iter(windows):find(function(new_win)\r\n```",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T12:44:41Z",
            "diff_hunk": "@@ -501,12 +501,19 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[=[@as integer[]]=]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true\n+      end\n+\n+      win = vim.iter(windows):find(function(new_win)",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611629444",
            "id": 1611629444,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gD4OE",
            "original_commit_id": "db11222043f382785af802679dafd53f9fa7796e",
            "original_line": 514,
            "original_position": 17,
            "original_start_line": null,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2073862231,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611629444/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2024-05-23T12:44:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611629444",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611633611"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611633611"
                }
            },
            "author_association": "MEMBER",
            "body": "This seems weird. Why is the WinClosed handler closing the window? Seems redundant.\r\n\r\nAlso why is the window being stored in both `w` and `win`? https://github.com/neovim/neovim/blob/52d2851ca4e747146c30e1996c08bf504d99fe95/runtime/lua/vim/treesitter/dev.lua#L329-L340\r\n\r\nWhat is the difference between `w` and `win` ? ",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T12:47:39Z",
            "diff_hunk": "@@ -501,12 +501,19 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[=[@as integer[]]=]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611633611",
            "id": 1611633611,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gD5PL",
            "original_commit_id": "db11222043f382785af802679dafd53f9fa7796e",
            "original_line": 516,
            "original_position": 14,
            "original_start_line": 509,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2073869144,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611633611/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-23T12:47:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611633611",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611645599"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611645599"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Yeah the naming initially confused me too. I believe:\r\n- `win` and `buf` for the buffer that has the code\r\n- `w` and `b` for the InspectTree buffer\r\n\r\nThe `WinClosed` is associated with the code buffer (`buf`), which then closes the InspectTree window aka `w`, if there isn't another window associated with `buf`. ",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T12:55:56Z",
            "diff_hunk": "@@ -501,12 +501,19 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[=[@as integer[]]=]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611645599",
            "id": 1611645599,
            "in_reply_to_id": 1611633611,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gD8Kf",
            "original_commit_id": "db11222043f382785af802679dafd53f9fa7796e",
            "original_line": 516,
            "original_position": 14,
            "original_start_line": 509,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2073888791,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611645599/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-23T12:55:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611645599",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
                "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
                "followers_url": "https://api.github.com/users/guilhas07/followers",
                "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
                "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/guilhas07",
                "id": 48023091,
                "login": "guilhas07",
                "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
                "organizations_url": "https://api.github.com/users/guilhas07/orgs",
                "received_events_url": "https://api.github.com/users/guilhas07/received_events",
                "repos_url": "https://api.github.com/users/guilhas07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/guilhas07"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611694269"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611694269"
                }
            },
            "author_association": "MEMBER",
            "body": "> * `win` and `buf` for the buffer that has the code\r\n> * `w` and `b` for the InspectTree buffer\r\n\r\nfor now let's add docstrings on those. can use that exact wording",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T13:23:49Z",
            "diff_hunk": "@@ -501,12 +501,19 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[=[@as integer[]]=]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611694269",
            "id": 1611694269,
            "in_reply_to_id": 1611633611,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gEIC9",
            "original_commit_id": "db11222043f382785af802679dafd53f9fa7796e",
            "original_line": 516,
            "original_position": 14,
            "original_start_line": 509,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2073970741,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611694269/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-23T13:23:50Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611694269",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611852094"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611852094"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "> I would do `vim.iter(pairs(windows))`. ArrayIter doesn't really help with find AFAIK\r\n\r\nDone. Is this only to avoid the cost of deciding if the table is a list or a dict?",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T14:56:00Z",
            "diff_hunk": "@@ -501,12 +501,21 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[=[@as integer[]]=]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true\n+      end\n+      for _, new_win in pairs(windows) do\n+        if new_win ~= win then\n+          win = new_win\n+          break\n+        end\n+      end",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611852094",
            "id": 1611852094,
            "in_reply_to_id": 1611522693,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gEuk-",
            "original_commit_id": "53ae15e06b8d7ece069cbb772ec437299e1373d7",
            "original_line": 541,
            "original_position": 21,
            "original_start_line": 513,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2074234489,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611852094/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-24T14:47:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611852094",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
                "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
                "followers_url": "https://api.github.com/users/guilhas07/followers",
                "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
                "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/guilhas07",
                "id": 48023091,
                "login": "guilhas07",
                "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
                "organizations_url": "https://api.github.com/users/guilhas07/orgs",
                "received_events_url": "https://api.github.com/users/guilhas07/received_events",
                "repos_url": "https://api.github.com/users/guilhas07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/guilhas07"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1611884785"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611884785"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I'm having trouble annotating the returned value correctly. \r\nTried:\r\n```lua\r\n--[[@as [integer, integer] ]]\r\n--[[@as { [1]: integer, [2]: integer} ]]\r\n```\r\nbut to no avail.\r\n\r\n",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-23T15:15:46Z",
            "diff_hunk": "@@ -501,12 +506,20 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n     callback = function()\n-      close_win(w)\n+      local windows = vim.fn.win_findbuf(buf) --[[@as integer[] ]]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true\n+      end\n+\n+      -- Maintain a valid window, if the original window was closed.\n+      _, win = vim.iter(pairs(windows)):find(function(_, new_win)\n+        return new_win ~= win\n+      end)",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1611884785",
            "id": 1611884785,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gE2jx",
            "original_commit_id": "2e39c417d8ada77814afd61e5d4b3da5983d95f0",
            "original_line": 529,
            "original_position": 46,
            "original_start_line": 519,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2074290108,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611884785/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-25T18:58:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1611884785",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
                "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
                "followers_url": "https://api.github.com/users/guilhas07/followers",
                "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
                "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/guilhas07",
                "id": 48023091,
                "login": "guilhas07",
                "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
                "organizations_url": "https://api.github.com/users/guilhas07/orgs",
                "received_events_url": "https://api.github.com/users/guilhas07/received_events",
                "repos_url": "https://api.github.com/users/guilhas07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/guilhas07"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1614790732"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614790732"
                }
            },
            "author_association": "MEMBER",
            "body": "wait where did this extra handler come from?\r\n\r\nthis PR is turning into a lot of code, for a pretty minor use-case.\r\n\r\nis there a simpler approach we can use? can we enforce a constraint to make things simpler?",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-25T17:49:51Z",
            "diff_hunk": "@@ -501,12 +506,50 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n-    callback = function()\n-      close_win(w)\n+    desc = 'Update source buffer window if the original was closed',\n+    callback = function(ev)\n+      -- do nothing if current window is still open\n+      if ev.match ~= tostring(win) then\n+        return nil\n+      end\n+\n+      local windows = vim.fn.win_findbuf(buf) --[[@as integer[] ]]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true\n+      end\n+\n+      -- Maintain a valid window, if the original window was closed.\n+      local _\n+      _, win = vim.iter(pairs(windows)):find(function(_, new_win)\n+        return new_win ~= win\n+      end)\n+    end,\n+  })\n+\n+  api.nvim_create_autocmd({ 'WinClosed' }, {",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1614790732",
            "id": 1614790732,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gP8BM",
            "original_commit_id": "73a89153675b78d15ba5334dae14e741b8f65ec0",
            "original_line": 533,
            "original_position": 58,
            "original_start_line": null,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2079093674,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614790732/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2024-05-25T17:49:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614790732",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1614790765"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614790765"
                }
            },
            "author_association": "MEMBER",
            "body": "would it save a lot of code if this test is merged into the one above?",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-25T17:50:09Z",
            "diff_hunk": "@@ -114,4 +114,56 @@ describe('vim.treesitter.inspect_tree', function()\n             (fenced_code_block_delimiter)))) ; [2, 0] - [2, 3] markdown\n       ]]\n   end)\n+\n+  it('updates window if buffer is still open', function()\n+    insert([[\n+      print()\n+      ]])\n+\n+    -- setup two windows for the same buffer\n+    exec_lua([[\n+      win = vim.api.nvim_get_current_win()\n+      vim.api.nvim_open_win(0, false, {\n+        win = 0,\n+        split = 'left'\n+      })\n+    ]])\n+\n+    exec_lua([[\n+      vim.treesitter.start(0, 'lua')\n+      vim.treesitter.inspect_tree()\n+    ]])\n+\n+    -- close initial window\n+    exec_lua('vim.api.nvim_win_close(win, false)')\n+\n+    -- try to navigate to the remaining window\n+    feed('<CR>')\n+    eq('', n.api.nvim_get_vvar('errmsg'))\n+  end)\n+\n+  it('updates inspect tree window', function()",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1614790765",
            "id": 1614790765,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gP8Bt",
            "original_commit_id": "73a89153675b78d15ba5334dae14e741b8f65ec0",
            "original_line": 145,
            "original_position": 32,
            "original_start_line": null,
            "path": "test/functional/treesitter/inspect_tree_spec.lua",
            "position": null,
            "pull_request_review_id": 2079093698,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614790765/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2024-05-25T17:50:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614790765",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1614814999"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614814999"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Edit: You were absolutely right. The newest approach is much simpler.",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-25T18:59:33Z",
            "diff_hunk": "@@ -501,12 +506,50 @@ function M.inspect_tree(opts)\n     end,\n   })\n \n-  api.nvim_create_autocmd('BufHidden', {\n+  api.nvim_create_autocmd({ 'WinClosed' }, {\n     group = group,\n     buffer = buf,\n-    once = true,\n-    callback = function()\n-      close_win(w)\n+    desc = 'Update source buffer window if the original was closed',\n+    callback = function(ev)\n+      -- do nothing if current window is still open\n+      if ev.match ~= tostring(win) then\n+        return nil\n+      end\n+\n+      local windows = vim.fn.win_findbuf(buf) --[[@as integer[] ]]\n+      if #windows == 1 then\n+        close_win(w)\n+        return true\n+      end\n+\n+      -- Maintain a valid window, if the original window was closed.\n+      local _\n+      _, win = vim.iter(pairs(windows)):find(function(_, new_win)\n+        return new_win ~= win\n+      end)\n+    end,\n+  })\n+\n+  api.nvim_create_autocmd({ 'WinClosed' }, {",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1614814999",
            "id": 1614814999,
            "in_reply_to_id": 1614790732,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gQB8X",
            "original_commit_id": "73a89153675b78d15ba5334dae14e741b8f65ec0",
            "original_line": 533,
            "original_position": 58,
            "original_start_line": null,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2079112871,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 1,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614814999/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2024-05-25T23:51:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614814999",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
                "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
                "followers_url": "https://api.github.com/users/guilhas07/followers",
                "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
                "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/guilhas07",
                "id": 48023091,
                "login": "guilhas07",
                "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
                "organizations_url": "https://api.github.com/users/guilhas07/orgs",
                "received_events_url": "https://api.github.com/users/guilhas07/received_events",
                "repos_url": "https://api.github.com/users/guilhas07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/guilhas07"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1614815161"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614815161"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I included one more test case, so it saves more than 10 lines",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-25T18:59:50Z",
            "diff_hunk": "@@ -114,4 +114,56 @@ describe('vim.treesitter.inspect_tree', function()\n             (fenced_code_block_delimiter)))) ; [2, 0] - [2, 3] markdown\n       ]]\n   end)\n+\n+  it('updates window if buffer is still open', function()\n+    insert([[\n+      print()\n+      ]])\n+\n+    -- setup two windows for the same buffer\n+    exec_lua([[\n+      win = vim.api.nvim_get_current_win()\n+      vim.api.nvim_open_win(0, false, {\n+        win = 0,\n+        split = 'left'\n+      })\n+    ]])\n+\n+    exec_lua([[\n+      vim.treesitter.start(0, 'lua')\n+      vim.treesitter.inspect_tree()\n+    ]])\n+\n+    -- close initial window\n+    exec_lua('vim.api.nvim_win_close(win, false)')\n+\n+    -- try to navigate to the remaining window\n+    feed('<CR>')\n+    eq('', n.api.nvim_get_vvar('errmsg'))\n+  end)\n+\n+  it('updates inspect tree window', function()",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1614815161",
            "id": 1614815161,
            "in_reply_to_id": 1614790765,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gQB-5",
            "original_commit_id": "73a89153675b78d15ba5334dae14e741b8f65ec0",
            "original_line": 145,
            "original_position": 32,
            "original_start_line": null,
            "path": "test/functional/treesitter/inspect_tree_spec.lua",
            "position": null,
            "pull_request_review_id": 2079113428,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614815161/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2024-05-25T23:54:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1614815161",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
                "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
                "followers_url": "https://api.github.com/users/guilhas07/followers",
                "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
                "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/guilhas07",
                "id": 48023091,
                "login": "guilhas07",
                "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
                "organizations_url": "https://api.github.com/users/guilhas07/orgs",
                "received_events_url": "https://api.github.com/users/guilhas07/received_events",
                "repos_url": "https://api.github.com/users/guilhas07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/guilhas07"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/28922#discussion_r1615288462"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/28922"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1615288462"
                }
            },
            "author_association": "MEMBER",
            "body": "nit: since we are no longer doing find() , or modifying the iterable in other ways, each() is actually more verbose than just using pairs().\r\n\r\n```suggestion\r\n      for _, window in pairs(vim.fn.win_findbuf(b)) do\r\n        close_win(window)\r\n```",
            "commit_id": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
            "created_at": "2024-05-26T17:50:17Z",
            "diff_hunk": "@@ -506,7 +523,10 @@ function M.inspect_tree(opts)\n     buffer = buf,\n     once = true,\n     callback = function()\n-      close_win(w)\n+      -- close all tree windows\n+      vim.iter(pairs(vim.fn.win_findbuf(b))):each(function(_, window)\n+        close_win(window)",
            "html_url": "https://github.com/neovim/neovim/pull/28922#discussion_r1615288462",
            "id": 1615288462,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5gR1iO",
            "original_commit_id": "38f720356bc3193dd2ec663e20940d4be54d7376",
            "original_line": 528,
            "original_position": 66,
            "original_start_line": 527,
            "path": "runtime/lua/vim/treesitter/dev.lua",
            "position": null,
            "pull_request_review_id": 2079762394,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1615288462/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2024-05-26T17:50:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1615288462",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Thanks for finding a reasonably simple approach\r\n\r\nThank you for guiding me to it!",
            "created_at": "2024-05-26T18:06:33Z",
            "html_url": "https://github.com/neovim/neovim/pull/28922#issuecomment-2132302469",
            "id": 2132302469,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28922",
            "node_id": "IC_kwDOAPphoM5_GFqF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2132302469/reactions"
            },
            "updated_at": "2024-05-26T18:06:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2132302469",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
                "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
                "followers_url": "https://api.github.com/users/guilhas07/followers",
                "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
                "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/guilhas07",
                "id": 48023091,
                "login": "guilhas07",
                "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
                "organizations_url": "https://api.github.com/users/guilhas07/orgs",
                "received_events_url": "https://api.github.com/users/guilhas07/received_events",
                "repos_url": "https://api.github.com/users/guilhas07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/guilhas07"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/28922/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/28922/commits",
    "created_at": "2024-05-22T21:23:35Z",
    "diff_url": "https://github.com/neovim/neovim/pull/28922.diff",
    "draft": false,
    "head": {
        "label": "guilhas07:fix-inspect-query",
        "ref": "fix-inspect-query",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/guilhas07/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/guilhas07/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/guilhas07/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/guilhas07/neovim/branches{/branch}",
            "clone_url": "https://github.com/guilhas07/neovim.git",
            "collaborators_url": "https://api.github.com/repos/guilhas07/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/guilhas07/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/guilhas07/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/guilhas07/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/guilhas07/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/guilhas07/neovim/contributors",
            "created_at": "2023-11-12T21:53:17Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/guilhas07/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/guilhas07/neovim/downloads",
            "events_url": "https://api.github.com/repos/guilhas07/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/guilhas07/neovim/forks",
            "full_name": "guilhas07/neovim",
            "git_commits_url": "https://api.github.com/repos/guilhas07/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/guilhas07/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/guilhas07/neovim/git/tags{/sha}",
            "git_url": "git://github.com/guilhas07/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/guilhas07/neovim/hooks",
            "html_url": "https://github.com/guilhas07/neovim",
            "id": 717880365,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/guilhas07/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/guilhas07/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/guilhas07/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/guilhas07/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/guilhas07/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/guilhas07/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/guilhas07/neovim/merges",
            "milestones_url": "https://api.github.com/repos/guilhas07/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOKsn8LQ",
            "notifications_url": "https://api.github.com/repos/guilhas07/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
                "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
                "followers_url": "https://api.github.com/users/guilhas07/followers",
                "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
                "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/guilhas07",
                "id": 48023091,
                "login": "guilhas07",
                "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
                "organizations_url": "https://api.github.com/users/guilhas07/orgs",
                "received_events_url": "https://api.github.com/users/guilhas07/received_events",
                "repos_url": "https://api.github.com/users/guilhas07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/guilhas07"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/guilhas07/neovim/pulls{/number}",
            "pushed_at": "2024-05-27T05:27:36Z",
            "releases_url": "https://api.github.com/repos/guilhas07/neovim/releases{/id}",
            "size": 263010,
            "ssh_url": "git@github.com:guilhas07/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/guilhas07/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/guilhas07/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/guilhas07/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/guilhas07/neovim/subscription",
            "svn_url": "https://github.com/guilhas07/neovim",
            "tags_url": "https://api.github.com/repos/guilhas07/neovim/tags",
            "teams_url": "https://api.github.com/repos/guilhas07/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/guilhas07/neovim/git/trees{/sha}",
            "updated_at": "2024-04-23T16:01:49Z",
            "url": "https://api.github.com/repos/guilhas07/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "27cf5a0d735c6f5fde42915fdd68ed427e14196b",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
            "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
            "followers_url": "https://api.github.com/users/guilhas07/followers",
            "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
            "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/guilhas07",
            "id": 48023091,
            "login": "guilhas07",
            "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
            "organizations_url": "https://api.github.com/users/guilhas07/orgs",
            "received_events_url": "https://api.github.com/users/guilhas07/received_events",
            "repos_url": "https://api.github.com/users/guilhas07/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/guilhas07"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/28922",
    "id": 1883352024,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28922",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1799626557,
            "name": "treesitter",
            "node_id": "MDU6TGFiZWwxNzk5NjI2NTU3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/treesitter"
        }
    ],
    "locked": false,
    "merge_commit_sha": "c4eb0b64bd4923a72fe737837cfe234c80fb539c",
    "merged_at": "2024-05-27T11:20:03Z",
    "milestone": null,
    "node_id": "PR_kwDOAPphoM5wQavY",
    "number": 28922,
    "patch_url": "https://github.com/neovim/neovim/pull/28922.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/28922/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/27cf5a0d735c6f5fde42915fdd68ed427e14196b",
    "title": "fix(treesitter): update window if inspected buffer is still open",
    "updated_at": "2024-05-27T11:21:30Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/28922",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/48023091?v=4",
        "events_url": "https://api.github.com/users/guilhas07/events{/privacy}",
        "followers_url": "https://api.github.com/users/guilhas07/followers",
        "following_url": "https://api.github.com/users/guilhas07/following{/other_user}",
        "gists_url": "https://api.github.com/users/guilhas07/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/guilhas07",
        "id": 48023091,
        "login": "guilhas07",
        "node_id": "MDQ6VXNlcjQ4MDIzMDkx",
        "organizations_url": "https://api.github.com/users/guilhas07/orgs",
        "received_events_url": "https://api.github.com/users/guilhas07/received_events",
        "repos_url": "https://api.github.com/users/guilhas07/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/guilhas07/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/guilhas07/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/guilhas07"
    }
}