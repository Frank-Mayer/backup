{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/24941/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/24941/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/24941"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/24941"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/24941/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/fea5921a98ff65bba595d4f58a63518d583ae21e"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 4860,
            "forks_count": 4860,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 1674,
            "open_issues_count": 1674,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2023-09-12T00:52:34Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 240907,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 69275,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2023-09-12T01:38:50Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 69275,
            "watchers_count": 69275,
            "web_commit_signoff_required": false
        },
        "sha": "676e1d490066a5289ba05df128c8710253fc1cf9",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim"
        }
    },
    "body": "Trying to run `make test` under fish shell results in a failure with the following output:\r\n\r\n```\r\nFAILED   test/functional/terminal/tui_spec.lua @ 1017: TUI paste: terminal mode\r\ntest/functional/terminal/tui_spec.lua:1024: Row 1 did not match.\r\nExpected:\r\n  |*tty ready                                         |\r\n  |*{1: }                                                 |\r\n  |*                                                  |\r\n  |                                                  |\r\n  |{5:^^^^^^^                                           }|\r\n  |{3:-- TERMINAL --}                                    |\r\n  |{3:-- TERMINAL --}                                    |\r\nActual:\r\n  |*process does not own the terminal                 |\r\n  |*                                                  |\r\n  |*[Process exited 2]{1: }                               |\r\n  |                                                  |\r\n  |{5:^^^^^^^                                           }|\r\n  |{3:-- TERMINAL --}                                    |\r\n  |{3:-- TERMINAL --}                                    |\r\n\r\nTo print the expect() call that would assert the current screen state, use\r\nscreen:snapshot_util(). In case of non-deterministic failures, use\r\nscreen:redraw_debug() to show all intermediate screen states.\r\n\r\nstack traceback:\r\n\ttest/functional/ui/screen.lua:622: in function '_wait'\r\n\ttest/functional/ui/screen.lua:352: in function 'expect'\r\n\ttest/functional/terminal/tui_spec.lua:1024: in function <test/functional/terminal/tui_spec.lua:1017>\r\n\r\nFAILED   test/functional/terminal/tui_spec.lua @ 1551: TUI forwards :term palette colors with termguicolors\r\ntest/functional/terminal/tui_spec.lua:1567: Row 1 did not match.\r\nExpected:\r\n  |*{1:t}ty ready                                         |\r\n  |                                                  |\r\n  |*                                                  |\r\n  |                                                  |\r\n  |{2:^^^^^^^                                           }|\r\n  |                                                  |\r\n  |{3:-- TERMINAL --}                                    |\r\nActual:\r\n  |*{1:p}rocess does not own the terminal                 |\r\n  |                                                  |\r\n  |*[Process exited 2]                                |\r\n  |                                                  |\r\n  |{2:^^^^^^^                                           }|\r\n  |                                                  |\r\n  |{3:-- TERMINAL --}                                    |\r\n\r\nTo print the expect() call that would assert the current screen state, use\r\nscreen:snapshot_util(). In case of non-deterministic failures, use\r\nscreen:redraw_debug() to show all intermediate screen states.\r\n\r\nstack traceback:\r\n\ttest/functional/ui/screen.lua:622: in function '_wait'\r\n\ttest/functional/ui/screen.lua:352: in function 'expect'\r\n\ttest/functional/terminal/tui_spec.lua:1567: in function <test/functional/terminal/tui_spec.lua:1551>\r\n```\r\n\r\nWhich may be kind of related to https://github.com/neovim/neovim/issues/2354\r\n\r\nI suppose that fish does not make the process it starts a session leader, based on this [comment](https://github.com/neovim/neovim/issues/2354#issuecomment-92386195). I checked it by running `:terminal ./build/bin/tty-test` from neovim with `shell=/bin/fish` (inherited from `$SHELL`) and it indeed complains about \"process does not own the terminal\". With `shell=sh` it doesn't complain. And unsetting `$SHELL` seems to make `neovim` to fall back to `shell=sh`.\r\n\r\nI have also found another issue about test failures under fish, though the reason seem to be quite different https://github.com/neovim/neovim/issues/6172, but there is an associated PR https://github.com/neovim/neovim/pull/6176, in which in most recent review comments @justinmk suggests unsetting `$SHELL` in a `clear()` helper, instead of doing `set shell=sh` (which broke tests on windows at the time as I understand), which I did here. Though I'm not sure if exactly this is what was meant in that comment. Should it be done through `env` in `spawn_argv` or in `new_argv` instead?\r\n\r\nI'm also not sure if two of the test runs fail because of this change or this tests just might be flaky. Failures occur in different tests in each of them.",
    "closed_at": "2023-09-11T17:01:01Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1320866819"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320866819"
                }
            },
            "author_association": "MEMBER",
            "body": "It's probably less confusing to set `SHELL=sh` explicitly? (Except on Windows)\r\n\r\nNot a blocker, but would it be more appropriate to make the change in `cmake/RunTests.cmake` ?",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-10T21:50:29Z",
            "diff_hunk": "@@ -447,6 +447,7 @@ end\n --    clear('-e')\n --    clear{args={'-e'}, args_rm={'-i'}, env={TERM=term}}\n function module.clear(...)\n+  luv.os_unsetenv('SHELL')",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1320866819",
            "id": 1320866819,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OutQD",
            "original_commit_id": "78f32ec7408f65d6161109d91528406484345177",
            "original_line": 450,
            "original_position": 4,
            "original_start_line": null,
            "path": "test/functional/helpers.lua",
            "position": null,
            "pull_request_review_id": 1618925192,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320866819/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-10T21:55:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320866819",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1320962253"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320962253"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "> It's probably less confusing to set `SHELL=sh` explicitly? (Except on Windows)\r\n\r\nWould nvim even care about $SHELL value on Windows? `:help 'shell'` says it's $SHELL or sh, except on Windows where it's \"cmd.exe\" by default. And I thought that initial intention was to make nvim use the fallback value (only omitting $SHELL), not explicitly setting it to that value. May be adding a comment would help to make it less confusing?\r\n\r\n> Not a blocker, but would it be more appropriate to make the change in `cmake/RunTests.cmake` ?\r\n\r\nI'll try it.",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T03:44:53Z",
            "diff_hunk": "@@ -447,6 +447,7 @@ end\n --    clear('-e')\n --    clear{args={'-e'}, args_rm={'-i'}, env={TERM=term}}\n function module.clear(...)\n+  luv.os_unsetenv('SHELL')",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1320962253",
            "id": 1320962253,
            "in_reply_to_id": 1320866819,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OvEjN",
            "original_commit_id": "78f32ec7408f65d6161109d91528406484345177",
            "original_line": 450,
            "original_position": 4,
            "original_start_line": null,
            "path": "test/functional/helpers.lua",
            "position": null,
            "pull_request_review_id": 1619074193,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320962253/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T03:44:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320962253",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1320974779"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320974779"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\r\nunset(ENV{SHELL})\r\n```",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T04:14:05Z",
            "diff_hunk": "@@ -64,6 +64,14 @@ endif()\n \n set(ENV{SYSTEM_NAME} ${CMAKE_HOST_SYSTEM_NAME})  # used by test/helpers.lua.\n \n+# Some tests may fail on fish shell #24941 #6172\n+# In general $SHELL value can be pretty arbitrary and it seems like any\n+# non-POSIX-compliant shell could cause some issues during a test run.\n+#\n+# Unsetting $SHELL makes neovim fall back to default value for 'shell' option.\n+# See `:help 'shell'`.\n+set(ENV{SHELL})",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1320974779",
            "id": 1320974779,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OvHm7",
            "original_commit_id": "cf92a08b5df58e25b57244c2ac2bfb66f109499d",
            "original_line": 73,
            "original_position": 10,
            "original_start_line": null,
            "path": "cmake/RunTests.cmake",
            "position": null,
            "pull_request_review_id": 1619094960,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320974779/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T04:14:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320974779",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1320977429"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320977429"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Fixed, thanks",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T04:19:23Z",
            "diff_hunk": "@@ -64,6 +64,14 @@ endif()\n \n set(ENV{SYSTEM_NAME} ${CMAKE_HOST_SYSTEM_NAME})  # used by test/helpers.lua.\n \n+# Some tests may fail on fish shell #24941 #6172\n+# In general $SHELL value can be pretty arbitrary and it seems like any\n+# non-POSIX-compliant shell could cause some issues during a test run.\n+#\n+# Unsetting $SHELL makes neovim fall back to default value for 'shell' option.\n+# See `:help 'shell'`.\n+set(ENV{SHELL})",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1320977429",
            "id": 1320977429,
            "in_reply_to_id": 1320974779,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OvIQV",
            "original_commit_id": "cf92a08b5df58e25b57244c2ac2bfb66f109499d",
            "original_line": 73,
            "original_position": 10,
            "original_start_line": null,
            "path": "cmake/RunTests.cmake",
            "position": null,
            "pull_request_review_id": 1619099876,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320977429/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T04:19:23Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320977429",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1320993997"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320993997"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I `grep`d in test/oldtest, here are a few interesting things I've found:\r\n\r\n$SHELL is set to sh in Makefile:\r\nhttps://github.com/neovim/neovim/blob/4258f4d53cb3d8d0adbaccf410e1bb422db9badb/test/old/testdir/Makefile#L12\r\nI don't see anything special here regarding $SHELL for Windows (and it shouldn't matter on Windows anyway I guess).\r\n\r\nThough in setup.vim $SHELL is reset to an empty string for win32:\r\nhttps://github.com/neovim/neovim/blob/4258f4d53cb3d8d0adbaccf410e1bb422db9badb/test/old/testdir/setup.vim#L70-L77\r\n\r\nAlso `shell` option is set to 'sh' directly in unix.vim:\r\nhttps://github.com/neovim/neovim/blob/4258f4d53cb3d8d0adbaccf410e1bb422db9badb/test/old/testdir/unix.vim#L2-L3\r\n\r\nSo for me it still seems safer to unset it or set to an empty string.",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T04:57:27Z",
            "diff_hunk": "@@ -447,6 +447,7 @@ end\n --    clear('-e')\n --    clear{args={'-e'}, args_rm={'-i'}, env={TERM=term}}\n function module.clear(...)\n+  luv.os_unsetenv('SHELL')",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1320993997",
            "id": 1320993997,
            "in_reply_to_id": 1320866819,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OvMTN",
            "original_commit_id": "78f32ec7408f65d6161109d91528406484345177",
            "original_line": 450,
            "original_position": 4,
            "original_start_line": null,
            "path": "test/functional/helpers.lua",
            "position": null,
            "pull_request_review_id": 1619123466,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320993997/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T04:57:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1320993997",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321587948"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321587948"
                }
            },
            "author_association": "MEMBER",
            "body": "> I don't see anything special here regarding $SHELL for Windows (and it shouldn't matter on Windows anyway I guess).\r\n\r\nThe point is that explicitly setting SHELL to nonsense on Windows is unnecessary potential confusion so why not avoid it there? \r\n\r\n\r\n\r\n> So for me it still seems safer to unset it or set to an empty string.\r\n\r\nWhy? Everything in test/old/ is a separate set of tests. If SHELL=sh is done there, that implies setting SHELL=sh in RunTest.cmake may fix the issue, and matches the approach already taken in test/old/.\r\n\r\nOh I think I understand your point: `setup.vim` is roughly equivalent to `clear()`. Ok, sure. But then if `clear{env={SHELL=foo}}` is specified by a caller, that should be respected.",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T13:49:17Z",
            "diff_hunk": "@@ -447,6 +447,7 @@ end\n --    clear('-e')\n --    clear{args={'-e'}, args_rm={'-i'}, env={TERM=term}}\n function module.clear(...)\n+  luv.os_unsetenv('SHELL')",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321587948",
            "id": 1321587948,
            "in_reply_to_id": 1320866819,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OxdTs",
            "original_commit_id": "78f32ec7408f65d6161109d91528406484345177",
            "original_line": 450,
            "original_position": 4,
            "original_start_line": null,
            "path": "test/functional/helpers.lua",
            "position": null,
            "pull_request_review_id": 1620060222,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321587948/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T13:50:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321587948",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321654935"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321654935"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": ">But then if clear{env={SHELL=foo}} is specified by a caller, that should be respected.\r\n\r\nI don't see why it wouldn't be respected right now. I moved unsetting `$SHELL` to `cmake/RunTests.cmake` as you suggested. So parent process won't inherit `$SHELL` during test run, but if value for `$SHELL` is explicitly passed to `clear` it should just work. Or do I miss something?",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T14:36:04Z",
            "diff_hunk": "@@ -447,6 +447,7 @@ end\n --    clear('-e')\n --    clear{args={'-e'}, args_rm={'-i'}, env={TERM=term}}\n function module.clear(...)\n+  luv.os_unsetenv('SHELL')",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321654935",
            "id": 1321654935,
            "in_reply_to_id": 1320866819,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OxtqX",
            "original_commit_id": "78f32ec7408f65d6161109d91528406484345177",
            "original_line": 450,
            "original_position": 4,
            "original_start_line": null,
            "path": "test/functional/helpers.lua",
            "position": null,
            "pull_request_review_id": 1620169276,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321654935/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T14:37:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321654935",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321661929"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321661929"
                }
            },
            "author_association": "MEMBER",
            "body": "> > But then if clear{env={SHELL=foo}} is specified by a caller, that should be respected.\r\n> \r\n> I don't see why it wouldn't be respected right now.\r\n\r\nthere i was referring to the case where SHELL is set in clear(). not relevant if SHELL is set in RunTests.cmake",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T14:41:10Z",
            "diff_hunk": "@@ -447,6 +447,7 @@ end\n --    clear('-e')\n --    clear{args={'-e'}, args_rm={'-i'}, env={TERM=term}}\n function module.clear(...)\n+  luv.os_unsetenv('SHELL')",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321661929",
            "id": 1321661929,
            "in_reply_to_id": 1320866819,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OxvXp",
            "original_commit_id": "78f32ec7408f65d6161109d91528406484345177",
            "original_line": 450,
            "original_position": 4,
            "original_start_line": null,
            "path": "test/functional/helpers.lua",
            "position": null,
            "pull_request_review_id": 1620180328,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321661929/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T14:41:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321661929",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321663265"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321663265"
                }
            },
            "author_association": "MEMBER",
            "body": "I don't see why we would want that. That makes things less explicit. We set SHELL=sh in /test/old/ so why not use the same approach here? The tests _require_ SHELL=sh, so we shouldn't be coy about it.",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T14:42:09Z",
            "diff_hunk": "@@ -64,6 +64,14 @@ endif()\n \n set(ENV{SYSTEM_NAME} ${CMAKE_HOST_SYSTEM_NAME})  # used by test/helpers.lua.\n \n+# Some tests may fail on fish shell #24941 #6172\n+# In general $SHELL value can be pretty arbitrary and it seems like any\n+# non-POSIX-compliant shell could cause some issues during a test run.\n+#\n+# Unsetting $SHELL makes neovim fall back to default value for 'shell' option.",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321663265",
            "id": 1321663265,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5Oxvsh",
            "original_commit_id": "f03ef8690dd5eb5a74e0bc38353e2247eec96a22",
            "original_line": 71,
            "original_position": 8,
            "original_start_line": null,
            "path": "cmake/RunTests.cmake",
            "position": null,
            "pull_request_review_id": 1620182642,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321663265/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T14:42:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321663265",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321676872"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321676872"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "If we want to replicate what's being done in /test/old then we should set `$SHELL` to `sh` here and then set it to an empty string in `clear` only for Windows, right?",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T14:52:12Z",
            "diff_hunk": "@@ -64,6 +64,14 @@ endif()\n \n set(ENV{SYSTEM_NAME} ${CMAKE_HOST_SYSTEM_NAME})  # used by test/helpers.lua.\n \n+# Some tests may fail on fish shell #24941 #6172\n+# In general $SHELL value can be pretty arbitrary and it seems like any\n+# non-POSIX-compliant shell could cause some issues during a test run.\n+#\n+# Unsetting $SHELL makes neovim fall back to default value for 'shell' option.",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321676872",
            "id": 1321676872,
            "in_reply_to_id": 1321663265,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OxzBI",
            "original_commit_id": "f03ef8690dd5eb5a74e0bc38353e2247eec96a22",
            "original_line": 71,
            "original_position": 8,
            "original_start_line": null,
            "path": "cmake/RunTests.cmake",
            "position": null,
            "pull_request_review_id": 1620204678,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321676872/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T14:52:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321676872",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321703587"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321703587"
                }
            },
            "author_association": "MEMBER",
            "body": "Let's keep the decision in one place (either RunTests or clear()). This should work:\r\n\r\n```\r\nif(NOT WIN32)\r\n  set(ENV{SHELL} sh)\r\nendif()\r\n```",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T15:10:08Z",
            "diff_hunk": "@@ -64,6 +64,14 @@ endif()\n \n set(ENV{SYSTEM_NAME} ${CMAKE_HOST_SYSTEM_NAME})  # used by test/helpers.lua.\n \n+# Some tests may fail on fish shell #24941 #6172\n+# In general $SHELL value can be pretty arbitrary and it seems like any\n+# non-POSIX-compliant shell could cause some issues during a test run.\n+#\n+# Unsetting $SHELL makes neovim fall back to default value for 'shell' option.",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321703587",
            "id": 1321703587,
            "in_reply_to_id": 1321663265,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5Ox5ij",
            "original_commit_id": "f03ef8690dd5eb5a74e0bc38353e2247eec96a22",
            "original_line": 71,
            "original_position": 8,
            "original_start_line": null,
            "path": "cmake/RunTests.cmake",
            "position": null,
            "pull_request_review_id": 1620246137,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321703587/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T15:10:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321703587",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321730506"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321730506"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I updated this part. Seems to work just as well. I also changed comment a bit.",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T15:30:48Z",
            "diff_hunk": "@@ -64,6 +64,14 @@ endif()\n \n set(ENV{SYSTEM_NAME} ${CMAKE_HOST_SYSTEM_NAME})  # used by test/helpers.lua.\n \n+# Some tests may fail on fish shell #24941 #6172\n+# In general $SHELL value can be pretty arbitrary and it seems like any\n+# non-POSIX-compliant shell could cause some issues during a test run.\n+#\n+# Unsetting $SHELL makes neovim fall back to default value for 'shell' option.",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321730506",
            "id": 1321730506,
            "in_reply_to_id": 1321663265,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OyAHK",
            "original_commit_id": "f03ef8690dd5eb5a74e0bc38353e2247eec96a22",
            "original_line": 71,
            "original_position": 8,
            "original_start_line": null,
            "path": "cmake/RunTests.cmake",
            "position": null,
            "pull_request_review_id": 1620288130,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321730506/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-09-11T15:30:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321730506",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24941#discussion_r1321828587"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24941"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321828587"
                }
            },
            "author_association": "MEMBER",
            "body": "can be much less verbose without losing information:\r\n\r\n```suggestion\r\n  # Tests assume POSIX \"sh\" and may fail if SHELL=fish. #24941 #6172\r\n```",
            "commit_id": "fea5921a98ff65bba595d4f58a63518d583ae21e",
            "created_at": "2023-09-11T16:54:25Z",
            "diff_hunk": "@@ -64,6 +64,13 @@ endif()\n \n set(ENV{SYSTEM_NAME} ${CMAKE_HOST_SYSTEM_NAME})  # used by test/helpers.lua.\n \n+if(NOT WIN32)\n+  # Some tests may fail on fish shell #24941 #6172\n+  # And in general $SHELL value can be pretty arbitrary and cause issues\n+  # during a test run. Setting it to sh aims to avoid those kinds of issues.",
            "html_url": "https://github.com/neovim/neovim/pull/24941#discussion_r1321828587",
            "id": 1321828587,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5OyYDr",
            "original_commit_id": "25329cb7fc6951115f8b679202f97a6ccb69b59d",
            "original_line": 70,
            "original_position": 7,
            "original_start_line": 68,
            "path": "cmake/RunTests.cmake",
            "position": null,
            "pull_request_review_id": 1620439642,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321828587/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2023-09-11T16:54:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1321828587",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "MEMBER",
            "body": "`test/functional/vimscript/system_spec.lua` is failing on macOS CI. That test needs change.",
            "created_at": "2023-08-31T04:14:13Z",
            "html_url": "https://github.com/neovim/neovim/pull/24941#issuecomment-1700341751",
            "id": 1700341751,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24941",
            "node_id": "IC_kwDOAPphoM5lWSf3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700341751/reactions"
            },
            "updated_at": "2023-08-31T04:14:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700341751",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@zeertzjq right, now I understand what those \"printf\" changes were about in the original PR. I added them as well and rebased on master.",
            "created_at": "2023-08-31T05:00:22Z",
            "html_url": "https://github.com/neovim/neovim/pull/24941#issuecomment-1700369733",
            "id": 1700369733,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24941",
            "node_id": "IC_kwDOAPphoM5lWZVF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700369733/reactions"
            },
            "updated_at": "2023-08-31T05:00:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700369733",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/24941/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/24941/commits",
    "created_at": "2023-08-30T07:15:38Z",
    "diff_url": "https://github.com/neovim/neovim/pull/24941.diff",
    "draft": false,
    "head": {
        "label": "faergeek:unset-shell-in-clear-test-helper",
        "ref": "unset-shell-in-clear-test-helper",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/faergeek/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/faergeek/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/faergeek/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/faergeek/neovim/branches{/branch}",
            "clone_url": "https://github.com/faergeek/neovim.git",
            "collaborators_url": "https://api.github.com/repos/faergeek/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/faergeek/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/faergeek/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/faergeek/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/faergeek/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/faergeek/neovim/contributors",
            "created_at": "2023-08-26T07:35:29Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/faergeek/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/faergeek/neovim/downloads",
            "events_url": "https://api.github.com/repos/faergeek/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/faergeek/neovim/forks",
            "full_name": "faergeek/neovim",
            "git_commits_url": "https://api.github.com/repos/faergeek/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/faergeek/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/faergeek/neovim/git/tags{/sha}",
            "git_url": "git://github.com/faergeek/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/faergeek/neovim/hooks",
            "html_url": "https://github.com/faergeek/neovim",
            "id": 683323221,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/faergeek/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/faergeek/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/faergeek/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/faergeek/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/faergeek/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/faergeek/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/faergeek/neovim/merges",
            "milestones_url": "https://api.github.com/repos/faergeek/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOKLqvVQ",
            "notifications_url": "https://api.github.com/repos/faergeek/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
                "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
                "followers_url": "https://api.github.com/users/faergeek/followers",
                "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
                "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/faergeek",
                "id": 3524621,
                "login": "faergeek",
                "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
                "organizations_url": "https://api.github.com/users/faergeek/orgs",
                "received_events_url": "https://api.github.com/users/faergeek/received_events",
                "repos_url": "https://api.github.com/users/faergeek/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/faergeek"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/faergeek/neovim/pulls{/number}",
            "pushed_at": "2023-09-11T17:01:37Z",
            "releases_url": "https://api.github.com/repos/faergeek/neovim/releases{/id}",
            "size": 239231,
            "ssh_url": "git@github.com:faergeek/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/faergeek/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/faergeek/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/faergeek/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/faergeek/neovim/subscription",
            "svn_url": "https://github.com/faergeek/neovim",
            "tags_url": "https://api.github.com/repos/faergeek/neovim/tags",
            "teams_url": "https://api.github.com/repos/faergeek/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/faergeek/neovim/git/trees{/sha}",
            "updated_at": "2023-08-27T03:17:57Z",
            "url": "https://api.github.com/repos/faergeek/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "fea5921a98ff65bba595d4f58a63518d583ae21e",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
            "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
            "followers_url": "https://api.github.com/users/faergeek/followers",
            "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
            "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/faergeek",
            "id": 3524621,
            "login": "faergeek",
            "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
            "organizations_url": "https://api.github.com/users/faergeek/orgs",
            "received_events_url": "https://api.github.com/users/faergeek/received_events",
            "repos_url": "https://api.github.com/users/faergeek/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/faergeek"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/24941",
    "id": 1494984433,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24941",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 110418643,
            "name": "test",
            "node_id": "MDU6TGFiZWwxMTA0MTg2NDM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/test"
        }
    ],
    "locked": false,
    "merge_commit_sha": "f859d16aea0d58e572edc9aaf1de3542569e10a9",
    "merged_at": "2023-09-11T17:01:00Z",
    "milestone": null,
    "node_id": "PR_kwDOAPphoM5ZG6bx",
    "number": 24941,
    "patch_url": "https://github.com/neovim/neovim/pull/24941.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/24941/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/fea5921a98ff65bba595d4f58a63518d583ae21e",
    "title": "fix(tests): set $SHELL = sh in tests",
    "updated_at": "2023-09-11T17:01:37Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/24941",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/3524621?v=4",
        "events_url": "https://api.github.com/users/faergeek/events{/privacy}",
        "followers_url": "https://api.github.com/users/faergeek/followers",
        "following_url": "https://api.github.com/users/faergeek/following{/other_user}",
        "gists_url": "https://api.github.com/users/faergeek/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/faergeek",
        "id": 3524621,
        "login": "faergeek",
        "node_id": "MDQ6VXNlcjM1MjQ2MjE=",
        "organizations_url": "https://api.github.com/users/faergeek/orgs",
        "received_events_url": "https://api.github.com/users/faergeek/received_events",
        "repos_url": "https://api.github.com/users/faergeek/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/faergeek/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/faergeek/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/faergeek"
    }
}