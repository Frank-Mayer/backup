{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/24824/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/24824/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/24824"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/24824"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/24824/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/24824"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/008154954791001efcc46c28146e21403f3a698b"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 4841,
            "forks_count": 4841,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 1670,
            "open_issues_count": 1670,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2023-08-28T01:14:13Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 250388,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 68896,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2023-08-28T01:51:59Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 68896,
            "watchers_count": 68896,
            "web_commit_signoff_required": false
        },
        "sha": "5bb17958c5694a28bd6b97f97adb4064bc79b984",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim"
        }
    },
    "body": "warning: early working-on-the-train-stream-of-conciousness draft.\r\n\r\nMost of the messy things when changing a non-current buffer is not about the buffer, it is about windows. In particular, it is about `curwin`.\r\n\r\nWhen editing a non-current buffer which is displayed in some other window in the current tabpage, one such window will be \"borrowed\" as the curwin.\r\nBut this means if two or more non-current windows displayed the buffer, one of them will be arbitrarily selected to be treated differently. this is not desirable.\r\n\r\n<del>This branch currently disables all such borrowed-curwin logic, but this likely breaks some useful expectations which should be fixed instead by applying these window checks to _all_ non-current windows (I am looking at you, `fix_cursor()` ) </del> Done and added tests",
    "closed_at": "2023-08-26T10:35:23Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24824#discussion_r1306382520"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24824"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1306382520"
                }
            },
            "author_association": "MEMBER",
            "body": "I think this is better put in `src/nvim/buffer.c` so that some files below don't have to include `src/nvim/api/buffer.h`.",
            "commit_id": "008154954791001efcc46c28146e21403f3a698b",
            "created_at": "2023-08-26T08:51:44Z",
            "diff_hunk": "@@ -702,42 +703,60 @@ void nvim_buf_set_text(uint64_t channel_id, Buffer buffer, Integer start_row, In\n     extra++;\n   }\n \n+  colnr_T col_extent = (colnr_T)(end_col\n+                                 - ((end_row == start_row) ? start_col : 0));\n+\n   // Adjust marks. Invalidate any which lie in the\n   // changed range, and move any in the remainder of the buffer.\n-  mark_adjust((linenr_T)start_row,\n-              (linenr_T)end_row,\n-              MAXLNUM,\n-              (linenr_T)extra,\n-              kExtmarkNOOP);\n+  // Do not adjust any cursors. need to use column-aware logic (below)\n+  mark_adjust_buf(buf, (linenr_T)start_row, (linenr_T)end_row, MAXLNUM, (linenr_T)extra,\n+                  true, false, kExtmarkNOOP);\n \n-  colnr_T col_extent = (colnr_T)(end_col\n-                                 - ((end_row == start_row) ? start_col : 0));\n   extmark_splice(buf, (int)start_row - 1, (colnr_T)start_col,\n                  (int)(end_row - start_row), col_extent, old_byte,\n                  (int)new_len - 1, (colnr_T)last_item.size, new_byte,\n                  kExtmarkUndo);\n \n-  changed_lines((linenr_T)start_row, 0, (linenr_T)end_row + 1, (linenr_T)extra, true);\n+  changed_lines(buf, (linenr_T)start_row, 0, (linenr_T)end_row + 1, (linenr_T)extra, true);\n \n-  // adjust cursor like an extmark ( i e it was inside last_part_len)\n-  if (curwin->w_cursor.lnum == end_row && curwin->w_cursor.col > end_col) {\n-    curwin->w_cursor.col -= col_extent - (colnr_T)last_item.size;\n+  FOR_ALL_TAB_WINDOWS(tp, win) {\n+    if (win->w_buffer == buf) {\n+      // adjust cursor like an extmark ( i e it was inside last_part_len)\n+      if (win->w_cursor.lnum == end_row && win->w_cursor.col > end_col) {\n+        win->w_cursor.col -= col_extent - (colnr_T)last_item.size;\n+      }\n+      fix_cursor(win, (linenr_T)start_row, (linenr_T)end_row, (linenr_T)extra);\n+    }\n   }\n-  fix_cursor((linenr_T)start_row, (linenr_T)end_row, (linenr_T)extra);\n \n end:\n   for (size_t i = 0; i < new_len; i++) {\n     xfree(lines[i]);\n   }\n   xfree(lines);\n-  aucmd_restbuf(&aco);\n   try_end(err);\n \n early_end:\n   xfree(str_at_start);\n   xfree(str_at_end);\n }\n \n+/// assumes caller does try_start/try_end if desired\n+bool buf_ensure_ml(buf_T *buf)",
            "html_url": "https://github.com/neovim/neovim/pull/24824#discussion_r1306382520",
            "id": 1306382520,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5N3dC4",
            "original_commit_id": "4ebff858ad481d9323fbb50650252ed7e91ea0e9",
            "original_line": 745,
            "original_position": 197,
            "original_start_line": null,
            "path": "src/nvim/api/buffer.c",
            "position": null,
            "pull_request_review_id": 1596816263,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24824",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1306382520/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-08-26T08:51:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1306382520",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/24824#discussion_r1306390513"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/24824"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1306390513"
                }
            },
            "author_association": "MEMBER",
            "body": "done.",
            "commit_id": "008154954791001efcc46c28146e21403f3a698b",
            "created_at": "2023-08-26T09:41:17Z",
            "diff_hunk": "@@ -702,42 +703,60 @@ void nvim_buf_set_text(uint64_t channel_id, Buffer buffer, Integer start_row, In\n     extra++;\n   }\n \n+  colnr_T col_extent = (colnr_T)(end_col\n+                                 - ((end_row == start_row) ? start_col : 0));\n+\n   // Adjust marks. Invalidate any which lie in the\n   // changed range, and move any in the remainder of the buffer.\n-  mark_adjust((linenr_T)start_row,\n-              (linenr_T)end_row,\n-              MAXLNUM,\n-              (linenr_T)extra,\n-              kExtmarkNOOP);\n+  // Do not adjust any cursors. need to use column-aware logic (below)\n+  mark_adjust_buf(buf, (linenr_T)start_row, (linenr_T)end_row, MAXLNUM, (linenr_T)extra,\n+                  true, false, kExtmarkNOOP);\n \n-  colnr_T col_extent = (colnr_T)(end_col\n-                                 - ((end_row == start_row) ? start_col : 0));\n   extmark_splice(buf, (int)start_row - 1, (colnr_T)start_col,\n                  (int)(end_row - start_row), col_extent, old_byte,\n                  (int)new_len - 1, (colnr_T)last_item.size, new_byte,\n                  kExtmarkUndo);\n \n-  changed_lines((linenr_T)start_row, 0, (linenr_T)end_row + 1, (linenr_T)extra, true);\n+  changed_lines(buf, (linenr_T)start_row, 0, (linenr_T)end_row + 1, (linenr_T)extra, true);\n \n-  // adjust cursor like an extmark ( i e it was inside last_part_len)\n-  if (curwin->w_cursor.lnum == end_row && curwin->w_cursor.col > end_col) {\n-    curwin->w_cursor.col -= col_extent - (colnr_T)last_item.size;\n+  FOR_ALL_TAB_WINDOWS(tp, win) {\n+    if (win->w_buffer == buf) {\n+      // adjust cursor like an extmark ( i e it was inside last_part_len)\n+      if (win->w_cursor.lnum == end_row && win->w_cursor.col > end_col) {\n+        win->w_cursor.col -= col_extent - (colnr_T)last_item.size;\n+      }\n+      fix_cursor(win, (linenr_T)start_row, (linenr_T)end_row, (linenr_T)extra);\n+    }\n   }\n-  fix_cursor((linenr_T)start_row, (linenr_T)end_row, (linenr_T)extra);\n \n end:\n   for (size_t i = 0; i < new_len; i++) {\n     xfree(lines[i]);\n   }\n   xfree(lines);\n-  aucmd_restbuf(&aco);\n   try_end(err);\n \n early_end:\n   xfree(str_at_start);\n   xfree(str_at_end);\n }\n \n+/// assumes caller does try_start/try_end if desired\n+bool buf_ensure_ml(buf_T *buf)",
            "html_url": "https://github.com/neovim/neovim/pull/24824#discussion_r1306390513",
            "id": 1306390513,
            "in_reply_to_id": 1306382520,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5N3e_x",
            "original_commit_id": "4ebff858ad481d9323fbb50650252ed7e91ea0e9",
            "original_line": 745,
            "original_position": 197,
            "original_start_line": null,
            "path": "src/nvim/api/buffer.c",
            "position": null,
            "pull_request_review_id": 1596828153,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/24824",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1306390513/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2023-08-26T09:41:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1306390513",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "NONE",
            "body": "Fyi this commit seems to break telescope, the list of results is not always shown and only reappears after selecting another entry in the list. I really don't understand enough about either this commit or telescope to say whether this is a new bug caused by this commit or something which should be fixed by telescope, which might rely on old behavior from before this commit. But with the ol' reliable `git bisect` I could confirm the problem with telescope started with this commit. Is this the right place for a message like this or would it be better fit as a separate issue? Good to know for the future :)\r\n\r\nIf my explanation of the problem in text wasn't clear enough here are some screenshots; in the neovim repo `require('telescope.builtin').find_files()` for instance shows the following for the search `afad`:\r\n![image](https://github.com/neovim/neovim/assets/21057514/1ac88fc0-9da4-4eeb-a94c-d77dc9fc5791)\r\nAs you can see by the counter 25 results should be displayed but aren't.\r\nAnd only shows the following after selecting result:\r\n![image](https://github.com/neovim/neovim/assets/21057514/c5a22fb6-fd21-4a87-97f2-caa48b679e5b)\r\n",
            "created_at": "2023-08-26T13:51:35Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694346147",
            "id": 1694346147,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_auj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694346147/reactions"
            },
            "updated_at": "2023-08-26T13:52:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694346147",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21057514?v=4",
                "events_url": "https://api.github.com/users/sandersantema/events{/privacy}",
                "followers_url": "https://api.github.com/users/sandersantema/followers",
                "following_url": "https://api.github.com/users/sandersantema/following{/other_user}",
                "gists_url": "https://api.github.com/users/sandersantema/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/sandersantema",
                "id": 21057514,
                "login": "sandersantema",
                "node_id": "MDQ6VXNlcjIxMDU3NTE0",
                "organizations_url": "https://api.github.com/users/sandersantema/orgs",
                "received_events_url": "https://api.github.com/users/sandersantema/received_events",
                "repos_url": "https://api.github.com/users/sandersantema/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/sandersantema/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sandersantema/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/sandersantema"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Hmm it seems to _behave_ correctly but there are some missing redraws, leading to the glitches you describe. it seems to depend on the picker type, like `find_files` is borked but `live_grep` seems to look just fine.",
            "created_at": "2023-08-26T13:56:58Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694347170",
            "id": 1694347170,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_a-i",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694347170/reactions"
            },
            "updated_at": "2023-08-26T13:56:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694347170",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "I reported the same thing in the telescope repo https://github.com/nvim-telescope/telescope.nvim/issues/2667\r\n\r\nAlso cmp completion seems broken now since we cannot move across the list of candidates in the popup window:\r\n\r\n![cmp](https://github.com/neovim/neovim/assets/2583971/bb58f442-75bc-4cb9-948a-1009905e557b)\r\n",
            "created_at": "2023-08-26T16:03:50Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694396918",
            "id": 1694396918,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_nH2",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694396918/reactions"
            },
            "updated_at": "2023-08-26T16:03:50Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694396918",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2583971?v=4",
                "events_url": "https://api.github.com/users/petobens/events{/privacy}",
                "followers_url": "https://api.github.com/users/petobens/followers",
                "following_url": "https://api.github.com/users/petobens/following{/other_user}",
                "gists_url": "https://api.github.com/users/petobens/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/petobens",
                "id": 2583971,
                "login": "petobens",
                "node_id": "MDQ6VXNlcjI1ODM5NzE=",
                "organizations_url": "https://api.github.com/users/petobens/orgs",
                "received_events_url": "https://api.github.com/users/petobens/received_events",
                "repos_url": "https://api.github.com/users/petobens/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/petobens/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/petobens/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/petobens"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Meet strange thing with this PR, when I save a buffer, the first line will disappear. I also can't see this change in undo tree.",
            "created_at": "2023-08-26T16:38:54Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694406284",
            "id": 1694406284,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_paM",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694406284/reactions"
            },
            "updated_at": "2023-08-26T16:38:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694406284",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/50723480?v=4",
                "events_url": "https://api.github.com/users/rhcher/events{/privacy}",
                "followers_url": "https://api.github.com/users/rhcher/followers",
                "following_url": "https://api.github.com/users/rhcher/following{/other_user}",
                "gists_url": "https://api.github.com/users/rhcher/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rhcher",
                "id": 50723480,
                "login": "rhcher",
                "node_id": "MDQ6VXNlcjUwNzIzNDgw",
                "organizations_url": "https://api.github.com/users/rhcher/orgs",
                "received_events_url": "https://api.github.com/users/rhcher/received_events",
                "repos_url": "https://api.github.com/users/rhcher/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rhcher/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rhcher/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rhcher"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The cmp issue is likely the same redraw issue. the actual item is navigated in curbuf, but the popup menu (re-implemented as a float) is not redrawn. ",
            "created_at": "2023-08-26T17:03:35Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694411104",
            "id": 1694411104,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_qlg",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694411104/reactions"
            },
            "updated_at": "2023-08-26T17:03:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694411104",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@rhcher can this also be reproduced with `--clean` ? if not, I need minimal config to reproduce.",
            "created_at": "2023-08-26T17:05:22Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694411609",
            "id": 1694411609,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_qtZ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694411609/reactions"
            },
            "updated_at": "2023-08-26T17:05:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694411609",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Locally reverting just this part seems to fix the telescope issue for me:\r\n\r\n```diff\r\ndiff --git a/src/nvim/api/vim.c b/src/nvim/api/vim.c\r\nindex b278a21d8e..4179ae40b8 100644\r\n--- a/src/nvim/api/vim.c\r\n+++ b/src/nvim/api/vim.c\r\n@@ -912,17 +912,14 @@ Buffer nvim_create_buf(Boolean listed, Boolean scratch, Error *err)\r\n     goto fail;\r\n   }\r\n \r\n-  // Only strictly needed for scratch, but could just as well be consistent\r\n-  // and do this now. buffer is created NOW, not when it latter first happen\r\n-  // to reach a window or aucmd_prepbuf() ..\r\n-  buf_copy_options(buf, BCO_ENTER | BCO_NOHELP);\r\n-\r\n   if (scratch) {\r\n-    set_string_option_direct_in_buf(buf, \"bufhidden\", -1, \"hide\", OPT_LOCAL, 0);\r\n-    set_string_option_direct_in_buf(buf, \"buftype\", -1, \"nofile\", OPT_LOCAL, 0);\r\n-    assert(buf->b_ml.ml_mfp->mf_fd < 0);  // ml_open() should not have opened swapfile already\r\n-    buf->b_p_swf = false;\r\n-    buf->b_p_ml = false;\r\n+    aco_save_T aco;\r\n+    aucmd_prepbuf(&aco, buf);\r\n+    set_option_value(\"bufhidden\", STATIC_CSTR_AS_OPTVAL(\"hide\"), OPT_LOCAL);\r\n+    set_option_value(\"buftype\", STATIC_CSTR_AS_OPTVAL(\"nofile\"), OPT_LOCAL);\r\n+    set_option_value(\"swapfile\", BOOLEAN_OPTVAL(false), OPT_LOCAL);\r\n+    set_option_value(\"modeline\", BOOLEAN_OPTVAL(false), OPT_LOCAL);  // 'nomodeline'\r\n+    aucmd_restbuf(&aco);\r\n   }\r\n   return buf->b_fnum;\r\n```\r\nI'll debug a bit more, but if I don't find something we can revert just that while keep the bulk of the changes, for now.",
            "created_at": "2023-08-26T17:48:18Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694421758",
            "id": 1694421758,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_tL-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694421758/reactions"
            },
            "updated_at": "2023-08-26T17:48:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694421758",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> @rhcher can this also be reproduced with `--clean` ? if not, I need minimal config to reproduce.\r\n\r\nThat can not be reproduced with `--clean`, and it related to [noice.nvim](https://github.com/folke/noice.nvim)\r\nI reproduced with this minimal config:\r\n```lua\r\n-- DO NOT change the paths and don't remove the colorscheme\r\nlocal root = vim.fn.fnamemodify(\"./.repro\", \":p\")\r\n\r\n-- set stdpaths to use .repro\r\nfor _, name in ipairs({ \"config\", \"data\", \"state\", \"cache\" }) do\r\n  vim.env[(\"XDG_%s_HOME\"):format(name:upper())] = root .. \"/\" .. name\r\nend\r\n\r\n-- bootstrap lazy\r\nlocal lazypath = root .. \"/plugins/lazy.nvim\"\r\nif not vim.loop.fs_stat(lazypath) then\r\n  vim.fn.system({ \"git\", \"clone\", \"--filter=blob:none\", \"https://github.com/folke/lazy.nvim.git\", lazypath, })\r\nend\r\nvim.opt.runtimepath:prepend(lazypath)\r\n\r\n-- install plugins\r\nlocal plugins = {\r\n  \"folke/tokyonight.nvim\",\r\n  {\r\n    \"folke/noice.nvim\",\r\n    event = \"VeryLazy\",\r\n    opts = {},\r\n    dependencies  = {\r\n      \"MunifTanjim/nui.nvim\",\r\n    },\r\n  },\r\n  -- add any other plugins here\r\n}\r\nrequire(\"lazy\").setup(plugins, {\r\n  root = root .. \"/plugins\",\r\n})\r\n\r\nvim.cmd.colorscheme(\"tokyonight\")\r\n```\r\n### Steps To Reproduce\r\n1. `touch test.c`\r\n2. add something in test.c file\r\n3. open test.c `nvim -u repro.lua`\r\n4. the first line disappear\r\n5. If I add first line back, when I save buffer, it also disppear.\r\n\r\nI don't know if its an nvim issue or a noice.nvim issue, all I can determine is that it comes after this pr. If you're sure it's an nvim related issue, then I'd be happy to create an issue to track this down.",
            "created_at": "2023-08-26T17:57:18Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694423583",
            "id": 1694423583,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_tof",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694423583/reactions"
            },
            "updated_at": "2023-08-26T17:57:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694423583",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/50723480?v=4",
                "events_url": "https://api.github.com/users/rhcher/events{/privacy}",
                "followers_url": "https://api.github.com/users/rhcher/followers",
                "following_url": "https://api.github.com/users/rhcher/following{/other_user}",
                "gists_url": "https://api.github.com/users/rhcher/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rhcher",
                "id": 50723480,
                "login": "rhcher",
                "node_id": "MDQ6VXNlcjUwNzIzNDgw",
                "organizations_url": "https://api.github.com/users/rhcher/orgs",
                "received_events_url": "https://api.github.com/users/rhcher/received_events",
                "repos_url": "https://api.github.com/users/rhcher/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rhcher/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rhcher/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rhcher"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "correction: the telescope issue was rather about topline. for some reason it is being adjusted differently for a non-current window.\r\n\r\n@sandersantema @petobens if you like you could test this branch https://github.com/neovim/neovim/pull/24889",
            "created_at": "2023-08-26T18:40:35Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694462447",
            "id": 1694462447,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_3Hv",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694462447/reactions"
            },
            "updated_at": "2023-08-26T18:40:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694462447",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "> correction: the telescope issue was rather about topline. for some reason it is being adjusted differently for a non-current window.\r\n> \r\n> @sandersantema @petobens if you like you could test this branch #24889\r\n\r\nThis is also affecting [wilder](https://github.com/gelguy/wilder.nvim), whenever I open popup menu with `:`, `/`, or `?`:\r\n\r\n![image](https://github.com/neovim/neovim/assets/21010072/0e14a631-4b83-43d0-8caf-58514b62c4e0)\r\n",
            "created_at": "2023-08-26T19:27:10Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694486696",
            "id": 1694486696,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5k_9Co",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694486696/reactions"
            },
            "updated_at": "2023-08-26T19:27:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694486696",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21010072?v=4",
                "events_url": "https://api.github.com/users/catgoose/events{/privacy}",
                "followers_url": "https://api.github.com/users/catgoose/followers",
                "following_url": "https://api.github.com/users/catgoose/following{/other_user}",
                "gists_url": "https://api.github.com/users/catgoose/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/catgoose",
                "id": 21010072,
                "login": "catgoose",
                "node_id": "MDQ6VXNlcjIxMDEwMDcy",
                "organizations_url": "https://api.github.com/users/catgoose/orgs",
                "received_events_url": "https://api.github.com/users/catgoose/received_events",
                "repos_url": "https://api.github.com/users/catgoose/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/catgoose/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/catgoose/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/catgoose"
            }
        },
        {
            "author_association": "NONE",
            "body": "@bfredl  https://github.com/neovim/neovim/pull/24889 did the trick! Thanks.",
            "created_at": "2023-08-26T21:44:48Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694507425",
            "id": 1694507425,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5lACGh",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694507425/reactions"
            },
            "updated_at": "2023-08-26T21:44:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694507425",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21057514?v=4",
                "events_url": "https://api.github.com/users/sandersantema/events{/privacy}",
                "followers_url": "https://api.github.com/users/sandersantema/followers",
                "following_url": "https://api.github.com/users/sandersantema/following{/other_user}",
                "gists_url": "https://api.github.com/users/sandersantema/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/sandersantema",
                "id": 21057514,
                "login": "sandersantema",
                "node_id": "MDQ6VXNlcjIxMDU3NTE0",
                "organizations_url": "https://api.github.com/users/sandersantema/orgs",
                "received_events_url": "https://api.github.com/users/sandersantema/received_events",
                "repos_url": "https://api.github.com/users/sandersantema/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/sandersantema/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sandersantema/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/sandersantema"
            }
        },
        {
            "author_association": "NONE",
            "body": "> correction: the telescope issue was rather about topline. for some reason it is being adjusted differently for a non-current window.\r\n> \r\n>  if you like you could test this branch #24889 \r\n\r\nTested it with telescope and cmp. Telescope issue is fixed, but cmp remains broken.\r\n",
            "created_at": "2023-08-27T00:40:29Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694532996",
            "id": 1694532996,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5lAIWE",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694532996/reactions"
            },
            "updated_at": "2023-08-27T00:40:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694532996",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/69750637?v=4",
                "events_url": "https://api.github.com/users/gegoune/events{/privacy}",
                "followers_url": "https://api.github.com/users/gegoune/followers",
                "following_url": "https://api.github.com/users/gegoune/following{/other_user}",
                "gists_url": "https://api.github.com/users/gegoune/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gegoune",
                "id": 69750637,
                "login": "gegoune",
                "node_id": "MDQ6VXNlcjY5NzUwNjM3",
                "organizations_url": "https://api.github.com/users/gegoune/orgs",
                "received_events_url": "https://api.github.com/users/gegoune/received_events",
                "repos_url": "https://api.github.com/users/gegoune/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gegoune/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gegoune/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gegoune"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This seems to make nvim crash for me on line 3220 of `undo.c`.\r\n\r\nThis patch seems to fix it for me, idk if this is actually right tho\r\n```diff\r\ndiff --git a/src/nvim/undo.c b/src/nvim/undo.c\r\nindex 552120d4a..52bab2d2a 100644\r\n--- a/src/nvim/undo.c\r\n+++ b/src/nvim/undo.c\r\n@@ -3211,12 +3211,12 @@ u_header_T *u_force_get_undo_header(buf_T *buf)\r\n     // Undo is normally invoked in change code, which already has swapped\r\n     // curbuf.\r\n     // Args are tricky: this means replace empty range by empty range..\r\n-    u_savecommon(curbuf, 0, 1, 1, true);\r\n+    u_savecommon(buf, 0, 1, 1, true);\r\n \r\n     uhp = buf->b_u_curhead;\r\n     if (!uhp) {\r\n       uhp = buf->b_u_newhead;\r\n-      if (get_undolevel(curbuf) > 0 && !uhp) {\r\n+      if (get_undolevel(buf) > 0 && !uhp) {\r\n         abort();\r\n       }\r\n     }\r\n```",
            "created_at": "2023-08-27T01:03:58Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694536073",
            "id": 1694536073,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5lAJGJ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694536073/reactions"
            },
            "updated_at": "2023-08-27T01:11:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694536073",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/33922797?v=4",
                "events_url": "https://api.github.com/users/SleepySwords/events{/privacy}",
                "followers_url": "https://api.github.com/users/SleepySwords/followers",
                "following_url": "https://api.github.com/users/SleepySwords/following{/other_user}",
                "gists_url": "https://api.github.com/users/SleepySwords/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/SleepySwords",
                "id": 33922797,
                "login": "SleepySwords",
                "node_id": "MDQ6VXNlcjMzOTIyNzk3",
                "organizations_url": "https://api.github.com/users/SleepySwords/orgs",
                "received_events_url": "https://api.github.com/users/SleepySwords/received_events",
                "repos_url": "https://api.github.com/users/SleepySwords/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/SleepySwords/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/SleepySwords/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/SleepySwords"
            }
        },
        {
            "author_association": "MEMBER",
            "body": " @SleepySwords the fix is indeed correct. added to the same PR.",
            "created_at": "2023-08-27T09:25:16Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694617529",
            "id": 1694617529,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5lAc-5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694617529/reactions"
            },
            "updated_at": "2023-08-27T09:25:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694617529",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Unfortunately the first \"regression fix\" in #24889 was not correct. The (old master) behavior of topline adjustment was invalid and self-inconsistent, but unfortunately some plugins like telescope has come to depend on this incorrect behavior. The added test cases show what I think should be the correct behavior, i e topline is kept on the same line (i e the one with the same contents), even if its number changed. The fix was yet incomplete tho, and there is thus another change now in the PR which might help regressions in _other_ plugins.\r\n\r\nRegardless, the behavior currently in 0.9 (and master two days ago) is self-inconsistent (the third added test case, which multiple split windows into the same buffer, already did the \"new\" correct behavior), and has to be changed.\r\n\r\n",
            "created_at": "2023-08-27T09:32:12Z",
            "html_url": "https://github.com/neovim/neovim/pull/24824#issuecomment-1694619063",
            "id": 1694619063,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
            "node_id": "IC_kwDOAPphoM5lAdW3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694619063/reactions"
            },
            "updated_at": "2023-08-27T09:32:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1694619063",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/24824/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/24824/commits",
    "created_at": "2023-08-21T13:04:45Z",
    "diff_url": "https://github.com/neovim/neovim/pull/24824.diff",
    "draft": false,
    "head": {
        "label": "bfredl:nocurbuf",
        "ref": "nocurbuf",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/bfredl/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/bfredl/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/bfredl/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/bfredl/neovim/branches{/branch}",
            "clone_url": "https://github.com/bfredl/neovim.git",
            "collaborators_url": "https://api.github.com/repos/bfredl/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/bfredl/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/bfredl/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/bfredl/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/bfredl/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/bfredl/neovim/contributors",
            "created_at": "2014-06-20T19:51:31Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/bfredl/neovim/deployments",
            "description": "vim's rebirth for the 21st century",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/bfredl/neovim/downloads",
            "events_url": "https://api.github.com/repos/bfredl/neovim/events",
            "fork": true,
            "forks": 1,
            "forks_count": 1,
            "forks_url": "https://api.github.com/repos/bfredl/neovim/forks",
            "full_name": "bfredl/neovim",
            "git_commits_url": "https://api.github.com/repos/bfredl/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/bfredl/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/bfredl/neovim/git/tags{/sha}",
            "git_url": "git://github.com/bfredl/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "http://neovim.org/",
            "hooks_url": "https://api.github.com/repos/bfredl/neovim/hooks",
            "html_url": "https://github.com/bfredl/neovim",
            "id": 21050434,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/bfredl/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/bfredl/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/bfredl/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/bfredl/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/bfredl/neovim/labels{/name}",
            "language": "Vim script",
            "languages_url": "https://api.github.com/repos/bfredl/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/bfredl/neovim/merges",
            "milestones_url": "https://api.github.com/repos/bfredl/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkyMTA1MDQzNA==",
            "notifications_url": "https://api.github.com/repos/bfredl/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/bfredl/neovim/pulls{/number}",
            "pushed_at": "2023-08-27T12:28:10Z",
            "releases_url": "https://api.github.com/repos/bfredl/neovim/releases{/id}",
            "size": 251869,
            "ssh_url": "git@github.com:bfredl/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/bfredl/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/bfredl/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/bfredl/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/bfredl/neovim/subscription",
            "svn_url": "https://github.com/bfredl/neovim",
            "tags_url": "https://api.github.com/repos/bfredl/neovim/tags",
            "teams_url": "https://api.github.com/repos/bfredl/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/bfredl/neovim/git/trees{/sha}",
            "updated_at": "2022-03-21T08:01:17Z",
            "url": "https://api.github.com/repos/bfredl/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "008154954791001efcc46c28146e21403f3a698b",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
            "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
            "followers_url": "https://api.github.com/users/bfredl/followers",
            "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
            "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bfredl",
            "id": 1363104,
            "login": "bfredl",
            "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
            "organizations_url": "https://api.github.com/users/bfredl/orgs",
            "received_events_url": "https://api.github.com/users/bfredl/received_events",
            "repos_url": "https://api.github.com/users/bfredl/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bfredl"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/24824",
    "id": 1482844994,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24824",
    "labels": [
        {
            "color": "C5DEF5",
            "default": false,
            "description": "changes that are not features or bugfixes",
            "id": 106949155,
            "name": "refactor",
            "node_id": "MDU6TGFiZWwxMDY5NDkxNTU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/refactor"
        }
    ],
    "locked": false,
    "merge_commit_sha": "1bdcb9aaf11e914d4c7af14e8e5be4ed3c5798ae",
    "merged_at": "2023-08-26T10:35:23Z",
    "milestone": null,
    "node_id": "PR_kwDOAPphoM5YYmtC",
    "number": 24824,
    "patch_url": "https://github.com/neovim/neovim/pull/24824.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/24824/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/008154954791001efcc46c28146e21403f3a698b",
    "title": "refactor(change): do API changes to buffer without curbuf switch",
    "updated_at": "2023-08-27T09:32:13Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/24824",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
        "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
        "followers_url": "https://api.github.com/users/bfredl/followers",
        "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
        "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/bfredl",
        "id": 1363104,
        "login": "bfredl",
        "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
        "organizations_url": "https://api.github.com/users/bfredl/orgs",
        "received_events_url": "https://api.github.com/users/bfredl/received_events",
        "repos_url": "https://api.github.com/users/bfredl/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/bfredl"
    }
}