{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\r\n\r\nWhen executing some lua commands via vimscript's `try ... endtry`, the stacktrace for uncaught errors from the vimscript side are displayed in a single line. This makes the printed stacktrace  very difficult to read.\r\n\r\n\r\n```\r\n1. Without try-endtry: Display errors in a multi-line\r\nError detected while processing repro.vim[27]..function F:\r\nline    2:\r\nE5108: Error executing lua [string \":lua\"]:2: oops\r\nstack traceback:\r\n        [C]: in function 'error'\r\n        [string \":lua\"]:2: in function 'Oops'\r\n        [string \":lua\"]:1: in main chunk\r\n-------------------------------------------------\r\n\r\n2. With try-endtry: stacktraces are given in a single line\r\nError detected while processing repro.vim[27]..function F[9]..repro.vim[27]..function F:\r\nline    8:\r\nE5108: Error executing lua [string \":lua\"]:2: oops^@stack traceback:^@^I[C]: in function 'error'^@^I[string \":lua\"]:2: in function 'Oops'^@^I[string \":lua\"]:1: in main chunk\r\n```\r\n\r\n\r\n### Steps to reproduce\r\n\r\nRun `nvim -i NONE -u repro.vim`\r\n\r\n```vim\r\n\" neovim only\r\nlua << EOF\r\n  function _G.Oops()\r\n    error(\"oops\")\r\n  end\r\nEOF\r\ncommand! Oops lua _G.Oops()\r\n\r\n\r\nhi! Good  ctermfg=green ctermbg=black\r\nhi! Bad   ctermfg=red   ctermbg=black\r\nredraw  \" to make Error highlight in effect\r\n\r\n\" Note: no \"abort\" to execute all the body despite errors\r\nfunction! F(...)\r\n  echohl Good | echom \"1. Without try-endtry: Display errors in a multi-line\" | echom | echohl NONE\r\n  Oops\r\n\r\n  echom \"-------------------------------------------------\"\r\n\r\n  echohl Bad | echom \" \" | echom \"2. With try-endtry: stacktraces are given in a single line\" | echom | echohl NONE\r\n  try\r\n    Oops\r\n  endtry\r\nendfunction\r\n\r\ncall F()\r\n```\r\n\r\n\r\n### Expected behavior\r\n\r\nIn both cases, the stack trace should be printed in multiple lines (like Case 1).\r\n\r\n### Neovim version (nvim -v)\r\n\r\nnvim 0.6, 0.7, 0.8, 0.9, and HEAD(f9944a78b)\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nNot applicable. In vim script all the stacktraces are single line.\r\n\r\n### Operating system/version\r\n\r\nmacOS, Linux\r\n\r\n### Terminal name/version\r\n\r\nxterm\r\n\r\n### $TERM environment variable\r\n\r\nxterm-256color\r\n\r\n### Installation\r\n\r\nstable release & build from repo",
    "closed_at": "2023-09-25T00:23:26Z",
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thank you very much for the fast fix! Works well now. remote plugins (e.g. python3) also benefit from this as they also print multi-line stacktraces.",
            "created_at": "2023-09-25T01:36:30Z",
            "html_url": "https://github.com/neovim/neovim/issues/25350#issuecomment-1732772649",
            "id": 1732772649,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25350",
            "node_id": "IC_kwDOAPphoM5nSAMp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1732772649/reactions"
            },
            "updated_at": "2023-09-25T01:36:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1732772649",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1009873?v=4",
                "events_url": "https://api.github.com/users/wookayin/events{/privacy}",
                "followers_url": "https://api.github.com/users/wookayin/followers",
                "following_url": "https://api.github.com/users/wookayin/following{/other_user}",
                "gists_url": "https://api.github.com/users/wookayin/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/wookayin",
                "id": 1009873,
                "login": "wookayin",
                "node_id": "MDQ6VXNlcjEwMDk4NzM=",
                "organizations_url": "https://api.github.com/users/wookayin/orgs",
                "received_events_url": "https://api.github.com/users/wookayin/received_events",
                "repos_url": "https://api.github.com/users/wookayin/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/wookayin/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/wookayin/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/wookayin"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25350/comments",
    "created_at": "2023-09-24T22:41:37Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25350/events",
    "html_url": "https://github.com/neovim/neovim/issues/25350",
    "id": 1910405568,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c7def8",
            "default": false,
            "description": "",
            "id": 109899557,
            "name": "vimscript",
            "node_id": "MDU6TGFiZWwxMDk4OTk1NTc=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/vimscript"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 573222693,
            "name": "lua",
            "node_id": "MDU6TGFiZWw1NzMyMjI2OTM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lua"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "UI messages, log messages",
            "id": 5637083595,
            "name": "messages",
            "node_id": "LA_kwDOAPphoM8AAAABT_8Ryw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/messages"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25350/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 16,
        "created_at": "2023-09-02T00:43:50Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
            "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
            "followers_url": "https://api.github.com/users/zeertzjq/followers",
            "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
            "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/zeertzjq",
            "id": 35768171,
            "login": "zeertzjq",
            "node_id": "MDQ6VXNlcjM1NzY4MTcx",
            "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
            "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
            "repos_url": "https://api.github.com/users/zeertzjq/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/zeertzjq"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/39",
        "id": 9871452,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/39/labels",
        "node_id": "MI_kwDOAPphoM4AlqBc",
        "number": 39,
        "open_issues": 7,
        "state": "open",
        "title": "0.9.3",
        "updated_at": "2023-09-25T00:23:26Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/39"
    },
    "node_id": "I_kwDOAPphoM5x3nnA",
    "number": 25350,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25350/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25350/timeline",
    "title": "Lua stacktrace for an uncaught error isn't displayed in multiple lines, when \"try\" is used",
    "updated_at": "2023-09-25T01:36:30Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25350",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1009873?v=4",
        "events_url": "https://api.github.com/users/wookayin/events{/privacy}",
        "followers_url": "https://api.github.com/users/wookayin/followers",
        "following_url": "https://api.github.com/users/wookayin/following{/other_user}",
        "gists_url": "https://api.github.com/users/wookayin/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/wookayin",
        "id": 1009873,
        "login": "wookayin",
        "node_id": "MDQ6VXNlcjEwMDk4NzM=",
        "organizations_url": "https://api.github.com/users/wookayin/orgs",
        "received_events_url": "https://api.github.com/users/wookayin/received_events",
        "repos_url": "https://api.github.com/users/wookayin/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/wookayin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/wookayin/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/wookayin"
    }
}