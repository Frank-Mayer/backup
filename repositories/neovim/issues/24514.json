{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\ncommand \"nvim file.txt\" crashes immediately.\r\nnvim by itself works but once you open a file with \":e file.txt\" it crashes.\r\n\r\n### Steps to reproduce\r\n\r\nI compiled latest release following the instructions:\r\n\r\ncmake ../cmake.deps/ -DUSE_BUNDLED=OFF -DUSE_BUNDLED_LIBUV=ON -DUSE_BUNDLED_LUV=ON -DUSE_BUNDLED_LIBVTERM=ON -DUSE_BUNDLED_TS=ON -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_C_COMPILER=egcc\r\n\r\ncmake .. -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_C_COMPILER=egcc\r\n\r\nI ran into a problem where dependency headers like <vterm.h> were different than the ones provided in .deps and it didn't compile at first (unknown symbol VTStringFragment or something like that). After replacing the includes with this script:\r\n\r\n      import os\r\n      \r\n      BASE = os.getcwd()\r\n      DEPS_BASE = \".deps/build/src/\"\r\n      SRC_BASE = \"src/nvim/\"\r\n      \r\n      deps = []\r\n      for dep in os.listdir(DEPS_BASE):\r\n          for path, name, files in os.walk(DEPS_BASE + dep + \"/include\"):\r\n              for f in files:\r\n                  if f.endswith(\".h\"):\r\n                      deps.append((f, BASE + \"/\" + path + \"/\" + f))\r\n      for path, name, files in os.walk(SRC_BASE):\r\n          for f in files:\r\n              if f.endswith(\".c\"):\r\n                  contents = \"\"\r\n                  with open(path + \"/\" + f, \"r\") as h:\r\n                      contents = h.read()\r\n                      for dep, p in deps:\r\n                          if f\"<{dep}>\" in contents:\r\n                              print(f\"{f}: <{dep}> -> \\\"{p}\\\"\")\r\n                              contents = contents.replace(f\"<{dep}>\", f\"\\\"{p}\\\"\")\r\n                              #print(contents[:500])\r\n                  with open(path + \"/\" + f, \"w\") as h:\r\n                      written = 0\r\n                      while written < len(contents):\r\n                          w = h.write(contents)\r\n                          written += w\r\n                          contents = contents[w:]\r\ncompilation worked and I got the executable that crashes when you open a file. \r\n.config/nvim\r\n.local/share/nvim\r\n.cache/nvim\r\nhave all been cleared. Also crashes after running :checkhealth eventhough :checkhealth doesn't give any errors. After further testing I can say that it crashes with almost every command. \"!\" works though.\r\n\r\n\r\n### Expected behavior\r\n\r\nDoesn't crash when opening a file.\r\n\r\n### Neovim version (nvim -v)\r\n\r\n0.9.1\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nNA\r\n\r\n### Operating system/version\r\n\r\nOpenBSD 7.2\r\n\r\n### Terminal name/version\r\n\r\nterminator 1.92\r\n\r\n### $TERM environment variable\r\n\r\nxterm-256color\r\n\r\n### Installation\r\n\r\ncmake",
    "closed_at": "2023-07-30T18:07:41Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "The crash is a red herring and frankly irrelevant. We should focus on fixing the root problem (compile error) rather than the modified version so other openbsd users can benefit.\n\nDoes it compile if you only use bundled dependencies?",
            "created_at": "2023-07-30T13:40:31Z",
            "html_url": "https://github.com/neovim/neovim/issues/24514#issuecomment-1657176534",
            "id": 1657176534,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24514",
            "node_id": "IC_kwDOAPphoM5ixoHW",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657176534/reactions"
            },
            "updated_at": "2023-07-30T13:40:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657176534",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/33953936?v=4",
                "events_url": "https://api.github.com/users/dundargoc/events{/privacy}",
                "followers_url": "https://api.github.com/users/dundargoc/followers",
                "following_url": "https://api.github.com/users/dundargoc/following{/other_user}",
                "gists_url": "https://api.github.com/users/dundargoc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dundargoc",
                "id": 33953936,
                "login": "dundargoc",
                "node_id": "MDQ6VXNlcjMzOTUzOTM2",
                "organizations_url": "https://api.github.com/users/dundargoc/orgs",
                "received_events_url": "https://api.github.com/users/dundargoc/received_events",
                "repos_url": "https://api.github.com/users/dundargoc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dundargoc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dundargoc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dundargoc"
            }
        },
        {
            "author_association": "NONE",
            "body": "The crashes are gone after compiling with all bundled. The only header in /usr/local/include that seems to be problematic is vterm.h, so an easy workaround is to rename it during compilation. Reordering -I/usr/local/include -I/home/x/build/neovim-stable/.deps/usr/include in the Makefile (or wherever it is defined) would probably fix it?",
            "created_at": "2023-07-30T15:48:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/24514#issuecomment-1657205636",
            "id": 1657205636,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24514",
            "node_id": "IC_kwDOAPphoM5ixvOE",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657205636/reactions"
            },
            "updated_at": "2023-07-30T15:48:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657205636",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79748606?v=4",
                "events_url": "https://api.github.com/users/WernerDrasche/events{/privacy}",
                "followers_url": "https://api.github.com/users/WernerDrasche/followers",
                "following_url": "https://api.github.com/users/WernerDrasche/following{/other_user}",
                "gists_url": "https://api.github.com/users/WernerDrasche/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/WernerDrasche",
                "id": 79748606,
                "login": "WernerDrasche",
                "node_id": "MDQ6VXNlcjc5NzQ4NjA2",
                "organizations_url": "https://api.github.com/users/WernerDrasche/orgs",
                "received_events_url": "https://api.github.com/users/WernerDrasche/received_events",
                "repos_url": "https://api.github.com/users/WernerDrasche/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/WernerDrasche/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/WernerDrasche/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/WernerDrasche"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Unsure how that would help tbh. Also vterm.h isn't part of neovim but a dependency, libvterm. I have a strong suspicion what the problem might be. What version is your system libvterm (aka the non-bundled one)?",
            "created_at": "2023-07-30T16:26:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/24514#issuecomment-1657213798",
            "id": 1657213798,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24514",
            "node_id": "IC_kwDOAPphoM5ixxNm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657213798/reactions"
            },
            "updated_at": "2023-07-30T16:26:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657213798",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/33953936?v=4",
                "events_url": "https://api.github.com/users/dundargoc/events{/privacy}",
                "followers_url": "https://api.github.com/users/dundargoc/followers",
                "following_url": "https://api.github.com/users/dundargoc/following{/other_user}",
                "gists_url": "https://api.github.com/users/dundargoc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dundargoc",
                "id": 33953936,
                "login": "dundargoc",
                "node_id": "MDQ6VXNlcjMzOTUzOTM2",
                "organizations_url": "https://api.github.com/users/dundargoc/orgs",
                "received_events_url": "https://api.github.com/users/dundargoc/received_events",
                "repos_url": "https://api.github.com/users/dundargoc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dundargoc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dundargoc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dundargoc"
            }
        },
        {
            "author_association": "NONE",
            "body": "libvterm is from neovim 0.7.2 (package).\r\nThis is how the compilation error looks like (with -DUSE_BUNDLED_LIBVTERM=ON)\r\n\r\n    /home/x/build/neovim-stable/src/nvim/terminal.c: In function 'term_settermprop':\r\n    /home/x/build/neovim-stable/src/nvim/terminal.c:938:5: error: unknown type name 'VTermStringFragment'\r\n      938 |     VTermStringFragment frag = val->string;\r\n          |     ^~~~~~~~~~~~~~~~~~~\r\n\r\nThis is because the old libvterm header inside /usr/local/include differs from the one in .deps\r\nWorkaround: rename vterm.h to .bak inside /usr/local/include\r\nFix: prioritize headers from .deps before /usr/local/include headers in the makefile (if this is possible)",
            "created_at": "2023-07-30T17:52:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/24514#issuecomment-1657230239",
            "id": 1657230239,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24514",
            "node_id": "IC_kwDOAPphoM5ix1Of",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657230239/reactions"
            },
            "updated_at": "2023-07-30T17:53:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657230239",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79748606?v=4",
                "events_url": "https://api.github.com/users/WernerDrasche/events{/privacy}",
                "followers_url": "https://api.github.com/users/WernerDrasche/followers",
                "following_url": "https://api.github.com/users/WernerDrasche/following{/other_user}",
                "gists_url": "https://api.github.com/users/WernerDrasche/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/WernerDrasche",
                "id": 79748606,
                "login": "WernerDrasche",
                "node_id": "MDQ6VXNlcjc5NzQ4NjA2",
                "organizations_url": "https://api.github.com/users/WernerDrasche/orgs",
                "received_events_url": "https://api.github.com/users/WernerDrasche/received_events",
                "repos_url": "https://api.github.com/users/WernerDrasche/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/WernerDrasche/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/WernerDrasche/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/WernerDrasche"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Oh god yeah that's too old. You need to remove that.",
            "created_at": "2023-07-30T17:54:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/24514#issuecomment-1657230498",
            "id": 1657230498,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24514",
            "node_id": "IC_kwDOAPphoM5ix1Si",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657230498/reactions"
            },
            "updated_at": "2023-07-30T17:54:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657230498",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "(Cmake picking up system headers for bundled dependencies is a known general problem.)",
            "created_at": "2023-07-30T17:55:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/24514#issuecomment-1657230614",
            "id": 1657230614,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24514",
            "node_id": "IC_kwDOAPphoM5ix1UW",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657230614/reactions"
            },
            "updated_at": "2023-07-30T17:55:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657230614",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "It should not matter whether a dependency comes from deps or from system. The dependency detection is lacking in this case. Neovim is not able to determine libvterm patch version because this information is not available in libvterm source code, and therefore cannot distinguish between 0.3.0 vs 0.3.2. We will need to send a patch to @leonerd to add a PATCH_VERSION (something like that) variable i vterm.h, as is already done with the major version and minor version.",
            "created_at": "2023-07-30T19:36:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/24514#issuecomment-1657249162",
            "id": 1657249162,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24514",
            "node_id": "IC_kwDOAPphoM5ix52K",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657249162/reactions"
            },
            "updated_at": "2023-07-30T19:36:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1657249162",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/33953936?v=4",
                "events_url": "https://api.github.com/users/dundargoc/events{/privacy}",
                "followers_url": "https://api.github.com/users/dundargoc/followers",
                "following_url": "https://api.github.com/users/dundargoc/following{/other_user}",
                "gists_url": "https://api.github.com/users/dundargoc/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dundargoc",
                "id": 33953936,
                "login": "dundargoc",
                "node_id": "MDQ6VXNlcjMzOTUzOTM2",
                "organizations_url": "https://api.github.com/users/dundargoc/orgs",
                "received_events_url": "https://api.github.com/users/dundargoc/received_events",
                "repos_url": "https://api.github.com/users/dundargoc/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dundargoc/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dundargoc/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dundargoc"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/24514/comments",
    "created_at": "2023-07-30T07:43:08Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/24514/events",
    "html_url": "https://github.com/neovim/neovim/issues/24514",
    "id": 1827839971,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "building and installing Neovim using the provided scripts",
            "id": 84723321,
            "name": "build",
            "node_id": "MDU6TGFiZWw4NDcyMzMyMQ==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/build"
        },
        {
            "color": "d4c5f9",
            "default": false,
            "description": "issues specific to BSD descendants (please specify which in the issue)",
            "id": 201019594,
            "name": "platform:bsd",
            "node_id": "MDU6TGFiZWwyMDEwMTk1OTQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/platform:bsd"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/24514/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5s8p_j",
    "number": 24514,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/24514/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/24514/timeline",
    "title": "crashes when opening any file (OpenBSD 7.2)",
    "updated_at": "2023-07-30T19:36:59Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/24514",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/79748606?v=4",
        "events_url": "https://api.github.com/users/WernerDrasche/events{/privacy}",
        "followers_url": "https://api.github.com/users/WernerDrasche/followers",
        "following_url": "https://api.github.com/users/WernerDrasche/following{/other_user}",
        "gists_url": "https://api.github.com/users/WernerDrasche/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/WernerDrasche",
        "id": 79748606,
        "login": "WernerDrasche",
        "node_id": "MDQ6VXNlcjc5NzQ4NjA2",
        "organizations_url": "https://api.github.com/users/WernerDrasche/orgs",
        "received_events_url": "https://api.github.com/users/WernerDrasche/received_events",
        "repos_url": "https://api.github.com/users/WernerDrasche/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/WernerDrasche/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/WernerDrasche/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/WernerDrasche"
    }
}