{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nWhen completion popup menu is visible during entering tabstop text but no its entry is selected, snippet state seems to be not updated properly. This situation is common with autocompletion which uses built-in completion or if indeed user wants to use on demand built-in completion.\n\n### Steps to reproduce\n\n1. Create the following config file:\r\n```lua\r\nvim.keymap.set('i', '<C-l>', function() vim.snippet.jump(1) end)\r\nvim.keymap.set('i', '<C-e>', function() vim.snippet.expand('$1 = function($2)\\n$3\\nend') end)\r\n```\r\n2. Start Neovim with `--clean` and this config file.\r\n3. Start Insert mode and press `<C-e>` to expand the snippet.\r\n4. Press `<C-n>` to show completion popup and `<C-p>` to make no item selected.\r\n5. Press `<C-l>` to jump forward.\r\n6. Type any character. Whole line up until cursor is highlighted as if entered text in tabstop. Pressing `<C-l>` again moves cursor to the start of the snippet.\n\n### Expected behavior\n\nSnippet navigation does not depend on whether popup is visible or not.\r\n\r\n------\r\n\r\nWhat I assume is that some state tracking is not triggered when popup menu is visible. There are several places which met the eye on the first sight:\r\n- [These autocommands](https://github.com/neovim/neovim/blob/5cefec7349610853910c21a0215f85a4d47132d1/runtime/lua/vim/snippet.lua#L322) don't include `TextChangedP` (as `TextChangedI` is \"Not triggered when the popup menu is visible.\"). Although, I've added it and didn't see positive changes, but maybe I am missing something.\r\n- [These autocommands](https://github.com/neovim/neovim/blob/5cefec7349610853910c21a0215f85a4d47132d1/runtime/lua/vim/snippet.lua#L276) are not triggered when popup menu is visible (as per `:h CursorMovedI`). I would assume those should not be crucial here because cursor move is done with `vim.snippet.jump()`, but I might be missing something.\n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0-dev-1466+gec66a95fb-dirty\n\n### Vim (not Nvim) behaves the same?\n\nNo\n\n### Operating system/version\n\nEndeavourOS Linux x86_64 (6.5.9-arch2-1)\n\n### Terminal name/version\n\nst-0.9\n\n### $TERM environment variable\n\nst-256color\n\n### Installation\n\nFrom source",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25895/comments",
    "created_at": "2023-11-04T17:47:50Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25895/events",
    "html_url": "https://github.com/neovim/neovim/issues/25895",
    "id": 1977444812,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "",
            "id": 6207355257,
            "name": "snippets",
            "node_id": "LA_kwDOAPphoM8AAAABcfy5eQ",
            "url": "https://api.github.com/repos/neovim/neovim/labels/snippets"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25895/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM513WnM",
    "number": 25895,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25895/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25895/timeline",
    "title": "Snippet state is not updated when built-in completion popup menu is visible",
    "updated_at": "2023-11-14T12:05:36Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25895",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
        "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
        "followers_url": "https://api.github.com/users/echasnovski/followers",
        "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
        "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/echasnovski",
        "id": 24854248,
        "login": "echasnovski",
        "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
        "organizations_url": "https://api.github.com/users/echasnovski/orgs",
        "received_events_url": "https://api.github.com/users/echasnovski/received_events",
        "repos_url": "https://api.github.com/users/echasnovski/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/echasnovski"
    }
}