{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\n```\r\n$ ./venv/bin/python3 test.py \r\n==== Disable ext_cmdline ===\r\n### Start incsearch ###\r\ngrid_cursor_goto\r\ngrid_cursor_goto\r\n==== Enable ext_cmdline ===\r\n### Start incsearch ###\r\n```\r\n\r\n### Steps to reproduce\r\n\r\n- `pip install pynvim`\r\n- Install `NVIM v0.10.0`\r\n- Run `test.py`\r\n```python\r\nimport threading\r\n\r\nfrom pynvim import attach\r\nfrom pynvim.api.buffer import Buffer\r\n\r\n\r\ndef test(ext_cmdline):\r\n    print(\"====\", \"Enable\" if ext_cmdline else \"Disable\", \"ext_cmdline\", \"===\")\r\n\r\n    start_incsearch = False\r\n\r\n    def event_handler(_, data):\r\n        if not start_incsearch:\r\n            return\r\n        for ev in data:\r\n            ev_name = ev[0]\r\n            if 'cursor' in ev_name:\r\n                print(ev_name)\r\n\r\n    nvim = attach('child', argv=[\"nvim\", \"--embed\", \"--clean\"])\r\n    nvim.ui_attach(40, 20, True, ext_cmdline=ext_cmdline, ext_linegrid=True)\r\n\r\n    buf: Buffer = nvim.api.create_buf(False, True)\r\n    buf.append(['a', 'b', 'c', *[''] * 20, 'd', 'e', 'f'])\r\n    nvim.api.open_win(\r\n        buf,\r\n        True,\r\n        {\r\n            'relative': 'win',\r\n            'row': 3,\r\n            'col': 3,\r\n            'width': 30,\r\n            'height': 15,\r\n        },\r\n    )\r\n\r\n    def incsearch():\r\n        nonlocal start_incsearch\r\n        start_incsearch = True\r\n        print('### Start incsearch ###')\r\n        nvim.input('gg/e')\r\n\r\n    timer = threading.Timer(1, lambda: nvim.async_call(incsearch))\r\n    timer.start()\r\n\r\n    quit = threading.Timer(2, lambda: nvim.async_call(lambda: nvim.quit()))\r\n    quit.start()\r\n\r\n    nvim.run_loop(event_handler, event_handler)\r\n\r\n\r\ntest(False)\r\ntest(True)\r\n```\r\n\r\n### Expected behavior\r\n\r\nShould the events be the same? Or is this expected behavior?\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.10.0\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\n-\r\n\r\n### Operating system/version\r\n\r\nWindows 11\r\n\r\n### Terminal name/version\r\n\r\nWindows Terminal\r\n\r\n### $TERM environment variable\r\n\r\n-\r\n\r\n### Installation\r\n\r\nScoop",
    "closed_at": "2024-05-17T12:36:06Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "```\r\n==== Disable ext_cmdline ===\r\n### Start incsearch ###\r\n['grid_cursor_goto', [1, 19, 2]]\r\n['grid_scroll', [1, 3, 18, 3, 33, 11, 0]]\r\n['win_viewport', [4, <Window(handle=1001)>, 11, 27, 25, 1, 27, 11]]\r\n['grid_cursor_goto', [1, 19, 2]]\r\n==== Enable ext_cmdline ===\r\n### Start incsearch ###\r\n['grid_scroll', [1, 3, 18, 3, 33, 11, 0]]\r\n['win_viewport', [4, <Window(handle=1001)>, 11, 27, 25, 1, 27, 11]]\r\n```\r\n\r\n~~I printed out events related to scroll and viewport. It seems like this behavior is an intentional change in version 0.10? incsearch scrolls the window but doesn't move the cursor.~~\r\n\r\n~~There should be relevant commits in the commit log.~~\r\n\r\nI forgot that the current issue is that ext_cmdline is causing event inconsistencies, which should not be the expected behavior.",
            "created_at": "2024-05-17T10:37:44Z",
            "html_url": "https://github.com/neovim/neovim/issues/28800#issuecomment-2117274731",
            "id": 2117274731,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28800",
            "node_id": "IC_kwDOAPphoM5-Mwxr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117274731/reactions"
            },
            "updated_at": "2024-05-17T10:52:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117274731",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/47070852?v=4",
                "events_url": "https://api.github.com/users/xiyaowong/events{/privacy}",
                "followers_url": "https://api.github.com/users/xiyaowong/followers",
                "following_url": "https://api.github.com/users/xiyaowong/following{/other_user}",
                "gists_url": "https://api.github.com/users/xiyaowong/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/xiyaowong",
                "id": 47070852,
                "login": "xiyaowong",
                "node_id": "MDQ6VXNlcjQ3MDcwODUy",
                "organizations_url": "https://api.github.com/users/xiyaowong/orgs",
                "received_events_url": "https://api.github.com/users/xiyaowong/received_events",
                "repos_url": "https://api.github.com/users/xiyaowong/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/xiyaowong/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/xiyaowong/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/xiyaowong"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I forgot that the current issue is that ext_cmdline is causing event inconsistencies, which should not be the expected behavior.\r\n\r\nWhy not? This event was intentionally removed in [`d41b8d4` (#27858)](https://github.com/neovim/neovim/pull/27858/commits/d41b8d47587bd4c300420fa76f517298e97af513). All it did is send an event placing the cursor in the current window. Which is unhelpful, because the cursor should be in the cmdline which is unknown to Nvim. Unlike when ext_cmdline is disabled where this event does place the cursor in the cmdline(message grid).",
            "created_at": "2024-05-17T12:28:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/28800#issuecomment-2117490246",
            "id": 2117490246,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28800",
            "node_id": "IC_kwDOAPphoM5-NlZG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117490246/reactions"
            },
            "updated_at": "2024-05-17T12:28:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117490246",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "NONE",
            "body": "But the cursor is actually changed:\r\n```\r\n==== Disable ext_cmdline ===\r\ncursor (1, 0)\r\n### Start incsearch ###\r\ngrid_cursor_goto\r\ngrid_cursor_goto\r\ncursor (26, 1)\r\n==== Enable ext_cmdline ===\r\ncursor (1, 0)\r\n### Start incsearch ###\r\ncursor (26, 1)\r\n```\r\n```python\r\n    def incsearch():\r\n        nonlocal start_incsearch\r\n        start_incsearch = True\r\n        print('cursor', win.cursor)\r\n        print(\"### Start incsearch ###\")\r\n        nvim.input(\"gg/e\")\r\n        print('cursor', win.cursor)\r\n```\r\n\r\n",
            "created_at": "2024-05-17T12:46:21Z",
            "html_url": "https://github.com/neovim/neovim/issues/28800#issuecomment-2117525212",
            "id": 2117525212,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28800",
            "node_id": "IC_kwDOAPphoM5-Nt7c",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117525212/reactions"
            },
            "updated_at": "2024-05-17T12:51:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117525212",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/47070852?v=4",
                "events_url": "https://api.github.com/users/xiyaowong/events{/privacy}",
                "followers_url": "https://api.github.com/users/xiyaowong/followers",
                "following_url": "https://api.github.com/users/xiyaowong/following{/other_user}",
                "gists_url": "https://api.github.com/users/xiyaowong/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/xiyaowong",
                "id": 47070852,
                "login": "xiyaowong",
                "node_id": "MDQ6VXNlcjQ3MDcwODUy",
                "organizations_url": "https://api.github.com/users/xiyaowong/orgs",
                "received_events_url": "https://api.github.com/users/xiyaowong/received_events",
                "repos_url": "https://api.github.com/users/xiyaowong/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/xiyaowong/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/xiyaowong/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/xiyaowong"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Well yes the cursor position in the current window changes for incsearch but the cursor position on the grid does not and should not(implicitly). What problem does this cause?",
            "created_at": "2024-05-17T12:52:52Z",
            "html_url": "https://github.com/neovim/neovim/issues/28800#issuecomment-2117537788",
            "id": 2117537788,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28800",
            "node_id": "IC_kwDOAPphoM5-Nw_8",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117537788/reactions"
            },
            "updated_at": "2024-05-17T12:52:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117537788",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "NONE",
            "body": "The potential issues may be related to the way UI events are handled. vscode-neovim currently only can **adjust** viewport based on cursor position rather than **drawing**. \r\n\r\nHowever, the example I provided is indeed a special case, and the logic can be adjusted to solve it.",
            "created_at": "2024-05-17T13:28:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/28800#issuecomment-2117611542",
            "id": 2117611542,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28800",
            "node_id": "IC_kwDOAPphoM5-ODAW",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117611542/reactions"
            },
            "updated_at": "2024-05-17T13:33:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2117611542",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/47070852?v=4",
                "events_url": "https://api.github.com/users/xiyaowong/events{/privacy}",
                "followers_url": "https://api.github.com/users/xiyaowong/followers",
                "following_url": "https://api.github.com/users/xiyaowong/following{/other_user}",
                "gists_url": "https://api.github.com/users/xiyaowong/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/xiyaowong",
                "id": 47070852,
                "login": "xiyaowong",
                "node_id": "MDQ6VXNlcjQ3MDcwODUy",
                "organizations_url": "https://api.github.com/users/xiyaowong/orgs",
                "received_events_url": "https://api.github.com/users/xiyaowong/received_events",
                "repos_url": "https://api.github.com/users/xiyaowong/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/xiyaowong/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/xiyaowong/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/xiyaowong"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/28800/comments",
    "created_at": "2024-05-17T01:47:14Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/28800/events",
    "html_url": "https://github.com/neovim/neovim/issues/28800",
    "id": 2301651882,
    "labels": [
        {
            "color": "e6e6e6",
            "default": false,
            "description": "issues that are closed as usage questions",
            "id": 77997478,
            "name": "closed:question",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3OA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/closed:question"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains minimal reproducing steps",
            "id": 435851959,
            "name": "has:repro",
            "node_id": "MDU6TGFiZWw0MzU4NTE5NTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:repro"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "UI extensibility, events, protocol",
            "id": 640132777,
            "name": "ui-extensibility",
            "node_id": "MDU6TGFiZWw2NDAxMzI3Nzc=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui-extensibility"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/28800/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 11,
        "created_at": "2023-12-07T23:09:35Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "",
        "due_on": "2024-10-31T07:00:00Z",
        "html_url": "https://github.com/neovim/neovim/milestone/41",
        "id": 10283236,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/41/labels",
        "node_id": "MI_kwDOAPphoM4AnOjk",
        "number": 41,
        "open_issues": 59,
        "state": "open",
        "title": "0.11",
        "updated_at": "2024-05-19T22:02:51Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/41"
    },
    "node_id": "I_kwDOAPphoM6JMGuq",
    "number": 28800,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/28800/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/28800/timeline",
    "title": "When `ext_cmdline` is enabled, the event `grid_cursor_goto` will not be sent during incsearch",
    "updated_at": "2024-05-17T13:33:03Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/28800",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/47070852?v=4",
        "events_url": "https://api.github.com/users/xiyaowong/events{/privacy}",
        "followers_url": "https://api.github.com/users/xiyaowong/followers",
        "following_url": "https://api.github.com/users/xiyaowong/following{/other_user}",
        "gists_url": "https://api.github.com/users/xiyaowong/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/xiyaowong",
        "id": 47070852,
        "login": "xiyaowong",
        "node_id": "MDQ6VXNlcjQ3MDcwODUy",
        "organizations_url": "https://api.github.com/users/xiyaowong/orgs",
        "received_events_url": "https://api.github.com/users/xiyaowong/received_events",
        "repos_url": "https://api.github.com/users/xiyaowong/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/xiyaowong/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xiyaowong/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/xiyaowong"
    }
}