{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "- `nvim --version`:\r\n```\r\n:version\r\nNVIM v0.2.3-495-g2820860ba\r\nBuild type: Debug\r\nLuaJIT 2.0.5\r\nCompilation: /usr/bin/cc -Wconversion -DNVIM_MSGPACK_HAS_FLOAT32 -DNVIM_UNIBI_HAS_VAR_FROM -g -Wall -Wextra -pedantic -Wno-unused-parameter -Wstrict-prototypes -std=gnu99 -Wimplicit-fallthrough -Wvla -fstack-protector-strong -fdiagnostics-color=auto -DINCLUDE_GENERATED_DEC\r\nLARATIONS -D_GNU_SOURCE -I/home/matthew/repos/neovim/build/config -I/home/matthew/repos/neovim/src -I/home/matthew/repos/neovim/.deps/usr/include -I/home/matthew/repos/neovim/.deps/usr/include -I/home/matthew/repos/neovim/.deps/usr/include -I/home/matthew/repos/neovim/.dep\r\ns/usr/include -I/home/matthew/repos/neovim/.deps/usr/include -I/home/matthew/repos/neovim/.deps/usr/include -I/usr/include -I/home/matthew/repos/neovim/build/src/nvim/auto -I/home/matthew/repos/neovim/build/include\r\nCompiled by ...\r\n\r\nFeatures: +acl +iconv +jemalloc +tui\r\nSee \":help feature-compile\"\r\n\r\n   system vimrc file: \"$VIM/sysinit.vim\"\r\n  fall-back for $VIM: \"/usr/local/share/nvim\"\r\n\r\nRun :checkhealth for more info\r\n```\r\n- Vim (version: ) behaves differently?\r\n```\r\n:version\r\nVIM - Vi IMproved 8.0 (2016 Sep 12, compiled Dec 19 2017 20:38:43)\r\nIncluded patches: 1-1415\r\nCompiled by Arch Linux\r\nHuge version with GTK3 GUI.  Features included (+) or not (-):\r\n+acl               +channel           +cryptv            +emacs_tags        -footer            +lambda            +mksession         -mouse_sysmouse    +path_extra        +reltime           +syntax            +textobjects       +viminfo           -xpm\r\n+arabic            +cindent           +cscope            +eval              +fork()            +langmap           +modify_fname      +mouse_urxvt       +perl/dyn          +rightleft         +tag_binary        +timers            +vreplace          +xsmp_interact\r\n+autocmd           +clientserver      +cursorbind        +ex_extra          +gettext           +libcall           +mouse             +mouse_xterm       +persistent_undo   +ruby/dyn          +tag_old_static    +title             +wildignore        +xterm_clipboard\r\n-autoservername    +clipboard         +cursorshape       +extra_search      -hangul_input      +linebreak         +mouseshape        +multi_byte        +postscript        +scrollbind        -tag_any_white     +toolbar           +wildmenu          -xterm_save\r\n+balloon_eval      +cmdline_compl     +dialog_con_gui    +farsi             +iconv             +lispindent        +mouse_dec         +multi_lang        +printer           +signs             +tcl/dyn           +user_commands     +windows\r\n+balloon_eval_term +cmdline_hist      +diff              +file_in_path      +insert_expand     +listcmds          +mouse_gpm         -mzscheme          +profile           +smartindent       +termguicolors     +vertsplit         +writebackup\r\n+browse            +cmdline_info      +digraphs          +find_in_path      +job               +localmap          -mouse_jsbterm     +netbeans_intg     +python/dyn        +startuptime       +terminal          +virtualedit       +X11\r\n++builtin_terms    +comments          +dnd               +float             +jumplist          +lua/dyn           +mouse_netterm     +num64             +python3/dyn       +statusline        +terminfo          +visual            -xfontset\r\n+byte_offset       +conceal           -ebcdic            +folding           +keymap            +menu              +mouse_sgr         +packages          +quickfix          -sun_workshop      +termresponse      +visualextra       +xim\r\n   system vimrc file: \"/etc/vimrc\"\r\n     user vimrc file: \"$HOME/.vimrc\"\r\n 2nd user vimrc file: \"~/.vim/vimrc\"\r\n      user exrc file: \"$HOME/.exrc\"\r\n  system gvimrc file: \"/etc/gvimrc\"\r\n    user gvimrc file: \"$HOME/.gvimrc\"\r\n2nd user gvimrc file: \"~/.vim/gvimrc\"\r\n       defaults file: \"$VIMRUNTIME/defaults.vim\"\r\n    system menu file: \"$VIMRUNTIME/menu.vim\"\r\n  fall-back for $VIM: \"/usr/share/vim\"\r\nCompilation: gcc -c -I. -Iproto -DHAVE_CONFIG_H -DFEAT_GUI_GTK  -pthread -I/usr/include/gtk-3.0 -I/usr/include/at-spi2-atk/2.0 -I/usr/include/at-spi-2.0 -I/usr/include/dbus-1.0 -I/usr/lib/dbus-1.0/include -I/usr/include/gtk-3.0 -I/usr/include/gio-unix-2.0/ -I/usr/include/c\r\nairo -I/usr/include/pango-1.0 -I/usr/include/atk-1.0 -I/usr/include/cairo -I/usr/include/pixman-1 -I/usr/include/freetype2 -I/usr/include/libpng16 -I/usr/include/harfbuzz -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include -I/usr/include/freetype2 -I/usr/include/harfbuzz -\r\nI/usr/include/libpng16 -I/usr/include/gdk-pixbuf-2.0 -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include -D_FORTIFY_SOURCE=2  -march=x86-64 -mtune=generic -O2 -pipe -fstack-protector-strong -fno-plt -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1\r\nLinking: gcc   -L. -Wl,-O1,--sort-common,--as-needed,-z,relro,-z,now -fstack-protector -rdynamic -Wl,-export-dynamic -Wl,-E -Wl,-rpath,/usr/lib/perl5/5.26/core_perl/CORE  -Wl,-O1,--sort-common,--as-needed,-z,relro,-z,now -L/usr/local/lib -Wl,--as-needed -o vim   -lgtk-3 -l\r\ngdk-3 -lpangocairo-1.0 -lpango-1.0 -latk-1.0 -lcairo-gobject -lcairo -lgdk_pixbuf-2.0 -lgio-2.0 -lgobject-2.0 -lglib-2.0 -lSM -lICE -lXt -lX11 -lXdmcp -lSM -lICE  -lm -ltinfo -lelf -lnsl    -lacl -lattr -lgpm -ldl   -Wl,-E -Wl,-rpath,/usr/lib/perl5/5.26/core_perl/CORE -Wl,\r\n-O1,--sort-common,--as-needed,-z,relro,-z,now -fstack-protector-strong -L/usr/local/lib  -L/usr/lib/perl5/5.26/core_perl/CORE -lperl -lpthread -lnsl -ldl -lm -lcrypt -lutil -lc   -L/usr/lib -ltclstub8.6 -ldl -lz -lpthread -lieee -lm\r\n```\r\nYes -- no crash\r\n- Operating system/version: arch linux\r\n- Terminal name/version: xterm\r\n- `$TERM`: `xterm-256color`\r\n\r\n### Steps to reproduce using `nvim -u NORC`\r\n\r\n```\r\nnvim -u NONE\r\ni<C-r>=system('ls *.h')<left><left><left><left><left>'\r\n```\r\nn.b. have to move to before the `*` in the command, and `'` after the motion is the key that triggers the assertion failure.\r\n\r\n### Actual behaviour\r\nassert failure\r\n### Expected behaviour\r\nno assert failure\r\n\r\n\r\n### Backtrace from the coredump\r\n```\r\n(gdb) bt\r\n#0  0x00007f85f05aa860 in raise () from /usr/lib/libc.so.6\r\n#1  0x00007f85f05abec9 in abort () from /usr/lib/libc.so.6\r\n#2  0x00007f85f05a30bc in __assert_fail_base () from /usr/lib/libc.so.6\r\n#3  0x00007f85f05a3133 in __assert_fail () from /usr/lib/libc.so.6\r\n#4  0x0000555b77424dc3 in viml_pexpr_handle_bop (pstate=0x7fffcbd90a80, ast_stack=0x7fffcbd908f0, bop_node=0x7f85f004f460, want_node_p=0x7fffcbd8f58c, ast_err=0x7fffcbd90780) at ../src/nvim/viml/parser/expressions.c:1239\r\n#5  0x0000555b7743ed2a in viml_pexpr_parse (pstate=0x7fffcbd90a80, flags=2) at ../src/nvim/viml/parser/expressions.c:2914\r\n#6  0x0000555b77297d3b in color_expr_cmdline (colored_ccline=0x555b777e3a00 <ccline>, ret_ccline_colors=0x555b777e3a60 <ccline+96>) at ../src/nvim/ex_getln.c:2463\r\n#7  0x0000555b772984e7 in color_cmdline (colored_ccline=0x555b777e3a00 <ccline>) at ../src/nvim/ex_getln.c:2578\r\n#8  0x0000555b77298f5c in draw_cmdline (start=11, len=6) at ../src/nvim/ex_getln.c:2737\r\n#9  0x0000555b7729a876 in put_on_cmdline (str=0x555b777f1180 <IObuff> \"'\", len=1, redraw=1) at ../src/nvim/ex_getln.c:3118\r\n#10 0x0000555b77296969 in command_line_handle_key (s=0x7fffcbd911b0) at ../src/nvim/ex_getln.c:1739\r\n#11 0x0000555b77294a02 in command_line_execute (state=0x7fffcbd911b0, key=39) at ../src/nvim/ex_getln.c:1013\r\n#12 0x0000555b773ec97e in state_enter (s=0x7fffcbd911b0) at ../src/nvim/state.c:67\r\n#13 0x0000555b77292d8c in command_line_enter (firstc=61, count=0, indent=0) at ../src/nvim/ex_getln.c:384\r\n#14 0x0000555b77296f24 in getcmdline (firstc=61, count=0, indent=0) at ../src/nvim/ex_getln.c:1920\r\n#15 0x0000555b77332915 in get_expr_register () at ../src/nvim/ops.c:667\r\n#16 0x0000555b7720c59d in ins_reg () at ../src/nvim/edit.c:7033\r\n#17 0x0000555b77200083 in insert_handle_key (s=0x7fffcbd91540) at ../src/nvim/edit.c:867\r\n#18 0x0000555b771ff9c6 in insert_execute (state=0x7fffcbd91540, key=18) at ../src/nvim/edit.c:764\r\n#19 0x0000555b773ec97e in state_enter (s=0x7fffcbd91540) at ../src/nvim/state.c:67\r\n#20 0x0000555b771fefb7 in insert_enter (s=0x7fffcbd91540) at ../src/nvim/edit.c:458\r\n#21 0x0000555b77200a9c in edit (cmdchar=105, startln=false, count=1) at ../src/nvim/edit.c:1327\r\n#22 0x0000555b773302a6 in invoke_edit (cap=0x7fffcbd91740, repl=0, cmd=105, startln=0) at ../src/nvim/normal.c:7583\r\n#23 0x0000555b7733023c in nv_edit (cap=0x7fffcbd91740) at ../src/nvim/normal.c:7555\r\n#24 0x0000555b77321492 in normal_execute (state=0x7fffcbd916a0, key=105) at ../src/nvim/normal.c:1136\r\n#25 0x0000555b773ec97e in state_enter (s=0x7fffcbd916a0) at ../src/nvim/state.c:67\r\n#26 0x0000555b7731f7a4 in normal_enter (cmdwin=false, noexmode=false) at ../src/nvim/normal.c:466\r\n#27 0x0000555b772e4b48 in main (argc=3, argv=0x7fffcbd919f8) at ../src/nvim/main.c:572\r\n```",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "New steps to reproduce:\r\n`nvim -u NONE`\r\n`i<C-r>=system('ls *`\r\nAnd then place the `'` anywhere, starting from the left of the \"s\" letter of `ls`\r\nSo you can do `<left><left><left>` and then as many lefts as you want before placing the `'`.\r\nTo be clear, you can move freely, not only with `<left>`s, and as long as you place the tilde as said it will fail.",
            "created_at": "2018-02-09T13:35:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/7889#issuecomment-364435044",
            "id": 364435044,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/7889",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDQzNTA0NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/364435044/reactions"
            },
            "updated_at": "2018-02-09T13:35:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/364435044",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1503935?v=4",
                "events_url": "https://api.github.com/users/doraemon96/events{/privacy}",
                "followers_url": "https://api.github.com/users/doraemon96/followers",
                "following_url": "https://api.github.com/users/doraemon96/following{/other_user}",
                "gists_url": "https://api.github.com/users/doraemon96/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/doraemon96",
                "id": 1503935,
                "login": "doraemon96",
                "node_id": "MDQ6VXNlcjE1MDM5MzU=",
                "organizations_url": "https://api.github.com/users/doraemon96/orgs",
                "received_events_url": "https://api.github.com/users/doraemon96/received_events",
                "repos_url": "https://api.github.com/users/doraemon96/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/doraemon96/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/doraemon96/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/doraemon96"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "That system highlighting like this has no state, using `<left>` is not needed: crash would be one and the same whether you typed `system(''ls *` right from the beginning or used `<left>`. Problematic sequence also has nothing to do with `system()`, the reduced example is `0 0 *`: two values without an operator followed by an operator. Should be some problem with missing operator priority.",
            "created_at": "2018-05-20T19:46:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/7889#issuecomment-390506464",
            "id": 390506464,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/7889",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDUwNjQ2NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/390506464/reactions"
            },
            "updated_at": "2018-05-20T19:46:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/390506464",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/322097?v=4",
                "events_url": "https://api.github.com/users/ZyX-I/events{/privacy}",
                "followers_url": "https://api.github.com/users/ZyX-I/followers",
                "following_url": "https://api.github.com/users/ZyX-I/following{/other_user}",
                "gists_url": "https://api.github.com/users/ZyX-I/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ZyX-I",
                "id": 322097,
                "login": "ZyX-I",
                "node_id": "MDQ6VXNlcjMyMjA5Nw==",
                "organizations_url": "https://api.github.com/users/ZyX-I/orgs",
                "received_events_url": "https://api.github.com/users/ZyX-I/received_events",
                "repos_url": "https://api.github.com/users/ZyX-I/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ZyX-I/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ZyX-I/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ZyX-I"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Another way to reproduce (local dev build on 69507c0204cfe284e42865c9c89baec0f351b2c1)\r\n\r\n```vim\r\n:<C-R>=1/250*10e\r\n\"              ^ assertion failure occurs on typing 'e'\r\n```\r\n\r\n```\r\nAssertion failed: (bop_node_lvl != new_top_node_lvl || bop_node_ass == new_top_node_ass), function viml_pexpr_handle_bop, file expressions.c, line 1280.\r\n```",
            "created_at": "2022-11-17T11:44:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/7889#issuecomment-1318514381",
            "id": 1318514381,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/7889",
            "node_id": "IC_kwDOAPphoM5Olu7N",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1318514381/reactions"
            },
            "updated_at": "2022-11-17T11:44:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1318514381",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/205673?v=4",
                "events_url": "https://api.github.com/users/bobrippling/events{/privacy}",
                "followers_url": "https://api.github.com/users/bobrippling/followers",
                "following_url": "https://api.github.com/users/bobrippling/following{/other_user}",
                "gists_url": "https://api.github.com/users/bobrippling/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bobrippling",
                "id": 205673,
                "login": "bobrippling",
                "node_id": "MDQ6VXNlcjIwNTY3Mw==",
                "organizations_url": "https://api.github.com/users/bobrippling/orgs",
                "received_events_url": "https://api.github.com/users/bobrippling/received_events",
                "repos_url": "https://api.github.com/users/bobrippling/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bobrippling/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bobrippling/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bobrippling"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/7889/comments",
    "created_at": "2018-01-21T13:37:22Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/7889/events",
    "html_url": "https://github.com/neovim/neovim/issues/7889",
    "id": 290273417,
    "labels": [
        {
            "color": "c7def8",
            "default": false,
            "description": "",
            "id": 109899557,
            "name": "vimscript",
            "node_id": "MDU6TGFiZWwxMDk4OTk1NTc=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/vimscript"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains minimal reproducing steps",
            "id": 435851959,
            "name": "has:repro",
            "node_id": "MDU6TGFiZWw0MzU4NTE5NTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:repro"
        },
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "command line, also cmdwin",
            "id": 5826989442,
            "name": "cmdline-mode",
            "node_id": "LA_kwDOAPphoM8AAAABW1DNgg",
            "url": "https://api.github.com/repos/neovim/neovim/labels/cmdline-mode"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/7889/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 629,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Low priority. Not planned for the current target, may be reassigned.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 546,
        "state": "open",
        "title": "backlog",
        "updated_at": "2024-07-13T00:12:58Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "MDU6SXNzdWUyOTAyNzM0MTc=",
    "number": 7889,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/7889/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/7889/timeline",
    "title": "assert failure in command line syntax highlighting",
    "updated_at": "2024-07-10T22:36:18Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/7889",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/4070620?v=4",
        "events_url": "https://api.github.com/users/hardenedapple/events{/privacy}",
        "followers_url": "https://api.github.com/users/hardenedapple/followers",
        "following_url": "https://api.github.com/users/hardenedapple/following{/other_user}",
        "gists_url": "https://api.github.com/users/hardenedapple/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/hardenedapple",
        "id": 4070620,
        "login": "hardenedapple",
        "node_id": "MDQ6VXNlcjQwNzA2MjA=",
        "organizations_url": "https://api.github.com/users/hardenedapple/orgs",
        "received_events_url": "https://api.github.com/users/hardenedapple/received_events",
        "repos_url": "https://api.github.com/users/hardenedapple/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/hardenedapple/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hardenedapple/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/hardenedapple"
    }
}