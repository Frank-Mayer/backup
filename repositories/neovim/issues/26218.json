{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nOn some files, neovim seems to get 'stuck' on some values and when doing `vim.lsp.buf.format({ async = false })` the changes get undone.\r\n\r\nThe above is an example from my current vue project. The content after using the command is the previous content of those fields.\r\n\r\nBefore using the command (pay attention to the `@click` actions):\r\n\r\n```vue\r\n<template>\r\n\t<div class=\"d-flex align-center justify-center pa-4\">\r\n\t\t<v-btn :disabled=\"page === 1\" icon=\"mdi-arrow-left\" density=\"comfortable\" variant=\"tonal\" rounded\r\n\t\t\t@click=\"emit('prevPage')\"></v-btn>\r\n\r\n\t\t<div class=\"mx-2 text-caption\">\r\n\t\t\tPage {{ page }} of {{ pageCount }}\r\n\t\t</div>\r\n\r\n\t\t<v-btn :disabled=\"page >= pageCount\" icon=\"mdi-arrow-right\" density=\"comfortable\" variant=\"tonal\" rounded\r\n\t\t\t@click=\"emit('nextPage')\"></v-btn>\r\n\t</div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { defineProps } from 'vue';\r\n\r\ndefineEmits([\"nextPage\", \"prevPage\"])\r\n\r\ndefineProps({\r\n  page: {\r\n\t  type: Number,\r\n\t\trequired: true\r\n\t},\r\n  pageCount: {\r\n\t  type: Number,\r\n\t\trequired: true\r\n\t},\r\n  nextPage: {\r\n\t\ttype: Function,\r\n\t\trequired: true\r\n\t},\r\n  prevPage: {\r\n\t\ttype: Function,\r\n\t\trequired: true\r\n\t}\r\n})\r\n</script>\r\n```\r\n\r\nAfter using the command:\r\n\r\n```vue\r\n<template>\r\n\t<div class=\"d-flex align-center justify-center pa-4\">\r\n\t\t<v-btn :disabled=\"page === 1\" icon=\"mdi-arrow-left\" density=\"comfortable\" variant=\"tonal\" rounded\r\n\t\t\t@click=\"prevPage\"></v-btn>\r\n\r\n\t\t<div class=\"mx-2 text-caption\">\r\n\t\t\tPage {{ page }} of {{ pageCount }}\r\n\t\t</div>\r\n\r\n\t\t<v-btn :disabled=\"page >= pageCount\" icon=\"mdi-arrow-right\" density=\"comfortable\" variant=\"tonal\" rounded\r\n\t\t\t@click=\"nextPage\"></v-btn>\r\n\t</div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { defineProps } from 'vue';\r\n\r\ndefineEmits([\"nextPage\", \"prevPage\"])\r\n\r\ndefineProps({\r\n  page: {\r\n\t  type: Number,\r\n\t\trequired: true\r\n\t},\r\n  pageCount: {\r\n\t  type: Number,\r\n\t\trequired: true\r\n\t},\r\n  nextPage: {\r\n\t\ttype: Function,\r\n\t\trequired: true\r\n\t},\r\n  prevPage: {\r\n\t\ttype: Function,\r\n\t\trequired: true\r\n\t}\r\n})\r\n</script>\r\n```\n\n### Steps to reproduce\n\nStill unknown, seems the happening random.\n\n### Expected behavior\n\nRefactoring not changing the codes content like this\n\n### Neovim version (nvim -v)\n\n0.9.2\n\n### Vim (not Nvim) behaves the same?\n\nunknown\n\n### Operating system/version\n\nmacOS 14.1.1\n\n### Terminal name/version\n\niTerm2 3.4.22\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nfrom github release",
    "closed_at": "2023-11-25T21:01:05Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "a diff would be helpul. here:\r\n\r\n![image](https://github.com/neovim/neovim/assets/1359421/e1becf55-8089-4c31-8886-f81bc35170ae)\r\n\r\n\r\nNeovim obviously isn't doing this, so report it to your lsp server, or plugins or whatever.\r\n\r\nno steps to reproduce so closing",
            "created_at": "2023-11-25T21:01:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/26218#issuecomment-1826419029",
            "id": 1826419029,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26218",
            "node_id": "IC_kwDOAPphoM5s3PFV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1826419029/reactions"
            },
            "updated_at": "2023-11-25T21:01:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1826419029",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/26218/comments",
    "created_at": "2023-11-25T19:48:38Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/26218/events",
    "html_url": "https://github.com/neovim/neovim/issues/26218",
    "id": 2010777607,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/26218/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM532ggH",
    "number": 26218,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/26218/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/26218/timeline",
    "title": "Formatting resets some changes",
    "updated_at": "2023-11-25T21:01:05Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/26218",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/103406971?v=4",
        "events_url": "https://api.github.com/users/dominicmeyer/events{/privacy}",
        "followers_url": "https://api.github.com/users/dominicmeyer/followers",
        "following_url": "https://api.github.com/users/dominicmeyer/following{/other_user}",
        "gists_url": "https://api.github.com/users/dominicmeyer/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/dominicmeyer",
        "id": 103406971,
        "login": "dominicmeyer",
        "node_id": "U_kgDOBindew",
        "organizations_url": "https://api.github.com/users/dominicmeyer/orgs",
        "received_events_url": "https://api.github.com/users/dominicmeyer/received_events",
        "repos_url": "https://api.github.com/users/dominicmeyer/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/dominicmeyer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dominicmeyer/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/dominicmeyer"
    }
}