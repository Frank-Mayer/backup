{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nWhen opening a Zig file containing multi-line strings that start with a backslash followed by non-ASCII characters(e.g., `\\\\µ`), Neovim encounters an error related to semantic tokens. This issue appears to be related to the implementation of `util._str_byteindex_enc` in `runtime/lua/vim/lsp/util.lua`.\n\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\n\n1. Ensure Neovim is set up with a Zig LSP (e.g., zls).\n2. Create a new Zig file with the following content:\n\n```zig\npub fn main() !void {\n    const std = @import(\"std\");\n    const a =\n        \\\\µs\n        \\\\\n    ;\n    std.debug.print(\"{s}\", .{a});\n}\n```\n\n3. Open the file in Neovim.\n\n\n### Expected behavior\n\nThe Zig code should be parsed correctly, and no error should occur when strings contain `\\\\` followed by non-ASCII characters. The LSP semantic tokens should be handled properly, without causing an \"index out of range\" error.\n\n### Nvim version (nvim -v)\n\nNVIM v0.10.2\n\n### Language server name/version\n\nzls 0.13.0\n\n### Operating system/version\n\nUbuntu 16.04.6 LTS\n\n### Log file\n\n_No response_",
    "closed_at": "2024-10-16T16:12:21Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Can you please share the concrete (full!) error?",
            "created_at": "2024-10-16T10:30:31Z",
            "html_url": "https://github.com/neovim/neovim/issues/30832#issuecomment-2416404325",
            "id": 2416404325,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30832",
            "node_id": "IC_kwDOAPphoM6QB2dl",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416404325/reactions"
            },
            "updated_at": "2024-10-16T10:30:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416404325",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> This issue appears to be related to the implementation of `util._str_byteindex_enc` in `runtime/lua/vim/lsp/util.lua`.\n\n@tris203 is there a PR that @hmgle can try which might fix this?",
            "created_at": "2024-10-16T10:58:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/30832#issuecomment-2416466283",
            "id": 2416466283,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30832",
            "node_id": "IC_kwDOAPphoM6QCFlr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416466283/reactions"
            },
            "updated_at": "2024-10-16T10:58:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416466283",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> > This issue appears to be related to the implementation of `util._str_byteindex_enc` in `runtime/lua/vim/lsp/util.lua`.\n> \n> @tris203 is there a PR that @hmgle can try which might fix this?\n\nYes #30747\n",
            "created_at": "2024-10-16T11:03:29Z",
            "html_url": "https://github.com/neovim/neovim/issues/30832#issuecomment-2416477707",
            "id": 2416477707,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30832",
            "node_id": "IC_kwDOAPphoM6QCIYL",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416477707/reactions"
            },
            "updated_at": "2024-10-16T11:03:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416477707",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18444302?v=4",
                "events_url": "https://api.github.com/users/tris203/events{/privacy}",
                "followers_url": "https://api.github.com/users/tris203/followers",
                "following_url": "https://api.github.com/users/tris203/following{/other_user}",
                "gists_url": "https://api.github.com/users/tris203/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tris203",
                "id": 18444302,
                "login": "tris203",
                "node_id": "MDQ6VXNlcjE4NDQ0MzAy",
                "organizations_url": "https://api.github.com/users/tris203/orgs",
                "received_events_url": "https://api.github.com/users/tris203/received_events",
                "repos_url": "https://api.github.com/users/tris203/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tris203/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tris203/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tris203",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> Can you please share the concrete (full!) error?\n\nOh, yes. The error message:\n```\nError executing vim.schedule lua callback: ...86_64/share/nvim/runtime/lua/vim/lsp/semantic_tokens.lua:304: ...86_64/share/nvim/runtime/lua/vim/lsp/semantic_tokens.lua:149: index\nout of range\nstack traceback:\n        [builtin#36]: at 0x010d175660\n        ...86_64/share/nvim/runtime/lua/vim/lsp/semantic_tokens.lua:304: in function 'handler'\n        ...m-macos-x86_64/share/nvim/runtime/lua/vim/lsp/client.lua:687: in function ''\n        vim/_editor.lua: in function <vim/_editor.lua:0>\nError executing vim.schedule lua callback: ...86_64/share/nvim/runtime/lua/vim/lsp/semantic_tokens.lua:304: ...86_64/share/nvim/runtime/lua/vim/lsp/semantic_tokens.lua:149: index\nout of range\nstack traceback:\n        [builtin#36]: at 0x010d175660\n        ...86_64/share/nvim/runtime/lua/vim/lsp/semantic_tokens.lua:304: in function 'handler'\n        ...m-macos-x86_64/share/nvim/runtime/lua/vim/lsp/client.lua:687: in function ''\n        vim/_editor.lua: in function <vim/_editor.lua:0>\nPress ENTER or type command to continue\n```",
            "created_at": "2024-10-16T11:34:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/30832#issuecomment-2416548790",
            "id": 2416548790,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30832",
            "node_id": "IC_kwDOAPphoM6QCZu2",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416548790/reactions"
            },
            "updated_at": "2024-10-16T11:34:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416548790",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1779916?v=4",
                "events_url": "https://api.github.com/users/hmgle/events{/privacy}",
                "followers_url": "https://api.github.com/users/hmgle/followers",
                "following_url": "https://api.github.com/users/hmgle/following{/other_user}",
                "gists_url": "https://api.github.com/users/hmgle/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/hmgle",
                "id": 1779916,
                "login": "hmgle",
                "node_id": "MDQ6VXNlcjE3Nzk5MTY=",
                "organizations_url": "https://api.github.com/users/hmgle/orgs",
                "received_events_url": "https://api.github.com/users/hmgle/received_events",
                "repos_url": "https://api.github.com/users/hmgle/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/hmgle/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/hmgle/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/hmgle",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> > This issue appears to be related to the implementation of `util._str_byteindex_enc` in `runtime/lua/vim/lsp/util.lua`.\n> \n> [@tris203](https://github.com/tris203) is there a PR that [@hmgle](https://github.com/hmgle) can try which might fix this?\n\nThank you for your response! It worked perfectly.",
            "created_at": "2024-10-16T11:41:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/30832#issuecomment-2416565087",
            "id": 2416565087,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30832",
            "node_id": "IC_kwDOAPphoM6QCdtf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416565087/reactions"
            },
            "updated_at": "2024-10-16T11:41:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416565087",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1779916?v=4",
                "events_url": "https://api.github.com/users/hmgle/events{/privacy}",
                "followers_url": "https://api.github.com/users/hmgle/followers",
                "following_url": "https://api.github.com/users/hmgle/following{/other_user}",
                "gists_url": "https://api.github.com/users/hmgle/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/hmgle",
                "id": 1779916,
                "login": "hmgle",
                "node_id": "MDQ6VXNlcjE3Nzk5MTY=",
                "organizations_url": "https://api.github.com/users/hmgle/orgs",
                "received_events_url": "https://api.github.com/users/hmgle/received_events",
                "repos_url": "https://api.github.com/users/hmgle/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/hmgle/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/hmgle/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/hmgle",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/30832/comments",
    "created_at": "2024-10-16T10:16:05Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/30832/events",
    "html_url": "https://github.com/neovim/neovim/issues/30832",
    "id": 2591378905,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/30832/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6adU3Z",
    "number": 30832,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/30832/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/30832/timeline",
    "title": "LSP: Error with LSP Semantic Tokens when Zig code contains non-ASCII characters preceded by \"\\\\\"",
    "updated_at": "2024-10-16T16:12:21Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/30832",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1779916?v=4",
        "events_url": "https://api.github.com/users/hmgle/events{/privacy}",
        "followers_url": "https://api.github.com/users/hmgle/followers",
        "following_url": "https://api.github.com/users/hmgle/following{/other_user}",
        "gists_url": "https://api.github.com/users/hmgle/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/hmgle",
        "id": 1779916,
        "login": "hmgle",
        "node_id": "MDQ6VXNlcjE3Nzk5MTY=",
        "organizations_url": "https://api.github.com/users/hmgle/orgs",
        "received_events_url": "https://api.github.com/users/hmgle/received_events",
        "repos_url": "https://api.github.com/users/hmgle/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/hmgle/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hmgle/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/hmgle",
        "user_view_type": "public"
    }
}