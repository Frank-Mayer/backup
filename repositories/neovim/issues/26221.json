{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nUsing wezterm on Windows with `config.term = \"wezterm\"` results in the cursor not correctly switching between block and line in modes, among other typical terminal misconfigurations.\r\n\r\nUpdating `TERM` to contain `xterm-256color` partially fixes the problem.\r\n\r\nLooking in the terminal docs, they describe being able to use a terminfo file to extend Neovims understanding of terminal capabilities, however files under ~/.terminfo are apparently not loaded. I looked in https://github.com/mauke/unibilium/blob/master/uniutil.c#L174 and attempted to set `TERMINFO` and `HOME` to appropriate values, but had no success.\r\n\r\nIt is unclear how to solve this problem cleanly, it appears the docs do not cover Windows build behaviors.\n\n### Steps to reproduce\n\nwinget install wez.wezterm\r\n\r\nIn ~/.wezterm.lua:\r\n```\r\nlocal wezterm = require(\"wezterm\")\r\nlocal config = {}\r\nconfig = wezterm.config_builder()\r\nconfig.term = \"wezterm\"\r\n```\r\n\r\nStart nvim. Enter insert mode, observe cursor does not change modes.\r\n\r\nOpen `help term`, observe references to removed legacy feature `ttybuiltin`.\r\n\r\nOpen `help startup-terminal`, observe that while there is a description that a terminfo database will be used if available, and Unibilium is the library in use, attempts to install a terminfo database along with setting `HOME`, `TERMINFO` or `TERMINFO_DIRS` fail to load a terminfo to address the problem. There is no further description of the apparent difference in configuration on Windows, nor any way to add to or influence or even use members of the builtin mapping.\n\n### Expected behavior\n\n- A mapping of TERM=wezterm to xterm-256color until there is builtin terminfo for this terminal\r\n- Documentation as to how terminfo can be configured on Windows\r\n- Neovim on Windows running under Wezterm has functional title sets, cursor changes, and so on.\n\n### Neovim version (nvim -v)\n\nNVIM v0.9.4\n\n### Vim (not Nvim) behaves the same?\n\nunknown\n\n### Operating system/version\n\nWindows 11\n\n### Terminal name/version\n\nwezterm 20230712-072601-f4abf8fd\n\n### $TERM environment variable\n\nwezterm\n\n### Installation\n\nrepo",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "I don't know why `$TERMINFO` or `$TERMINFO_DIRS` _wouldn't_ work on Windows. Where does Windows keep the system terminfo database? Can you share the output of `infocmp xterm-256color`?",
            "created_at": "2023-11-29T21:08:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/26221#issuecomment-1832703337",
            "id": 1832703337,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26221",
            "node_id": "IC_kwDOAPphoM5tPNVp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1832703337/reactions"
            },
            "updated_at": "2023-11-29T21:09:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1832703337",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "IIRC Nvim uses builtin terminfo on Windows because there is no terminfo database.",
            "created_at": "2023-11-29T22:02:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/26221#issuecomment-1832771141",
            "id": 1832771141,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26221",
            "node_id": "IC_kwDOAPphoM5tPd5F",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1832771141/reactions"
            },
            "updated_at": "2023-11-29T22:02:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1832771141",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> IIRC Nvim uses builtin terminfo on Windows because there is no terminfo database.\r\n\r\nMakes sense:\r\n\r\n```\r\n  // Set up unibilium/terminfo.\r\n  if (term) {\r\n    tui->ut = unibi_from_term(term);\r\n    if (tui->ut) {\r\n      if (!tui->term) {\r\n        tui->term = xstrdup(term);\r\n      }\r\n    }\r\n  }\r\n  if (!tui->ut) {\r\n    tui->ut = terminfo_from_builtin(term, &tui->term);\r\n  }\r\n```\r\n\r\nBut `unibi_from_term` checks `$TERMINFO`, `$TERMINFO_DIRS`, and for `$HOME/.terminfo`. So if those are set they should be checked, even on Windows.\r\n\r\nEDIT: Unless this is a path separator thing. Unibilium hardcodes forward slashes: https://github.com/neovim/unibilium/blob/ab28a2ddb86a144194a798bcf1fef1ab4f981ab7/uniutil.c#L126-L133",
            "created_at": "2023-11-29T22:22:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/26221#issuecomment-1832794916",
            "id": 1832794916,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26221",
            "node_id": "IC_kwDOAPphoM5tPjsk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1832794916/reactions"
            },
            "updated_at": "2023-11-29T22:24:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1832794916",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/26221/comments",
    "created_at": "2023-11-26T02:10:22Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/26221/events",
    "html_url": "https://github.com/neovim/neovim/issues/26221",
    "id": 2010861393,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "d4c5f9",
            "default": false,
            "description": null,
            "id": 109461219,
            "name": "platform:windows",
            "node_id": "MDU6TGFiZWwxMDk0NjEyMTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/platform:windows"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "user system environment (terminal, shell, tmux)",
            "id": 147354524,
            "name": "environment",
            "node_id": "MDU6TGFiZWwxNDczNTQ1MjQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/environment"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        },
        {
            "color": "BFDADC",
            "default": false,
            "description": "Low-risk. Do NOT ask \"can I work on this\", just read CONTRIBUTING.md",
            "id": 407246773,
            "name": "complexity:low",
            "node_id": "MDU6TGFiZWw0MDcyNDY3NzM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/complexity:low"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/26221/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 590,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Low priority. Not planned for the current target, may be reassigned.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 424,
        "state": "open",
        "title": "backlog",
        "updated_at": "2023-11-30T01:41:47Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM53209R",
    "number": 26221,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/26221/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/26221/timeline",
    "title": "Missing terminfo documentation or non-functional terminfo loads for Windows builds",
    "updated_at": "2023-11-29T22:24:12Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/26221",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/348?v=4",
        "events_url": "https://api.github.com/users/raggi/events{/privacy}",
        "followers_url": "https://api.github.com/users/raggi/followers",
        "following_url": "https://api.github.com/users/raggi/following{/other_user}",
        "gists_url": "https://api.github.com/users/raggi/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/raggi",
        "id": 348,
        "login": "raggi",
        "node_id": "MDQ6VXNlcjM0OA==",
        "organizations_url": "https://api.github.com/users/raggi/orgs",
        "received_events_url": "https://api.github.com/users/raggi/received_events",
        "repos_url": "https://api.github.com/users/raggi/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/raggi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/raggi/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/raggi"
    }
}