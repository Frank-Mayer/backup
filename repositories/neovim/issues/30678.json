{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "This is a *tracking issue*, not a manifesto. Corrections welcome unless they are nit-picks.\r\n\r\n# Problem\r\n\r\nThe C core of nvim has been armored by a lot of static analysis and compiler flags, which has greatly improved quality. But C still has these problems:\r\n\r\n- crashes from invalid pointers, arrays not bounds-checked\r\n- nul-terminated strings are awkward and have a perf cost\n- memory management takes effort and asan doesn't detect all the leaks\n- lack of modern language abstractions (e.g. generics) makes particular parts of the code over complicated and specialized (e.g. marktree, Lua/vimscript bridge).\r\n\r\n# Goal\r\n\r\nThe strategy of Nvim has always been to lift logic out of C and into Lua where possible. And that still looks like a productive path. But if there is a \"better C\" which allows us to completely *freeze* the remaining C bits and shift to the \"better C\", at near-zero cost, then we should consider that.\r\n\r\nC gives us the following benefits:\r\n\r\n- broad cross-platform support\r\n- fast builds\r\n- leverage existing C codebase\r\n\r\n# Proposal\r\n\r\nThis issue evaluates whether we can maintain the above benefits, while gaining new ones, by leveraging:\r\n\r\n## rust\r\n\r\n- pros\n    - tooling\r\n    - rich type system\r\n    - borrow checker gives strong guarantees\n    - language level macros\n    - large collection of libraries \n- cons\r\n    - slow build times\r\n    - interop with C libraries has nonzero friction\r\n    - mediocre cross-compiling support\r\n\r\n## zig\r\n\r\n- pros\r\n    - comptime\n      - replaces the Lua generator scripts that create C code (e.g. `gen_api_dispatch.lua`).\r\n    - zero-friction interop with legacy C code/libraries\r\n    - can easily cross-compile to mac/linux/win, from a single CI job\r\n    - can replace CMake: https://github.com/neovim/neovim/pull/28344/\r\n- cons\r\n    - still in beta\r\n    - tooling not as good as C or Rust (e.g. LSP)\n\r\n## c++\r\n\r\n- cons\r\n    - conflicts with Lua's garbage collector, because it is garbage\n\r\n\r\n\r\n---\r\n\r\nprevious: https://github.com/neovim/neovim/issues/8669\r\n",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "In terms of evaluating the languages, here are my thoughts:\n\nC++ is the most 'obvious' choice, but it strikes me as just trading one flavour of brittle for another, and seeing as the issue doesn't list any pros nor elaborates on the con(s), I assume there's not much desire present to discuss it as a serious option, so I will mainly focus on Zig and Rust.\n\nI don't have very deep knowledge of Zig as a language, but purely in terms of tooling, moving parts of C to Zig would be significantly easier/faster especially early on, due to its first-class C integration. However, due to the language being in beta, and there being no indication of a stable release in the foreseeable future (the 1.0.0 GitHub milestone sits at 0% complete, with hundreds of issues assigned to it) and due to the fact that the language addresses the issues outlined with at least some caveats (e.g. memory management is still largely manual, strings still need to be utf-8 validated, Zig generics work *very* differently from most modern languages), it's difficult to say whether things would remain smooth sailing into the long term.\n\nI do have a lot of experience with Rust, and while I do think that adopting Rust's tooling and build system into Neovim's codebase would undoubtedly come with a significant upfront cost, in terms of bridging to C code, I think Rust would be very well equipped to handle Neovim's dependencies like Lua(jit), UTF-8 handling, libuv, etc, which could open the door to large, favorable refactors across the codebase, especially as Neovim's \"style\" (for lack of a better word) of C is already decently modernized, meaning the \"friction\" mentioned would be mitigated somewhat.\n\nAs a contributor, I am eager to put my money where my mouth is. While my contributions to Neovim have been relatively small thus far, primarily on the Lua side, since I don't have the time to fully immersive myself in Neovim's C codebase, adding a high level language (particularly Rust in my case, but Zig potentially also) would mean I could dedicate significantly more time and energy to the project, something that I would be very happy (even actively excited) to do.",
            "created_at": "2024-10-08T09:33:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/30678#issuecomment-2399347385",
            "id": 2399347385,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30678",
            "node_id": "IC_kwDOAPphoM6PAyK5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 10,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 10,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399347385/reactions"
            },
            "updated_at": "2024-10-08T09:33:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399347385",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38919842?v=4",
                "events_url": "https://api.github.com/users/LunarLambda/events{/privacy}",
                "followers_url": "https://api.github.com/users/LunarLambda/followers",
                "following_url": "https://api.github.com/users/LunarLambda/following{/other_user}",
                "gists_url": "https://api.github.com/users/LunarLambda/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/LunarLambda",
                "id": 38919842,
                "login": "LunarLambda",
                "node_id": "MDQ6VXNlcjM4OTE5ODQy",
                "organizations_url": "https://api.github.com/users/LunarLambda/orgs",
                "received_events_url": "https://api.github.com/users/LunarLambda/received_events",
                "repos_url": "https://api.github.com/users/LunarLambda/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/LunarLambda/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/LunarLambda/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/LunarLambda"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "While the approach of using another language is very attractive in terms of code safety and maintainability, I am concerned about the decreased compatibility with Vim and the difficulty of porting features.",
            "created_at": "2024-10-08T09:47:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/30678#issuecomment-2399377593",
            "id": 2399377593,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30678",
            "node_id": "IC_kwDOAPphoM6PA5i5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399377593/reactions"
            },
            "updated_at": "2024-10-08T09:47:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399377593",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41495?v=4",
                "events_url": "https://api.github.com/users/Shougo/events{/privacy}",
                "followers_url": "https://api.github.com/users/Shougo/followers",
                "following_url": "https://api.github.com/users/Shougo/following{/other_user}",
                "gists_url": "https://api.github.com/users/Shougo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Shougo",
                "id": 41495,
                "login": "Shougo",
                "node_id": "MDQ6VXNlcjQxNDk1",
                "organizations_url": "https://api.github.com/users/Shougo/orgs",
                "received_events_url": "https://api.github.com/users/Shougo/received_events",
                "repos_url": "https://api.github.com/users/Shougo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Shougo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Shougo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Shougo"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I am concerned about the decreased compatibility with Vim and the difficulty of porting features.\n\nThis is a non-goal. The point of Neovim was to be a fork of Vim, and thus the two projects will diverge over time.\n\nAlso there is no plan on rewriting the entirety of Neovim, only specific parts of the codebase that could benefit from a rewrite. Files like `drawline.c`, `drawscreen.c`, `eval.c` are not likely to be effected by this. However, things like: the marktree, Nvim API, options, diff, folding, treesitter, Lua, would all be candidates for a rewrite.",
            "created_at": "2024-10-08T09:53:52Z",
            "html_url": "https://github.com/neovim/neovim/issues/30678#issuecomment-2399394128",
            "id": 2399394128,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30678",
            "node_id": "IC_kwDOAPphoM6PA9lQ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 9,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 9,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399394128/reactions"
            },
            "updated_at": "2024-10-08T11:47:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399394128",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "In addition, the two most lowest-hanging fruits (in order) for a rewrite is going to be be:\n\n- **Build system**. Our present build system is written mostly in cmake, and contains little code from vim makefiles. \n- Meta code generators: these are lua scripts reading in some c code and spitting out more c code.\n\nIn both cases these involve replacing code in cmake and lua, i e places we have taken a mandatory dependency on languages that _vim_ does not depend on. Thus the ship of \"vim compatibility\" in regards of language choice has sailed a looong time ago. ",
            "created_at": "2024-10-08T12:07:15Z",
            "html_url": "https://github.com/neovim/neovim/issues/30678#issuecomment-2399663834",
            "id": 2399663834,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30678",
            "node_id": "IC_kwDOAPphoM6PB_ba",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 5,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 5,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399663834/reactions"
            },
            "updated_at": "2024-10-08T12:07:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2399663834",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This issue is not a discussion. Only trying to gather useful technical attributes to have a clear picture about our options. No more debates please.",
            "created_at": "2024-10-09T10:18:08Z",
            "html_url": "https://github.com/neovim/neovim/issues/30678#issuecomment-2401916183",
            "id": 2401916183,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30678",
            "node_id": "IC_kwDOAPphoM6PKlUX",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 6,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 6,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2401916183/reactions"
            },
            "updated_at": "2024-10-13T20:28:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2401916183",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/30678/comments",
    "created_at": "2024-10-05T17:34:32Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/30678/events",
    "html_url": "https://github.com/neovim/neovim/issues/30678",
    "id": 2568232469,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "",
            "id": 4457150369,
            "name": "architecture",
            "node_id": "LA_kwDOAPphoM8AAAABCaq3oQ",
            "url": "https://api.github.com/repos/neovim/neovim/labels/architecture"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/30678/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 246,
        "created_at": "2014-11-26T22:13:11Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "We don't plan to work on this, but will accept high quality contributions from someone who will own the feature and follow up on bug reports.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/9",
        "id": 881978,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/9/labels",
        "node_id": "MDk6TWlsZXN0b25lODgxOTc4",
        "number": 9,
        "open_issues": 267,
        "state": "open",
        "title": "needs-owner",
        "updated_at": "2024-10-14T19:27:30Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/9"
    },
    "node_id": "I_kwDOAPphoM6ZFB4V",
    "number": 30678,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 36,
        "-1": 0,
        "confused": 2,
        "eyes": 6,
        "heart": 0,
        "hooray": 4,
        "laugh": 18,
        "rocket": 2,
        "total_count": 68,
        "url": "https://api.github.com/repos/neovim/neovim/issues/30678/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/30678/timeline",
    "title": "alternative to C for Nvim core",
    "updated_at": "2024-10-13T20:28:45Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/30678",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk"
    }
}