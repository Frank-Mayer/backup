{
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
        "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
        "followers_url": "https://api.github.com/users/zeertzjq/followers",
        "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
        "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zeertzjq",
        "id": 35768171,
        "login": "zeertzjq",
        "node_id": "MDQ6VXNlcjM1NzY4MTcx",
        "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
        "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
        "repos_url": "https://api.github.com/users/zeertzjq/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zeertzjq"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
            "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
            "followers_url": "https://api.github.com/users/zeertzjq/followers",
            "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
            "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/zeertzjq",
            "id": 35768171,
            "login": "zeertzjq",
            "node_id": "MDQ6VXNlcjM1NzY4MTcx",
            "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
            "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
            "repos_url": "https://api.github.com/users/zeertzjq/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/zeertzjq"
        }
    ],
    "author_association": "MEMBER",
    "body": "### Problem\r\n\r\n(Assuming it is merged) [this](https://github.com/vim/vim/pull/12286) vim patch will not be applicable to Neovim. The problem in neovim is different:\r\n\r\n1. `nvim --clean +\"let &ch=&lines - 5\"`\r\n2. Right-click anywhere to open the builtin popup menu.\r\n3. The popup menu is drawn but (partially) hidden behind the command line area because the  z-index of the popup menu is smaller than that of the cmdline area which uses the message grid.\r\n\r\n### Expected behavior\r\n\r\nTo be determined I guess but from the discussion in the vim PR the current intended behavior is that the popup-menu is drawn in the cmdline area. We do that in neovim as well except the z-index of the popup window makes it so that it is hidden. Was that a deliberate decision @bfredl?\r\n\r\nWe could opt to fix it in Neovim with the originally proposed vim patch (that Bram did not go along with unfortunately). That would revert the grow direction as soon as the menu would go into the command-line area: https://github.com/vim/vim/commit/c88e3e3dae2bc961476fcdf5c95676957b4642bc.\r\n\r\nAlternatively, to follow the behavior of the currently proposed vim patch, I suppose the command line area should be on a different grid with lower z-index than popupmenu (when it does not contain multi-line messages?).",
    "closed_at": "2023-04-24T01:26:11Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Bram merged the patch to clear the command line. It is not useful for us so we will need a different solution",
            "created_at": "2023-04-23T15:41:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/23275#issuecomment-1519095803",
            "id": 1519095803,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23275",
            "node_id": "IC_kwDOAPphoM5ai4_7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1519095803/reactions"
            },
            "updated_at": "2023-04-23T15:41:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1519095803",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "We could port the patch like so:\r\n```diff\r\ndiff --git a/src/nvim/popupmenu.c b/src/nvim/popupmenu.c\r\nindex 334a9bc90..f3342fbc0 100644\r\n--- a/src/nvim/popupmenu.c\r\n+++ b/src/nvim/popupmenu.c\r\n@@ -868,6 +868,7 @@ void pum_undisplay(bool immediate)\r\n   if (immediate) {\r\n     pum_check_clear();\r\n   }\r\n+  if (pum_in_cmdline) {\r\n+    msg_grid.zindex = kZIndexMessages;\r\n+    pum_in_cmdline = false;\r\n+  }\r\n }\r\n\r\n void pum_check_clear(void)\r\n@@ -977,6 +978,9 @@ static void pum_position_at_mouse(int min_width)\r\n     if (pum_height > Rows - pum_row) {\r\n       pum_height = Rows - pum_row;\r\n     }\r\n+    if (pum_row + pum_height > cmdline_row) {\r\n+      pum_in_cmdline = true;\r\n+      msg_grid.zindex = kZIndexPopupMenu - 1;\r\n+    }\r\n   } else {\r\n     // Show above the mouse row, reduce height if it does not fit.\r\n     pum_above = true;\r\n```\r\n\r\nThis would temporarily decrease the zindex of the message grid when a popupmenu is drawn over it. Would that be an appropriate solution @bfredl?\r\n\r\nAlthough temporarily changing zindex seems weird, we either want popupmenu to be drawn over the commandline or we dont... If we want to follow vim I guess we should just make the zindex of popupmenus higher than the message grid...",
            "created_at": "2023-04-23T16:34:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/23275#issuecomment-1519105950",
            "id": 1519105950,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23275",
            "node_id": "IC_kwDOAPphoM5ai7ee",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1519105950/reactions"
            },
            "updated_at": "2023-04-23T16:40:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1519105950",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/23275/comments",
    "created_at": "2023-04-23T00:47:29Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/23275/events",
    "html_url": "https://github.com/neovim/neovim/issues/23275",
    "id": 1679799177,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 113026979,
            "name": "ui",
            "node_id": "MDU6TGFiZWwxMTMwMjY5Nzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/23275/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": "2023-06-02T08:01:57Z",
        "closed_issues": 62,
        "created_at": "2023-02-11T13:25:29Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
            "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
            "followers_url": "https://api.github.com/users/zeertzjq/followers",
            "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
            "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/zeertzjq",
            "id": 35768171,
            "login": "zeertzjq",
            "node_id": "MDQ6VXNlcjM1NzY4MTcx",
            "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
            "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
            "repos_url": "https://api.github.com/users/zeertzjq/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/zeertzjq"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/37",
        "id": 9032761,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/37/labels",
        "node_id": "MI_kwDOAPphoM4AidQ5",
        "number": 37,
        "open_issues": 0,
        "state": "closed",
        "title": "0.9.1",
        "updated_at": "2023-07-26T01:32:30Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/37"
    },
    "node_id": "I_kwDOAPphoM5kH7OJ",
    "number": 23275,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/23275/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/23275/timeline",
    "title": "Popup menus are hidden behind command-line area",
    "updated_at": "2023-07-26T01:27:45Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/23275",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
        "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
        "followers_url": "https://api.github.com/users/luukvbaal/followers",
        "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
        "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/luukvbaal",
        "id": 31730729,
        "login": "luukvbaal",
        "node_id": "MDQ6VXNlcjMxNzMwNzI5",
        "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
        "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
        "repos_url": "https://api.github.com/users/luukvbaal/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/luukvbaal"
    }
}