{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Problem\r\n\r\nMultibyte sign text leaks into buffer text.\r\nRegression from #25724.\r\n\r\n### Steps to reproduce\r\n\r\n```vim\r\n\" test.vim\r\ncall setline(1, ['aaaaa']->repeat(10))\r\nsign define piet1 text=êå¢êå¢ texthl=Search\r\nsign define piet2 text=†úé texthl=Search\r\nsign place 1 line=1 name=piet1 buffer=1\r\nsign place 2 line=2 name=piet2 buffer=1\r\nsign place 3 line=7 name=piet1 buffer=1\r\nsign place 4 line=8 name=piet2 buffer=1\r\nlet ns = nvim_create_namespace('')\r\ncall nvim_buf_set_extmark(0, ns, 3, 0, {'sign_text':'êå¢êå¢'})\r\ncall nvim_buf_set_extmark(0, ns, 4, 0, {'sign_text':'êå¢'})\r\n```\r\n1. Run `nvim --clean -S test.vim`\r\n2. Type <kbd>dddd</kbd>\r\n3. Observe the problem.\r\n\r\n~~For some reason the problem only occurs when deleting a line with a legacy sign.~~\r\nI first suspected the `get_sign_display()` refactor done in #25724 but I can't detect anything going wrong there. Maybe `init_sign_text()` or `decor_redraw_signs()`.\r\n\r\n### Expected behavior\r\n\r\nSign text doesn't leak into buffer text.",
    "closed_at": "2023-12-07T14:58:09Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "OK the difference in behavior comes from the `invalidate` extmark property.\r\nWith `call nvim_buf_set_extmark(0, ns, 3, 0, {'sign_text':'êå¢ÃÄÃÅÃÇÃÉÃÖÃÑêå¢ÃÄÃÅÃÇÃÉÃÖÃÑ', 'invalidate':1})` the problem also occurs when deleting a line with an extmark sign.",
            "created_at": "2023-12-06T15:53:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/26424#issuecomment-1843183067",
            "id": 1843183067,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26424",
            "node_id": "IC_kwDOAPphoM5t3L3b",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1843183067/reactions"
            },
            "updated_at": "2024-01-14T23:57:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1843183067",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Bruh I can no longer reproduce this. I've had this happen before when I was working on a branch that edited `buffer_defs.h`. Where I would no longer be able to reproduce an issue after `make distclean`. Indicating that somehow the `buffer_defs.h` edits would leak into adjacent memory in the buffer/window struct or something. Can it be that our CMake config is somehow not strict enough in rebuilding for edits to `buffer_defs.h`? Can anyone reproduce this issue?",
            "created_at": "2023-12-06T20:42:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/26424#issuecomment-1843658851",
            "id": 1843658851,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26424",
            "node_id": "IC_kwDOAPphoM5t5ABj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 3,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1843658851/reactions"
            },
            "updated_at": "2024-01-14T23:57:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1843658851",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Seeing this again. Also tested on 0.9.5 this time which shows the same issue. Turns out it might be a problem with my terminal (st build), can't reproduce on other terminals.",
            "created_at": "2024-01-14T23:51:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/26424#issuecomment-1891116073",
            "id": 1891116073,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26424",
            "node_id": "IC_kwDOAPphoM5wuCQp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1891116073/reactions"
            },
            "updated_at": "2024-01-15T01:02:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1891116073",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/26424/comments",
    "created_at": "2023-12-06T15:23:21Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/26424/events",
    "html_url": "https://github.com/neovim/neovim/issues/26424",
    "id": 2028799817,
    "labels": [
        {
            "color": "e6e6e6",
            "default": false,
            "description": "Issues that are closed as \"invalid\"",
            "id": 77997477,
            "name": "closed:invalid",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Nw==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/closed:invalid"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/26424/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 596,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Low priority. Not planned for the current target, may be reassigned.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 425,
        "state": "open",
        "title": "backlog",
        "updated_at": "2024-01-15T20:32:33Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM547QdJ",
    "number": 26424,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/26424/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/26424/timeline",
    "title": "corrupted display with multibyte signs",
    "updated_at": "2024-01-15T01:02:08Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/26424",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
        "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
        "followers_url": "https://api.github.com/users/luukvbaal/followers",
        "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
        "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/luukvbaal",
        "id": 31730729,
        "login": "luukvbaal",
        "node_id": "MDQ6VXNlcjMxNzMwNzI5",
        "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
        "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
        "repos_url": "https://api.github.com/users/luukvbaal/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/luukvbaal"
    }
}