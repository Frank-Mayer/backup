{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nI noticed that the indentation in Rust when starting a line with \"{\" is wrong when using the treesitter indentation, and while trying to fix that I wrote a query containing \"{}\", which immediately gave me an error. Trying a similar query in Lua I still get an error, and I assume this is a problem in the treesitter implementation, unless this is the expected behavior?\r\n\r\nThe trace looks like this:\r\n\r\n```console\r\nError executing lua callback: .../share/nvim/runtime/lua/vim/treesitter/_query_linter.lua:95: attempt to get length of a nil value\r\nstack traceback:\r\n\t.../share/nvim/runtime/lua/vim/treesitter/_query_linter.lua:95: in function 'fn'\r\n\t...EAD-28ffd96/share/nvim/runtime/lua/vim/func/_memoize.lua:54: in function 'parse'\r\n\t.../share/nvim/runtime/lua/vim/treesitter/_query_linter.lua:144: in function 'lint_match'\r\n\t.../share/nvim/runtime/lua/vim/treesitter/_query_linter.lua:182: in function 'fn'\r\n\t...6/share/nvim/runtime/lua/vim/treesitter/languagetree.lua:483: in function 'for_each_tree'\r\n\t.../share/nvim/runtime/lua/vim/treesitter/_query_linter.lua:174: in function 'lint'\r\n\t...-28ffd96/share/nvim/runtime/lua/vim/treesitter/query.lua:804: in function 'lint'\r\n\t...AD-28ffd96/share/nvim/runtime/lua/vim/treesitter/dev.lua:556: in function <...AD-28ffd96/share/nvim/runtime/lua/vim/treesitter/dev.lua:555>\r\n```\r\n\r\nI am not sure if this is the right place to report the error? So if I am wrong, can someone point me to the correct place?\n\n### Steps to reproduce\n\nOpen treesitter playground in a Rust file and type `(block \"{}\")` or in a Lua file with `(chunk \"{}\")` or some other valid command (even just `(\"{}\")` in any filetype seems to trigger the error). \n\n### Expected behavior\n\nI thought treesitter should be fine with a query containing the string \"{}”, so it should just treat it like any other query with a string. \n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0-dev-1236+g28ffd96c9-Homebrew\n\n### Vim (not Nvim) behaves the same?\n\nN/A\n\n### Operating system/version\n\nmacOS 14.0\n\n### Terminal name/version\n\nwezterm-nightly\n\n### $TERM environment variable\n\nwezterm\n\n### Installation\n\nHomebrew",
    "closed_at": "2023-10-09T01:28:09Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Why do you think this is a valid query?",
            "created_at": "2023-10-08T22:17:36Z",
            "html_url": "https://github.com/neovim/neovim/issues/25552#issuecomment-1752176371",
            "id": 1752176371,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25552",
            "node_id": "IC_kwDOAPphoM5ocBbz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752176371/reactions"
            },
            "updated_at": "2023-10-08T22:17:36Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752176371",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "also, please always share _exact_, literal, reproducing steps rather than a vague explanation.",
            "created_at": "2023-10-08T22:21:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/25552#issuecomment-1752177117",
            "id": 1752177117,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25552",
            "node_id": "IC_kwDOAPphoM5ocBnd",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752177117/reactions"
            },
            "updated_at": "2023-10-08T22:21:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752177117",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "> Why do you think this is a valid query?\r\n\r\nI guess I misunderstood treesitter a bit. I thought it could attempt to capture most normal strings (ignoring special symbols) and then give a warning if it noticed that what you were trying to do was impossible. But I have actually just checked this query in the official treesitter playground and it also doesn't work there (so I think it is impossible to match). \r\n\r\nI guess it would still be better if Neovim just responded that it is an invalid query (as it does for some other queries) instead of throwing an error, but the behavior is actually somewhat expected. \r\n\r\n> also, please always share _exact_, literal, reproducing steps rather than a vague explanation.\r\n\r\nFor the exact reproducing steps, would this have been fine?\r\n\r\n- Open neovim and open any lua file (e.g. your init.lua)\r\n- Press: `:InspectTree<CR>` (which opens and moves your cursor to the treesitter playground).\r\n- Press `o` to open the query editor.\r\n- Write `(\"{}\")` and press `<Esc>`. \r\n\r\nI will leave this open for now in case you want to change the behavior from an error to a warning. But otherwise, feel free to close this issue. (If I get no response I will probably also just close it after a few days.)",
            "created_at": "2023-10-08T23:12:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/25552#issuecomment-1752187925",
            "id": 1752187925,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25552",
            "node_id": "IC_kwDOAPphoM5ocEQV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752187925/reactions"
            },
            "updated_at": "2023-10-08T23:56:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752187925",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7075380?v=4",
                "events_url": "https://api.github.com/users/Danielkonge/events{/privacy}",
                "followers_url": "https://api.github.com/users/Danielkonge/followers",
                "following_url": "https://api.github.com/users/Danielkonge/following{/other_user}",
                "gists_url": "https://api.github.com/users/Danielkonge/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Danielkonge",
                "id": 7075380,
                "login": "Danielkonge",
                "node_id": "MDQ6VXNlcjcwNzUzODA=",
                "organizations_url": "https://api.github.com/users/Danielkonge/orgs",
                "received_events_url": "https://api.github.com/users/Danielkonge/received_events",
                "repos_url": "https://api.github.com/users/Danielkonge/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Danielkonge/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Danielkonge/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Danielkonge"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Errors are correct here. All strings that are used for pattern matchings needs to be the actual anonymous node's text, and not some random combination of braces. If a language parser allow an anonymous node to have the contents of `{}`, then you can use it for matching. If not, just skip and match opening and closing braces separately ",
            "created_at": "2023-10-09T01:05:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/25552#issuecomment-1752224622",
            "id": 1752224622,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25552",
            "node_id": "IC_kwDOAPphoM5ocNNu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752224622/reactions"
            },
            "updated_at": "2023-10-09T01:05:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752224622",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/29790821?v=4",
                "events_url": "https://api.github.com/users/lucario387/events{/privacy}",
                "followers_url": "https://api.github.com/users/lucario387/followers",
                "following_url": "https://api.github.com/users/lucario387/following{/other_user}",
                "gists_url": "https://api.github.com/users/lucario387/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lucario387",
                "id": 29790821,
                "login": "lucario387",
                "node_id": "MDQ6VXNlcjI5NzkwODIx",
                "organizations_url": "https://api.github.com/users/lucario387/orgs",
                "received_events_url": "https://api.github.com/users/lucario387/received_events",
                "repos_url": "https://api.github.com/users/lucario387/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lucario387/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lucario387/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lucario387"
            }
        },
        {
            "author_association": "NONE",
            "body": "Ok, if errors are expected I will just close this issue then. I just started looking at and generally playing around with treesitter recently, so I don't really know what would be the expected behavior. Thanks for the quick responses. ",
            "created_at": "2023-10-09T01:28:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/25552#issuecomment-1752235777",
            "id": 1752235777,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25552",
            "node_id": "IC_kwDOAPphoM5ocP8B",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752235777/reactions"
            },
            "updated_at": "2023-10-09T01:28:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1752235777",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7075380?v=4",
                "events_url": "https://api.github.com/users/Danielkonge/events{/privacy}",
                "followers_url": "https://api.github.com/users/Danielkonge/followers",
                "following_url": "https://api.github.com/users/Danielkonge/following{/other_user}",
                "gists_url": "https://api.github.com/users/Danielkonge/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Danielkonge",
                "id": 7075380,
                "login": "Danielkonge",
                "node_id": "MDQ6VXNlcjcwNzUzODA=",
                "organizations_url": "https://api.github.com/users/Danielkonge/orgs",
                "received_events_url": "https://api.github.com/users/Danielkonge/received_events",
                "repos_url": "https://api.github.com/users/Danielkonge/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Danielkonge/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Danielkonge/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Danielkonge"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25552/comments",
    "created_at": "2023-10-08T22:15:46Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25552/events",
    "html_url": "https://github.com/neovim/neovim/issues/25552",
    "id": 1932086584,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "We need minimal steps to reproduce the issue",
            "id": 298863445,
            "name": "needs:repro",
            "node_id": "MDU6TGFiZWwyOTg4NjM0NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:repro"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1799626557,
            "name": "treesitter",
            "node_id": "MDU6TGFiZWwxNzk5NjI2NTU3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/treesitter"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25552/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5zKU04",
    "number": 25552,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25552/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25552/timeline",
    "title": "\"{}\" in a treesitter query gives an error ",
    "updated_at": "2023-10-09T01:28:10Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25552",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/7075380?v=4",
        "events_url": "https://api.github.com/users/Danielkonge/events{/privacy}",
        "followers_url": "https://api.github.com/users/Danielkonge/followers",
        "following_url": "https://api.github.com/users/Danielkonge/following{/other_user}",
        "gists_url": "https://api.github.com/users/Danielkonge/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Danielkonge",
        "id": 7075380,
        "login": "Danielkonge",
        "node_id": "MDQ6VXNlcjcwNzUzODA=",
        "organizations_url": "https://api.github.com/users/Danielkonge/orgs",
        "received_events_url": "https://api.github.com/users/Danielkonge/received_events",
        "repos_url": "https://api.github.com/users/Danielkonge/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Danielkonge/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Danielkonge/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Danielkonge"
    }
}