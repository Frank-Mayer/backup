{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\n```lua\r\nlocal lines = vim.api.nvim_buf_get_lines(0, 0, -1, false)\r\nvim.api.nvim_buf_set_lines(0, 0, #lines, true, lines)\r\n```\r\n\r\nI believe the above code should do nothing to the buffer, but with the latest nightly, buffer is scrolled downwards resulting an inconsistent user experience.\r\n\r\nI was not able to bisect the exact commit causing this problem, but I'm pretty sure this was caused by the series of refactoring https://github.com/neovim/neovim/pull/24889 done by @bfredl .\r\n\r\nI found several similar issues, but they referred to the issue with some plugin or lsp.format, whereas my _steps to reproduce_ is reproducible without any setup (nvim -u NONE).\r\n\r\n### Steps to reproduce\r\n\r\n**No config file required.** (nvim -u NONE)\r\n\r\n1. Open a file that has more lines than nvim's window height.\r\n3. `G` to go to the bottom.\r\n4. `H` to move the cursor to the top of the window.\r\n5. Run the following code.\r\n\r\n```lua\r\nlocal lines = vim.api.nvim_buf_get_lines(0, 0, -1, false)\r\nvim.api.nvim_buf_set_lines(0, 0, #lines, true, lines)\r\n```\r\n\r\n### Result\r\n\r\nThe buffer and cursor moves down and lands one line above the bottom `scrolloff`. The exact same behavior as doing `zb` after `step 3.`.\r\n\r\n### Expected behavior\r\n\r\nDo not scroll the buffer, and have no visual change in above case.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.10.0-dev-2504+g3971797be1\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nN/A\r\n\r\n### Operating system/version\r\n\r\nLinux\r\n\r\n### Terminal name/version\r\n\r\nWezterm\r\n\r\n### $TERM environment variable\r\n\r\ntmux-256color\r\n\r\n### Installation\r\n\r\nBuild from source",
    "closed_at": "2024-03-14T11:24:34Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> I believe the above code should do nothing to the buffer, but with the latest nightly, buffer is scrolled downwards resulting an inconsistent user experience.\r\n\r\nIt is/was not, and it cannot be true in general that this code does nothing to the buffer. \r\n\r\nIt is a valid open question how it should scroll though. Just as with the other issue, a difference to 0.9.5 _by itself_ does not prove a bug, but it shows a case where it can be discussed if the previous or the current behavior is the one we want moving forward.",
            "created_at": "2024-03-04T14:16:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1976679980",
            "id": 1976679980,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM510b4s",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976679980/reactions"
            },
            "updated_at": "2024-03-04T14:16:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976679980",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "@bfredl Thank you for your response. I am glad to see that this issue has been caught on your radar.\r\n\r\nI understand that preserving the cursor position while rewriting the buffer content can be challenging. However, I believe it is important to maintain the previous behavior where the cursor position relative to the buffer and window remains the same.\r\n\r\nA common scenario is when reformatting a file, where the entire buffer is replaced with for example stylua's output.\r\n\r\nIt is quite frustrating to have the cursor constantly moving with each format, making the editing experience very unpleasant.\r\n\r\nI have also encountered this issue with UI plugins, such as [nui.nvim](https://github.com/MunifTanjim/nui.nvim/blob/main/lua/nui/tree/README.md), where the cursor jumps when the tree is redrawn inside the buffer, even when the content has not changed.",
            "created_at": "2024-03-04T14:26:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1976702022",
            "id": 1976702022,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM510hRG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976702022/reactions"
            },
            "updated_at": "2024-03-04T14:26:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976702022",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "NONE",
            "body": "> > I believe the above code should do nothing to the buffer, but with the latest nightly, buffer is scrolled downwards resulting an inconsistent user experience.\r\n> \r\n> It is/was not, and it cannot be true in general that this code does nothing to the buffer.\r\n> \r\n> It is a valid open question how it should scroll though. Just as with the other issue, a difference to 0.9.5 _by itself_ does not prove a bug, but it shows a case where it can be discussed if the previous or the current behavior is the one we want moving forward.\r\n\r\n@bfredl Could you please share with me what _other behavior_ you are thinking could be a viable option? I cannot think of any other acceptable outcome and I think what I described should be _the_ way `nvim_buf_set_lines` should behave.\r\nI consider this a bug when `nvim_buf_set_lines` moves the cursor position.",
            "created_at": "2024-03-04T14:42:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1976739233",
            "id": 1976739233,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM510qWh",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976739233/reactions"
            },
            "updated_at": "2024-03-04T14:42:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976739233",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Could you please share with me what other behavior you are thinking could be a viable option?\r\n\r\nThe current one, which matches the actual semantics of set_lines _replacing_  the entire range of lines with another range of lines. and then for neovim to provide some other mechanism for plugins to say that line numbers are at least \"almost\" preserved in this operation (i e it is fine to approximate old line numbers with new ones to keep the view almost the same in windows, current or not). \r\n\r\nThe key point here is to relay the _semantics_ of the operation, and `nvim_buf_set_lines` doesn't do that by itself. ",
            "created_at": "2024-03-04T14:51:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1976759033",
            "id": 1976759033,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM510vL5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976759033/reactions"
            },
            "updated_at": "2024-03-04T14:51:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976759033",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "@bfredl Please correct me if I'm misinterpreting but I'm not complaining about changes in line number. In fact, line number of cursor mostly stays same from before to after `nvim_buf_set_lines` which is awesome.\r\n\r\nMy issue is that the cursor position **relative to the window** changes after the operation.\r\n\r\nAs you can see in the record, I start from the 6th line inside the window, but after running `nvim_buf_set_lines`, the cursor position jumps to somewhere around the middle of the screen (and I think the position is undetermined?), where the expected behavior is to keep the cursor on the 6th line (inside the window) AND on line 73 (inside the file).\r\n\r\n\r\nhttps://github.com/neovim/neovim/assets/41065736/18349c0d-6690-4690-8e6f-c7a94b6093c8\r\n\r\n",
            "created_at": "2024-03-04T15:18:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1976823903",
            "id": 1976823903,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM510_Bf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976823903/reactions"
            },
            "updated_at": "2024-03-04T15:27:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1976823903",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "NONE",
            "body": "Does this make sense to you @bfredl ?",
            "created_at": "2024-03-05T20:39:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1979598772",
            "id": 1979598772,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM51_ke0",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1979598772/reactions"
            },
            "updated_at": "2024-03-05T20:39:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1979598772",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "yes, it is a bug that cursor position is not handled consistently like topline. I made the mistake of assuming that the title of the issue would describe the issue:)",
            "created_at": "2024-03-05T21:33:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1979672590",
            "id": 1979672590,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM51_2gO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1979672590/reactions"
            },
            "updated_at": "2024-03-05T21:33:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1979672590",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks for your reply @bfredl !\r\n\r\nEnglish is not my native language so forgive me about that :P \r\n\nWere you able to reproduce the issue?\n\r\nDo you have any rough estimate on when this can be fixed?",
            "created_at": "2024-03-07T07:42:40Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1982776615",
            "id": 1982776615,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM52LsUn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1982776615/reactions"
            },
            "updated_at": "2024-03-07T09:19:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1982776615",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "yes, it will be fixed before 0.10 .",
            "created_at": "2024-03-07T10:23:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1983200932",
            "id": 1983200932,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM52NT6k",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1983200932/reactions"
            },
            "updated_at": "2024-03-07T10:23:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1983200932",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "@bfredl Thanks. Hope it gets fixed as soon as possible.\r\n\r\nFYI, this issue might be caused by the same core problem.\r\n\r\n- https://github.com/neovim/neovim/issues/25370\r\n\r\n",
            "created_at": "2024-03-07T15:04:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1983701757",
            "id": 1983701757,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM52POL9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1983701757/reactions"
            },
            "updated_at": "2024-03-07T15:04:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1983701757",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Please try (very) latest master, just merged a fix.",
            "created_at": "2024-03-13T06:48:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1993679337",
            "id": 1993679337,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM521SHp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1993679337/reactions"
            },
            "updated_at": "2024-03-13T06:48:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1993679337",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "@bfredl Unfortunately, I don't think it is fixed. \r\n\r\nI've tried to detect the pattern of the behavior but I'm not really sure.\r\n(I'm sometimes using `<C-e>, <C-y>` or the mouse to scroll.)\r\n\r\nDo you want me to open a new issue, or may I ask some maintainer reopen this thread?\r\n\r\nhttps://github.com/neovim/neovim/assets/41065736/df26ee4b-4ad9-4dfb-8a13-66f4dff1057b\r\n\r\n",
            "created_at": "2024-03-13T13:03:21Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1994359757",
            "id": 1994359757,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM5234PN",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1994359757/reactions"
            },
            "updated_at": "2024-03-13T13:04:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1994359757",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "NONE",
            "body": "On top of that, I'm getting segfault crashes from commit `08fc1eb`. I cannot detect how or when the crash is happening, but it is happening everytime I open a second buffer.\r\n\r\nThis is not reproducible with `nvim -u NONE` but it gets fixed if I move back one commit prior so there should be a minor edge case in your code. I'll try to detect the problem, but at least reporting it now to let you know.\r\n\r\n![image](https://github.com/neovim/neovim/assets/41065736/69886397-85ab-499c-afa4-827ddd490cad)\r\n\r\nHere is the stack trace (I masked some info).\r\n[bt.txt](https://github.com/neovim/neovim/files/14590626/bt.txt)\r\n\r\nThe most suspecious part IMO is this part. Hope this info helps, and please guide me what I should do if you need more information. I'm not very familiar with C but I'm more than happy to help.\r\n\r\n```txt\r\nProgram terminated with signal SIGSEGV, Segmentation fault.\r\n#0  changed_window_setting (wp=0x0) at /home/------/.local/share/nvim-git/src/nvim/move.c:541\r\n541\t  wp->w_lines_valid = 0;\r\n```",
            "created_at": "2024-03-13T16:05:52Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1994805576",
            "id": 1994805576,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM525lFI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1994805576/reactions"
            },
            "updated_at": "2024-03-13T16:17:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1994805576",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Is that the full stacktrace you got by typing `bt`?",
            "created_at": "2024-03-13T22:04:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1995960221",
            "id": 1995960221,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM529--d",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1995960221/reactions"
            },
            "updated_at": "2024-03-13T22:04:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1995960221",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@pysan3 would you mind trying https://github.com/neovim/neovim/pull/27854 and see if behaves like you expect?",
            "created_at": "2024-03-14T09:57:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1997065541",
            "id": 1997065541,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM53CM1F",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 1,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997065541/reactions"
            },
            "updated_at": "2024-03-14T09:57:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997065541",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "@bfredl Amazing! Your branch `boogalo_lines` works as expected.\r\n\r\nHowever I'm still having a segfault issue with my own config as I reported above.\r\n\r\nHere is the full track trace. I managed to figure out how to get the full stack @zeertzjq :)\r\n\r\n[bt.txt](https://github.com/neovim/neovim/files/14600654/bt.txt)\r\n\r\nI'm still not able to reproduce this with `nvim -u NONE` but I think it happens when you have set a window option in a autocmd? I'm not really sure. I hope the stack trace gives you enough information.",
            "created_at": "2024-03-14T10:17:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1997101741",
            "id": 1997101741,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM53CVqt",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997101741/reactions"
            },
            "updated_at": "2024-03-14T10:17:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997101741",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Looking at the bt, it looks like you have some plugin calling `changed_window_setting` via the FFI, but it's assuming the old signature (without the `wp` argument, as it's NULLed out).\r\n\r\nLooking at your plugins, it's probably [nvim-ufo](https://github.com/kevinhwang91/nvim-ufo/blob/e29dbf5b2d76ea43f4e585e3deeb6510488eee3f/lua/ufo/wffi.lua#L84), which updated the signatures yesterday; you'll need to update it.",
            "created_at": "2024-03-14T10:42:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1997146403",
            "id": 1997146403,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM53Cgkj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997146403/reactions"
            },
            "updated_at": "2024-03-14T10:42:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997146403",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6256228?v=4",
                "events_url": "https://api.github.com/users/seandewar/events{/privacy}",
                "followers_url": "https://api.github.com/users/seandewar/followers",
                "following_url": "https://api.github.com/users/seandewar/following{/other_user}",
                "gists_url": "https://api.github.com/users/seandewar/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seandewar",
                "id": 6256228,
                "login": "seandewar",
                "node_id": "MDQ6VXNlcjYyNTYyMjg=",
                "organizations_url": "https://api.github.com/users/seandewar/orgs",
                "received_events_url": "https://api.github.com/users/seandewar/received_events",
                "repos_url": "https://api.github.com/users/seandewar/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seandewar/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seandewar/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seandewar"
            }
        },
        {
            "author_association": "NONE",
            "body": "@seandewar THANK YOU!! You saved my day!\r\n\r\nI can confirm that it was fixed by the latest commit in nvim-ufo (latest tag/release is too old tho).\r\n@bfredl @zeertzjq Thanks for digging in. It was a plugin related issue and it seems to be fixed now. I'm sorry it wasn't a direct neovim issue.",
            "created_at": "2024-03-14T10:46:21Z",
            "html_url": "https://github.com/neovim/neovim/issues/27720#issuecomment-1997153135",
            "id": 1997153135,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27720",
            "node_id": "IC_kwDOAPphoM53CiNv",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997153135/reactions"
            },
            "updated_at": "2024-03-14T10:50:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1997153135",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
                "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
                "followers_url": "https://api.github.com/users/pysan3/followers",
                "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
                "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/pysan3",
                "id": 41065736,
                "login": "pysan3",
                "node_id": "MDQ6VXNlcjQxMDY1NzM2",
                "organizations_url": "https://api.github.com/users/pysan3/orgs",
                "received_events_url": "https://api.github.com/users/pysan3/received_events",
                "repos_url": "https://api.github.com/users/pysan3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/pysan3"
            }
        }
    ],
    "comments": 18,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27720/comments",
    "created_at": "2024-03-03T18:15:15Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27720/events",
    "html_url": "https://github.com/neovim/neovim/issues/27720",
    "id": 2165478672,
    "labels": [
        {
            "color": "f9d0c4",
            "default": false,
            "description": "wrong behavior that was introduced in a previous commit (please bisect)",
            "id": 619474658,
            "name": "bug-regression",
            "node_id": "MDU6TGFiZWw2MTk0NzQ2NTg=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-regression"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27720/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 317,
        "created_at": "2023-02-02T14:11:43Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
            "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
            "followers_url": "https://api.github.com/users/bfredl/followers",
            "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
            "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bfredl",
            "id": 1363104,
            "login": "bfredl",
            "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
            "organizations_url": "https://api.github.com/users/bfredl/orgs",
            "received_events_url": "https://api.github.com/users/bfredl/received_events",
            "repos_url": "https://api.github.com/users/bfredl/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bfredl"
        },
        "description": "",
        "due_on": "2024-05-01T07:00:00Z",
        "html_url": "https://github.com/neovim/neovim/milestone/36",
        "id": 8997654,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/36/labels",
        "node_id": "MI_kwDOAPphoM4AiUsW",
        "number": 36,
        "open_issues": 115,
        "state": "open",
        "title": "0.10",
        "updated_at": "2024-03-19T00:59:38Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/36"
    },
    "node_id": "I_kwDOAPphoM6BEpUQ",
    "number": 27720,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27720/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27720/timeline",
    "title": "`nvim_buf_set_lines` adjustment of cursor and of topline is inconsistent",
    "updated_at": "2024-03-14T11:24:35Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27720",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/41065736?v=4",
        "events_url": "https://api.github.com/users/pysan3/events{/privacy}",
        "followers_url": "https://api.github.com/users/pysan3/followers",
        "following_url": "https://api.github.com/users/pysan3/following{/other_user}",
        "gists_url": "https://api.github.com/users/pysan3/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/pysan3",
        "id": 41065736,
        "login": "pysan3",
        "node_id": "MDQ6VXNlcjQxMDY1NzM2",
        "organizations_url": "https://api.github.com/users/pysan3/orgs",
        "received_events_url": "https://api.github.com/users/pysan3/received_events",
        "repos_url": "https://api.github.com/users/pysan3/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/pysan3/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/pysan3/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/pysan3"
    }
}