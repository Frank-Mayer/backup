{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nI have a big terminal (approx 100 rows x 500 cols), in which I run nvim with approx 10 windows. When I start shrinking the terminal, nvim gets smaller, smaller, ... until it eventually coredumps. It happens when the terminal is really small and all the windows can't be displayed.\r\n\r\nI don't do it on purpose, of course. But I work on a remote PC, and when I disconnect, the remote PC thinks that the display has become smaller, hence all the windows get resized, hence nvim get smaller .... very often, when I reconnect, my nvim session is gone.\r\n\r\nSample stack:\r\n```\r\n#0  0x00007f99e2f39387 in raise () from /lib64/libc.so.6\r\n#1  0x00007f99e2f3aa78 in abort () from /lib64/libc.so.6\r\n#2  0x00007f99e2f7bf67 in __libc_message () from /lib64/libc.so.6\r\n#3  0x00007f99e2f84329 in _int_free () from /lib64/libc.so.6\r\n#4  0x000000000058180d in write_cb.lto_priv ()\r\n#5  0x00000000008d8561 in uv.write_callbacks ()\r\n#6  0x00000000008d89b0 in uv.stream_io ()\r\n#7  0x00000000008cdeb5 in uv_run ()\r\n#8  0x00000000007d9dd0 in vgetorpeek.constprop ()\r\n#9  0x00000000005cea57 in char_avail ()\r\n#10 0x000000000050924b in showmode ()\r\n#11 0x000000000050d3a5 in update_screen ()\r\n#12 0x000000000050edb8 in screen_resize.part ()\r\n#13 0x000000000077b8a4 in ui_refresh ()\r\n#14 0x0000000000495fa8 in handle_nvim_ui_try_resize ()\r\n#15 0x000000000065ca29 in request_event ()\r\n#16 0x000000000057475d in multiqueue_oneshot_event.lto_priv ()\r\n#17 0x0000000000731591 in state_handle_k_event ()\r\n#18 0x00000000005170ed in insert_execute.lto_priv ()\r\n#19 0x0000000000737d0b in state_enter ()\r\n#20 0x00000000007d0ca9 in insert_enter.constprop ()\r\n#21 0x000000000050f28d in edit ()\r\n#22 0x00000000006659c4 in normal_execute.lto_priv ()\r\n#23 0x0000000000737d6d in state_enter ()\r\n#24 0x00000000006626fa in normal_enter ()\r\n#25 0x000000000045510d in main ()\r\n```\r\n\r\nAnd another:\r\n```\r\n#0  0x00007fbbfc01e387 in raise () from /lib64/libc.so.6\r\n#1  0x00007fbbfc01fa78 in abort () from /lib64/libc.so.6\r\n#2  0x00007fbbfc060f67 in __libc_message () from /lib64/libc.so.6\r\n#3  0x00007fbbfc067474 in malloc_printerr () from /lib64/libc.so.6\r\n#4  0x000000000058180d in write_cb.lto_priv ()\r\n#5  0x00000000008d8561 in uv.write_callbacks ()\r\n#6  0x00000000008d89b0 in uv.stream_io ()\r\n#7  0x00000000008cdeb5 in uv_run ()\r\n#8  0x00000000007d9dd0 in vgetorpeek.constprop ()\r\n#9  0x00000000005cea57 in char_avail ()\r\n#10 0x000000000050924b in showmode ()\r\n#11 0x000000000050d3a5 in update_screen ()\r\n#12 0x000000000050edb8 in screen_resize.part ()\r\n#13 0x000000000077b8a4 in ui_refresh ()\r\n#14 0x0000000000495fa8 in handle_nvim_ui_try_resize ()\r\n#15 0x000000000065ca29 in request_event ()\r\n#16 0x000000000057475d in multiqueue_oneshot_event.lto_priv ()\r\n#17 0x0000000000731591 in state_handle_k_event ()\r\n#18 0x00000000005170ed in insert_execute.lto_priv ()\r\n#19 0x0000000000737d0b in state_enter ()\r\n#20 0x00000000007d0ca9 in insert_enter.constprop ()\r\n#21 0x000000000050f28d in edit ()\r\n#22 0x00000000006659c4 in normal_execute.lto_priv ()\r\n#23 0x0000000000737d6d in state_enter ()\r\n#24 0x00000000006626fa in normal_enter ()\r\n#25 0x000000000045510d in main ()\r\n```\n\n### Steps to reproduce\n\n1. Make terminal window with many rows/cols\r\n2. Open nvim there\r\n3. In nvim, create many windows (10+)\r\n4. Start reducing the size of the terminal\n\n### Expected behavior\n\nNvim does not crash. And when it is resized back to normal size, all the windows are visible again\n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0-dev-1438+g8405649f9\n\n### Vim (not Nvim) behaves the same?\n\nnot sure\n\n### Operating system/version\n\nRHEL 7.9\n\n### Terminal name/version\n\nwezterm via ssh\n\n### $TERM environment variable\n\nwezterm\n\n### Installation\n\nbuild from repo",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "How is this different from #25837?",
            "created_at": "2023-11-01T10:53:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/25864#issuecomment-1788760485",
            "id": 1788760485,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25864",
            "node_id": "IC_kwDOAPphoM5qnlGl",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1788760485/reactions"
            },
            "updated_at": "2023-11-01T10:53:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1788760485",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "> How is this different from #25837?\r\n\r\nApart from call stack being completely different ... this one happens when nvim terminal is getting smaller and smaller, and happens consistently, at least in my case. You keep reducing the terminal size, and nvim eventually crashes. \r\n\r\nIn #25837, however, crash happens when the terminal size fluctuates. bigger -> smaller -> bigger -> smaller .... Does not crash every time but quite often, in my case.",
            "created_at": "2023-11-02T21:38:36Z",
            "html_url": "https://github.com/neovim/neovim/issues/25864#issuecomment-1791574105",
            "id": 1791574105,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25864",
            "node_id": "IC_kwDOAPphoM5qyUBZ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1791574105/reactions"
            },
            "updated_at": "2023-11-02T21:38:36Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1791574105",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8959819?v=4",
                "events_url": "https://api.github.com/users/j-xella/events{/privacy}",
                "followers_url": "https://api.github.com/users/j-xella/followers",
                "following_url": "https://api.github.com/users/j-xella/following{/other_user}",
                "gists_url": "https://api.github.com/users/j-xella/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/j-xella",
                "id": 8959819,
                "login": "j-xella",
                "node_id": "MDQ6VXNlcjg5NTk4MTk=",
                "organizations_url": "https://api.github.com/users/j-xella/orgs",
                "received_events_url": "https://api.github.com/users/j-xella/received_events",
                "repos_url": "https://api.github.com/users/j-xella/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/j-xella/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/j-xella/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/j-xella"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25864/comments",
    "created_at": "2023-11-01T10:50:14Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25864/events",
    "html_url": "https://github.com/neovim/neovim/issues/25864",
    "id": 1972134243,
    "labels": [
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains a stacktrace/ASAN log",
            "id": 435854079,
            "name": "has:backtrace",
            "node_id": "MDU6TGFiZWw0MzU4NTQwNzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:backtrace"
        },
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25864/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM51jGFj",
    "number": 25864,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25864/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25864/timeline",
    "title": "nvim crashes with many windows on a small terminal",
    "updated_at": "2023-11-02T21:38:36Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25864",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/8959819?v=4",
        "events_url": "https://api.github.com/users/j-xella/events{/privacy}",
        "followers_url": "https://api.github.com/users/j-xella/followers",
        "following_url": "https://api.github.com/users/j-xella/following{/other_user}",
        "gists_url": "https://api.github.com/users/j-xella/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/j-xella",
        "id": 8959819,
        "login": "j-xella",
        "node_id": "MDQ6VXNlcjg5NTk4MTk=",
        "organizations_url": "https://api.github.com/users/j-xella/orgs",
        "received_events_url": "https://api.github.com/users/j-xella/received_events",
        "repos_url": "https://api.github.com/users/j-xella/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/j-xella/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/j-xella/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/j-xella"
    }
}