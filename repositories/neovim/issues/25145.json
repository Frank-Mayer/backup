{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Problem\n\n_I apologize if this isn't the right way to report this kind of crashes. I haven't been able to pinpoint exactly what's causing these errors._\r\n\r\nAfter updating Neovim yesterday (which I did after https://github.com/neovim/neovim/commit/7a76fb8547548304450b59624f9c75a554396504), I've been having regular crashes where Neovim will just SIGABRT. It seems to happen when I'm saving a file that has errors.\n\n### Steps to reproduce\n\nI truly apologize for the lack of repro steps here. I do have the following crash report from the Mac console (all reports have a similar stack trace):\r\n\r\n```\r\n-------------------------------------\r\nTranslated Report (Full Report Below)\r\n-------------------------------------\r\n\r\nProcess:               nvim [4402]\r\nPath:                  /Users/USER/*/nvim\r\nIdentifier:            nvim\r\nVersion:               ???\r\nCode Type:             ARM-64 (Native)\r\nParent Process:        Exited process [4401]\r\nResponsible:           kitty [837]\r\nUser ID:               501\r\n\r\nDate/Time:             2023-09-13 09:42:17.5478 -0700\r\nOS Version:            macOS 13.5.2 (22G91)\r\nReport Version:        12\r\nAnonymous UUID:        F3614BE4-6673-C567-7F9D-312F48D5041B\r\n\r\nSleep/Wake UUID:       5583D443-D243-4484-A90B-EA50B88C908F\r\n\r\nTime Awake Since Boot: 1600 seconds\r\nTime Since Wake:       325 seconds\r\n\r\nSystem Integrity Protection: enabled\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_CRASH (SIGABRT)\r\nException Codes:       0x0000000000000000, 0x0000000000000000\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 6 Abort trap: 6\r\nTerminating Process:   nvim [4402]\r\n\r\nKernel Triage:\r\nVM - (arg = 0x0) pmap_enter retried due to resource shortage\r\n\r\n\r\nThread 0 Crashed::  Dispatch queue: com.apple.main-thread\r\n0   libsystem_kernel.dylib        \t       0x191924764 __pthread_kill + 8\r\n1   libsystem_pthread.dylib       \t       0x19195bc28 pthread_kill + 288\r\n2   libsystem_c.dylib             \t       0x191869ae8 abort + 180\r\n3   libsystem_c.dylib             \t       0x191868e44 __assert_rtn + 272\r\n4   nvim                          \t       0x102ea43b8 marktree_intersect_pair + 560\r\n5   nvim                          \t       0x102ea982c marktree_splice + 4180\r\n6   nvim                          \t       0x102e36860 extmark_splice_impl + 740\r\n7   nvim                          \t       0x102d55a20 del_lines + 560\r\n8   nvim                          \t       0x102efed40 op_delete + 2100\r\n9   nvim                          \t       0x102f089c0 do_pending_operator + 5060\r\n10  nvim                          \t       0x102eea0f8 normal_execute + 10096\r\n11  nvim                          \t       0x102fcb5cc state_enter + 160\r\n12  nvim                          \t       0x102cda054 main + 15176\r\n13  dyld                          \t       0x191603f28 start + 2236\r\n\r\nThread 1:\r\n0   libsystem_kernel.dylib        \t       0x19191bf54 mach_msg2_trap + 8\r\n1   libsystem_kernel.dylib        \t       0x19192e280 mach_msg2_internal + 80\r\n2   libsystem_kernel.dylib        \t       0x191924bb8 mach_msg_overwrite + 604\r\n3   libsystem_kernel.dylib        \t       0x19191c2d0 mach_msg + 24\r\n4   CoreFoundation                \t       0x191a3a7e4 __CFRunLoopServiceMachPort + 160\r\n5   CoreFoundation                \t       0x191a390c4 __CFRunLoopRun + 1208\r\n6   CoreFoundation                \t       0x191a384b8 CFRunLoopRunSpecific + 612\r\n7   CoreFoundation                \t       0x191abd57c CFRunLoopRun + 64\r\n8   nvim                          \t       0x102cd5580 uv__cf_loop_runner + 124 (fsevents.c:723)\r\n9   libsystem_pthread.dylib       \t       0x19195bfa8 _pthread_start + 148\r\n10  libsystem_pthread.dylib       \t       0x191956da0 thread_start + 8\r\n\r\nThread 2:\r\n0   libsystem_pthread.dylib       \t       0x191956d8c start_wqthread + 0\r\n\r\nThread 3:\r\n0   libsystem_kernel.dylib        \t       0x19191f750 __psynch_cvwait + 8\r\n1   libsystem_pthread.dylib       \t       0x19195c574 _pthread_cond_wait + 1232\r\n2   nvim                          \t       0x102cccd34 uv_cond_wait + 32 (thread.c:793)\r\n3   nvim                          \t       0x102ca96e4 worker + 272 (threadpool.c:76)\r\n4   libsystem_pthread.dylib       \t       0x19195bfa8 _pthread_start + 148\r\n5   libsystem_pthread.dylib       \t       0x191956da0 thread_start + 8\r\n\r\nThread 4:\r\n0   libsystem_kernel.dylib        \t       0x19191f750 __psynch_cvwait + 8\r\n1   libsystem_pthread.dylib       \t       0x19195c574 _pthread_cond_wait + 1232\r\n2   nvim                          \t       0x102cccd34 uv_cond_wait + 32 (thread.c:793)\r\n3   nvim                          \t       0x102ca96e4 worker + 272 (threadpool.c:76)\r\n4   libsystem_pthread.dylib       \t       0x19195bfa8 _pthread_start + 148\r\n5   libsystem_pthread.dylib       \t       0x191956da0 thread_start + 8\r\n\r\nThread 5:\r\n0   libsystem_kernel.dylib        \t       0x19191f750 __psynch_cvwait + 8\r\n1   libsystem_pthread.dylib       \t       0x19195c574 _pthread_cond_wait + 1232\r\n2   nvim                          \t       0x102cccd34 uv_cond_wait + 32 (thread.c:793)\r\n3   nvim                          \t       0x102ca96e4 worker + 272 (threadpool.c:76)\r\n4   libsystem_pthread.dylib       \t       0x19195bfa8 _pthread_start + 148\r\n5   libsystem_pthread.dylib       \t       0x191956da0 thread_start + 8\r\n\r\nThread 6:\r\n0   libsystem_kernel.dylib        \t       0x19191f750 __psynch_cvwait + 8\r\n1   libsystem_pthread.dylib       \t       0x19195c574 _pthread_cond_wait + 1232\r\n2   nvim                          \t       0x102cccd34 uv_cond_wait + 32 (thread.c:793)\r\n3   nvim                          \t       0x102ca96e4 worker + 272 (threadpool.c:76)\r\n4   libsystem_pthread.dylib       \t       0x19195bfa8 _pthread_start + 148\r\n5   libsystem_pthread.dylib       \t       0x191956da0 thread_start + 8\r\n\r\n\r\nThread 0 crashed with ARM Thread State (64-bit):\r\n    x0: 0x0000000000000000   x1: 0x0000000000000000   x2: 0x0000000000000000   x3: 0x0000000000000000\r\n    x4: 0x0000000000000000   x5: 0x000000000000002e   x6: 0x0000000000000001   x7: 0x0000000000000000\r\n    x8: 0x357be99a73fffccb   x9: 0x357be99b9f621c4b  x10: 0xcccccccccccccccd  x11: 0x000000000000000a\r\n   x12: 0x0000000000000000  x13: 0x0000000000000033  x14: 0x0000000000000003  x15: 0x0000000000000000\r\n   x16: 0x0000000000000148  x17: 0x00000001f15033a0  x18: 0x0000000000000000  x19: 0x0000000000000006\r\n   x20: 0x00000001ec9de080  x21: 0x0000000000000103  x22: 0x00000001ec9de160  x23: 0x00000001030c2885\r\n   x24: 0x00000001ea08a000  x25: 0x000000016d241520  x26: 0x000000011f7214a0  x27: 0x0000000000000000\r\n   x28: 0x0000000000000004   fp: 0x000000016d2410f0   lr: 0x000000019195bc28\r\n    sp: 0x000000016d2410d0   pc: 0x0000000191924764 cpsr: 0x40001000\r\n   far: 0x00000001036c0000  esr: 0x56000080  Address size fault\r\n\r\nBinary Images:\r\n       0x102bbc000 -        0x1030ebfff nvim (*) <41573c74-7648-3783-b6c9-ce2fffab39c2> /Users/USER/*/nvim\r\n       0x10330c000 -        0x103317fff libintl.8.dylib (*) <2b7b2fac-969c-3b08-82a1-a60bb7156b81> /opt/homebrew/*/libintl.8.dylib\r\n       0x103c18000 -        0x103c23fff lua.so (*) <edb68822-13a8-3a43-85b8-848edac9cb3a> /Users/USER/*/lua.so\r\n       0x104c60000 -        0x104d8ffff vim.so (*) <ccc30a21-e369-3bdb-bdf6-8670c8d543ac> /Users/USER/*/vim.so\r\n       0x19191b000 -        0x191954ff7 libsystem_kernel.dylib (*) <08c5fe2a-b0bf-3ab6-bb42-460c18917d33> /usr/lib/system/libsystem_kernel.dylib\r\n       0x191955000 -        0x191961fff libsystem_pthread.dylib (*) <1f30fb9a-bdf9-32db-a709-8417666a7e45> /usr/lib/system/libsystem_pthread.dylib\r\n       0x1917f3000 -        0x191871ff7 libsystem_c.dylib (*) <949943e2-52cb-3c95-ab08-7ed984333d03> /usr/lib/system/libsystem_c.dylib\r\n       0x1915fe000 -        0x19168c587 dyld (*) <e7a99595-e0f8-34af-be8b-9347d0d658a4> /usr/lib/dyld\r\n       0x1919bb000 -        0x191e94fff com.apple.CoreFoundation (6.9) <b3b2df49-2db8-370e-84ae-e0a2704515b8> /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation\r\n\r\nExternal Modification Summary:\r\n  Calls made by other processes targeting this process:\r\n    task_for_pid: 0\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n  Calls made by this process:\r\n    task_for_pid: 0\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n  Calls made by all processes on this machine:\r\n    task_for_pid: 0\r\n    thread_create: 0\r\n    thread_set_state: 0\r\n\r\nVM Region Summary:\r\nReadOnly portion of Libraries: Total=920.9M resident=0K(0%) swapped_out_or_unallocated=920.9M(100%)\r\nWritable regions: Total=1.9G written=0K(0%) resident=0K(0%) swapped_out=0K(0%) unallocated=1.9G(100%)\r\n\r\n                                VIRTUAL   REGION \r\nREGION TYPE                        SIZE    COUNT (non-coalesced) \r\n===========                     =======  ======= \r\nActivity Tracing                   256K        1 \r\nKernel Alloc Once                   32K        1 \r\nMALLOC                           298.2M       39 \r\nMALLOC guard page                   96K        4 \r\nMALLOC_MEDIUM (reserved)           1.2G       10         reserved VM address space (unallocated)\r\nMALLOC_NANO (reserved)           384.0M        1         reserved VM address space (unallocated)\r\nSTACK GUARD                       56.1M        7 \r\nStack                             48.7M        7 \r\nVM_ALLOCATE                       47.9M      384 \r\n__AUTH                             309K       58 \r\n__AUTH_CONST                      3713K      142 \r\n__DATA                            1691K      140 \r\n__DATA_CONST                      4226K      147 \r\n__DATA_DIRTY                       361K       58 \r\n__LINKEDIT                       803.8M        5 \r\n__OBJC_RO                         66.4M        1 \r\n__OBJC_RW                         2012K        1 \r\n__TEXT                           117.2M      154 \r\ndyld private memory                272K        2 \r\nshared memory                       32K        2 \r\n===========                     =======  ======= \r\nTOTAL                              3.0G     1164 \r\nTOTAL, minus reserved VM space     1.4G     1164 \r\n```\n\n### Expected behavior\n\nFor Neovim to not crash.\n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0-dev-1102+gdf1e91982\n\n### Vim (not Nvim) behaves the same?\n\nNo\n\n### Operating system/version\n\nMac Ventura 13.5.2\n\n### Terminal name/version\n\nkitty 0.28.1\n\n### $TERM environment variable\n\nxterm-kitty\n\n### Installation\n\nFrom source",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "@bfredl the stack trace and timing makes me think that maybe #13243 might be causing this?",
            "created_at": "2023-09-14T01:25:16Z",
            "html_url": "https://github.com/neovim/neovim/issues/25145#issuecomment-1718542611",
            "id": 1718542611,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25145",
            "node_id": "IC_kwDOAPphoM5mbuET",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1718542611/reactions"
            },
            "updated_at": "2023-09-14T01:25:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1718542611",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25145/comments",
    "created_at": "2023-09-14T01:23:34Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25145/events",
    "html_url": "https://github.com/neovim/neovim/issues/25145",
    "id": 1895490735,
    "labels": [
        {
            "color": "FBCA04",
            "default": false,
            "description": "We need minimal steps to reproduce the issue",
            "id": 298863445,
            "name": "needs:repro",
            "node_id": "MDU6TGFiZWwyOTg4NjM0NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:repro"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains a stacktrace/ASAN log",
            "id": 435854079,
            "name": "has:backtrace",
            "node_id": "MDU6TGFiZWw0MzU4NTQwNzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:backtrace"
        },
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "extmarks, decorations, virtual text, namespaces",
            "id": 1680119719,
            "name": "extmarks",
            "node_id": "MDU6TGFiZWwxNjgwMTE5NzE5",
            "url": "https://api.github.com/repos/neovim/neovim/labels/extmarks"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25145/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 129,
        "created_at": "2023-02-02T14:11:43Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
            "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
            "followers_url": "https://api.github.com/users/bfredl/followers",
            "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
            "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bfredl",
            "id": 1363104,
            "login": "bfredl",
            "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
            "organizations_url": "https://api.github.com/users/bfredl/orgs",
            "received_events_url": "https://api.github.com/users/bfredl/received_events",
            "repos_url": "https://api.github.com/users/bfredl/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bfredl"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/36",
        "id": 8997654,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/36/labels",
        "node_id": "MI_kwDOAPphoM4AiUsW",
        "number": 36,
        "open_issues": 140,
        "state": "open",
        "title": "0.10",
        "updated_at": "2023-09-14T01:36:49Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/36"
    },
    "node_id": "I_kwDOAPphoM5w-uSv",
    "number": 25145,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25145/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25145/timeline",
    "title": "SIGABRT in `marktree.c`",
    "updated_at": "2023-09-14T01:37:47Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25145",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
        "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
        "followers_url": "https://api.github.com/users/MariaSolOs/followers",
        "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
        "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/MariaSolOs",
        "id": 62502207,
        "login": "MariaSolOs",
        "node_id": "MDQ6VXNlcjYyNTAyMjA3",
        "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
        "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
        "repos_url": "https://api.github.com/users/MariaSolOs/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/MariaSolOs"
    }
}