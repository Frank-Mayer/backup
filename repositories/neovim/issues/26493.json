{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nI started with the one-shot OptionSet autocommand to notice (on init) if both `bg` abd `tgc` has been set (to select colorscheme looking good for these settings) and noticed that after returning `true` by attached callback that autocommand still exist, but only for the pattern not triggered the callback. To delete the autocommand we need to fire events matching to all patterns. \n\n### Steps to reproduce\n\ninit.lua: \r\n```lua\r\nvim.api.nvim_create_autocmd('User', {\r\n  pattern = 'Event1,Event2',\r\n  callback = function (data)\r\n    print(('%s has been fired.'):format(data.match))\r\n    return true\r\n  end,\r\n})\r\n\r\nfunction Trigger(event)\r\n  vim.api.nvim_exec_autocmds('User', {pattern = event})\r\n  vim.schedule(function ()\r\n    vim.print(vim.api.nvim_get_autocmds({event = 'User'}))\r\n  end)\r\nend\r\n\r\nTrigger('Event1')\r\n```\r\n```\r\nnvim --clean -u init.lua\r\n```\r\n- look into `:messages`\r\n- call `:lua Trigger('Event2')`\r\n- look into `:messages` again\r\n\r\nI see \r\n![image](https://github.com/neovim/neovim/assets/11404453/56150b6b-258c-4b1e-bee5-b8afab578356)\r\n\n\n### Expected behavior\n\nIf it's intended, please update documentation, otherwise it needs to be fixed (i.e. returning `true` should delete the whole autocommand). \n\n### Neovim version (nvim -v)\n\nv0.10.0-dev-1802+g29aa4dd10\n\n### Vim (not Nvim) behaves the same?\n\n-\n\n### Operating system/version\n\nDebian Sid\n\n### Terminal name/version\n\nkitty 0.31.0, tmux 3.3a-5\n\n### $TERM environment variable\n\ntmux-256color\n\n### Installation\n\nfrom repo",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "> (i.e. returning true should delete the whole autocommand)\r\n\r\nWell `autocmd-pattern` says that there are 2 separate autocmds created.\r\n```\r\nThe {aupat} argument of `:autocmd` can be a comma-separated list.  This works as\r\nif the command was given with each pattern separately.  Thus this command:\r\n\t:autocmd BufRead *.txt,*.info set et\r\nIs equivalent to:\r\n\t:autocmd BufRead *.txt set et\r\n\t:autocmd BufRead *.info set et\r\n```\r\nI wouldn't except 2 separate autocmds to lose their one-shot if only 1 lost it.",
            "created_at": "2023-12-09T14:58:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/26493#issuecomment-1848431886",
            "id": 1848431886,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26493",
            "node_id": "IC_kwDOAPphoM5uLNUO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848431886/reactions"
            },
            "updated_at": "2023-12-09T14:58:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848431886",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/130783534?v=4",
                "events_url": "https://api.github.com/users/Sam-programs/events{/privacy}",
                "followers_url": "https://api.github.com/users/Sam-programs/followers",
                "following_url": "https://api.github.com/users/Sam-programs/following{/other_user}",
                "gists_url": "https://api.github.com/users/Sam-programs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Sam-programs",
                "id": 130783534,
                "login": "Sam-programs",
                "node_id": "U_kgDOB8uZLg",
                "organizations_url": "https://api.github.com/users/Sam-programs/orgs",
                "received_events_url": "https://api.github.com/users/Sam-programs/received_events",
                "repos_url": "https://api.github.com/users/Sam-programs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Sam-programs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Sam-programs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Sam-programs"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "If we leave such autocommand untouched, then `=vim.print(vim.api.nvim_get_autocmds({event = 'User'}))` shows (indeed) two autocommands\r\n\r\n```lua\r\n{ {                                                                                                                                                                                                                                             \r\n    buflocal = false,                                                                                                                                                                                                                           \r\n    callback = <function 1>,                                                                                                                                                                                                                    \r\n    command = \"\",                                                                                                                                                                                                                               \r\n    event = \"User\",                                                                                                                                                                                                                             \r\n    id = 6,                                                                                                                                                                                                                                     \r\n    once = false,                                                                                                                                                                                                                               \r\n    pattern = \"Event1\"                                                                                                                                                                                                                          \r\n  }, {                                                                                                                                                                                                                                          \r\n    buflocal = false,                                                                                                                                                                                                                           \r\n    callback = <function 1>,                                                                                                                                                                                                                    \r\n    command = \"\",                                                                                                                                                                                                                               \r\n    event = \"User\",                                                                                                                                                                                                                             \r\n    id = 6,                                                                                                                                                                                                                                     \r\n    once = false,                                                                                                                                                                                                                               \r\n    pattern = \"Event2\"                                                                                                                                                                                                                          \r\n  } }                                                                                                                                                                                                                                           \r\n{ {                                                                                                                                                                                                                                             \r\n    buflocal = false,                                                                                                                                                                                                                           \r\n    callback = <function 1>,                                                                                                                                                                                                                    \r\n    command = \"\",                                                                                                                                                                                                                               \r\n    event = \"User\",                                                                                                                                                                                                                             \r\n    id = 6,                                                                                                                                                                                                                                     \r\n    once = false,                                                                                                                                                                                                                               \r\n    pattern = \"Event1\"                                                                                                                                                                                                                          \r\n  }, {                                                                                                                                                                                                                                          \r\n    buflocal = false,                                                                                                                                                                                                                           \r\n    callback = <function 1>,                                                                                                                                                                                                                    \r\n    command = \"\",                                                                                                                                                                                                                               \r\n    event = \"User\",                                                                                                                                                                                                                             \r\n    id = 6,                                                                                                                                                                                                                                     \r\n    once = false,                                                                                                                                                                                                                               \r\n    pattern = \"Event2\"                                                                                                                                                                                                                          \r\n  } } \r\n```\r\n although with the same `id` value. ",
            "created_at": "2023-12-09T15:12:43Z",
            "html_url": "https://github.com/neovim/neovim/issues/26493#issuecomment-1848436261",
            "id": 1848436261,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26493",
            "node_id": "IC_kwDOAPphoM5uLOYl",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848436261/reactions"
            },
            "updated_at": "2023-12-09T15:16:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848436261",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        },
        {
            "author_association": "NONE",
            "body": "You could use that with `nvim_del_autocmd`.\r\n`nvim_create_autocmd` returns it.\r\nI guess they weren't so separate after all.\r\n\r\ni think there should be more documentation on autocmd ids\r\n```\r\n    Return:  \r\n        Autocommand id (number)\r\n    NOTE: an autocmd id can refer to multiple autocmds (i.e. multi-pattern autocmds see |autocmd-pattern|)\r\n```\r\nDo you have a better idea of what to write?\r\n\r\nSorry with my earlier response i wasn't aware of the exists of autocmd ids.",
            "created_at": "2023-12-09T15:40:15Z",
            "html_url": "https://github.com/neovim/neovim/issues/26493#issuecomment-1848442922",
            "id": 1848442922,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26493",
            "node_id": "IC_kwDOAPphoM5uLQAq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848442922/reactions"
            },
            "updated_at": "2023-12-09T15:40:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848442922",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/130783534?v=4",
                "events_url": "https://api.github.com/users/Sam-programs/events{/privacy}",
                "followers_url": "https://api.github.com/users/Sam-programs/followers",
                "following_url": "https://api.github.com/users/Sam-programs/following{/other_user}",
                "gists_url": "https://api.github.com/users/Sam-programs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Sam-programs",
                "id": 130783534,
                "login": "Sam-programs",
                "node_id": "U_kgDOB8uZLg",
                "organizations_url": "https://api.github.com/users/Sam-programs/orgs",
                "received_events_url": "https://api.github.com/users/Sam-programs/received_events",
                "repos_url": "https://api.github.com/users/Sam-programs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Sam-programs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Sam-programs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Sam-programs"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I rather have no problem with workaround/resolve it on the user side but have doubt how it should work (including indexing) on the Lua API side and be described in `:help nvim_create_autocmd`. Let's wait for more maintainers to take a look at this issue.  ",
            "created_at": "2023-12-09T15:49:23Z",
            "html_url": "https://github.com/neovim/neovim/issues/26493#issuecomment-1848445062",
            "id": 1848445062,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26493",
            "node_id": "IC_kwDOAPphoM5uLQiG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848445062/reactions"
            },
            "updated_at": "2023-12-09T15:49:23Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1848445062",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/26493/comments",
    "created_at": "2023-12-09T14:11:29Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/26493/events",
    "html_url": "https://github.com/neovim/neovim/issues/26493",
    "id": 2033866676,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "libnvim, Nvim RPC API",
            "id": 103819671,
            "name": "api",
            "node_id": "MDU6TGFiZWwxMDM4MTk2NzE=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/api"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "events, autocommands",
            "id": 3341085842,
            "name": "events",
            "node_id": "MDU6TGFiZWwzMzQxMDg1ODQy",
            "url": "https://api.github.com/repos/neovim/neovim/labels/events"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/26493/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM55Ole0",
    "number": 26493,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/26493/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/26493/timeline",
    "title": "Cannot delete (at once) multi-pattern autocmd by a callback returning `true`",
    "updated_at": "2023-12-09T21:51:54Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/26493",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
        "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
        "followers_url": "https://api.github.com/users/przepompownia/followers",
        "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
        "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/przepompownia",
        "id": 11404453,
        "login": "przepompownia",
        "node_id": "MDQ6VXNlcjExNDA0NDUz",
        "organizations_url": "https://api.github.com/users/przepompownia/orgs",
        "received_events_url": "https://api.github.com/users/przepompownia/received_events",
        "repos_url": "https://api.github.com/users/przepompownia/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/przepompownia"
    }
}