{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\r\n\r\nCMD + SHIFT mappings behave differently from other mappings like ALT + SHIFT and are not normalized to a standard format. The reason seems to be this line, which I have found no explanation for https://github.com/neovim/neovim/blob/6e26964e0effdb4998fb98bc7f87430ce50cc672/src/nvim/keycodes.c#L774\r\n\r\nThis also makes mappings between different Neovim GUIs inconsistent, since each of them reports the mappings slightly differently to Neovim. \r\n\r\nNOTE: I'm aware that the CTRL mappings behaves differently due to legacy reasons, and it's also clear why the CTRL condition is there. But not why the condition is there for CMD.\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Steps to reproduce\r\n\r\n1. Create a file `mappings.vim` with the following contents\r\n```vim\r\nmap <D-a> <cmd>:echomsg \"D-a\"<cr>\r\nmap <D-A> <cmd>:echomsg \"D-A\"<cr>\r\nmap <D-S-a> <cmd>:echomsg \"D-S-a\"<cr>\r\nmap <D-S-A> <cmd>:echomsg \"D-S-A\"<cr>\r\n\r\nmap <M-a> <cmd>:echomsg \"M-a\"<cr>\r\nmap <M-A> <cmd>:echomsg \"M-A\"<cr>\r\nmap <M-S-a> <cmd>:echomsg \"M-S-a\"<cr>\r\nmap <M-S-A> <cmd>:echomsg \"M-S-A\"<cr>\r\n\r\nmap <C-a> <cmd>:echomsg \"C-a\"<cr>\r\nmap <C-A> <cmd>:echomsg \"C-A\"<cr>\r\nmap <C-S-a> <cmd>:echomsg \"C-S-a\"<cr>\r\nmap <C-S-A> <cmd>:echomsg \"C-S-A\"<cr>\r\n\r\ncall feedkeys(\"\\<D-a>\")\r\ncall feedkeys(\"\\<D-A>\")\r\ncall feedkeys(\"\\<D-S-a>\")\r\ncall feedkeys(\"\\<D-S-A>\")\r\n\r\ncall feedkeys(\"\\<M-a>\")\r\ncall feedkeys(\"\\<M-A>\")\r\ncall feedkeys(\"\\<M-S-a>\")\r\ncall feedkeys(\"\\<M-S-A>\")\r\n\r\ncall feedkeys(\"\\<C-a>\")\r\ncall feedkeys(\"\\<C-A>\")\r\ncall feedkeys(\"\\<C-S-a>\")\r\ncall feedkeys(\"\\<C-S-A>\")\r\n```\r\n2. Run `nvim --clean -u mappings.vim`\r\n3. Type `:messages`\r\n4. Observe that the following output was generated\r\n```\r\nD-a\r\nD-A\r\nD-S-a\r\nD-S-A\r\nM-a\r\nM-S-A\r\nM-S-A\r\nM-S-A\r\nC-A\r\nC-A\r\nC-S-A\r\nC-S-A\r\n```\r\n\r\n### Expected behavior\r\n\r\nThe output should be:\r\n```\r\nD-a\r\nD-S-A\r\nD-S-A\r\nD-S-A\r\nM-a\r\nM-S-A\r\nM-S-A\r\nM-S-A\r\nC-A\r\nC-A\r\nC-S-A\r\nC-S-A\r\n```\r\n\r\nMaking the `D` and `M` mappings consistent, and select the last shift combination that was mapped.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.9.2\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nN/A\r\n\r\n### Operating system/version\r\n\r\nArch Linux (WSL)\r\n\r\n### Terminal name/version\r\n\r\nWindows Terminal\r\n\r\n### $TERM environment variable\r\n\r\nxterm-256color\r\n\r\n### Installation\r\n\r\npacman",
    "closed_at": "2024-02-03T03:05:39Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "From private repo (certain modifier + function key keybinds do not work in neovim).\r\nMotivation: Mapping C-F11 in neovim (which does not work) from https://neovim.discourse.group/t/how-can-i-map-ctrl-shift-f5-ctrl-shift-b-ctrl-and-alt-enter/2133/2\r\n\r\nminimal `init.lua`:\r\n```lua\r\nlocal map = vim.api.nvim_set_keymap\r\n\r\nmap('n', '<sc-f5>', [[<cmd>lua print('ctrl+shift+f5')<cr>]], {noremap = true})-- does not work\r\nmap('n', '<c-f5>', [[<cmd>lua print('ctrl+f5')<cr>]], {noremap = true})-- does not work\r\nmap('n', '<s-f5>', [[<cmd>lua print('shift+f5')<cr>]], {noremap = true})-- does not work\r\nmap('n', '<a-f5>', [[<cmd>lua print('alt+f5')<cr>]], {noremap = true})-- does not work\r\nmap('n', '<cs-B>', [[<cmd>lua print('ctrl+shift+b')<cr>]], {noremap = true})-- works\r\nmap('n', '<c-+>', [[<cmd>lua print('ctrl+shift+=')<cr>]], {noremap = true}) -- Ctrl+Shift+= -- does not work\r\nmap('n', '<c-=>', [[<cmd>lua print('ctrl+=')<cr>]], {noremap = true}) -- Ctrl+= -- internally used to set default font size\r\nmap('n', '<c-.>', [[<cmd>lua print('ctrl+.')<cr>]], {noremap = true}) -- Ctrl+. -- works\r\nmap('n', '<a-cr>', [[<cmd>lua print('alt+enter')<cr>]], {noremap = true}) -- Alt+Enter -- works\r\n```\r\n\r\n`kitty +kitty show_key -m kitty` with aforementioned config shows:\r\n```\r\nshift+f5: CSI 15 ; 2 ~\r\nctrl+f5: CSI 15 ; 5 ~\r\nshift+ctrl+f5: CSI 15 ; 6 ~\r\nalt+f5: CSI 15 ; 3 ~\r\nctrl+shift+=: CSI 61 ; 6 u\r\n``` \r\nAfaiu, Neovim is explicitly requesting this Kitty keyboard mode, so these should be the correct sequences.\r\n\r\nUPDATE: No links to private repo.",
            "created_at": "2023-09-09T16:20:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/25068#issuecomment-1712547651",
            "id": 1712547651,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25068",
            "node_id": "IC_kwDOAPphoM5mE2dD",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1712547651/reactions"
            },
            "updated_at": "2023-09-09T20:59:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1712547651",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/13089667?v=4",
                "events_url": "https://api.github.com/users/matu3ba/events{/privacy}",
                "followers_url": "https://api.github.com/users/matu3ba/followers",
                "following_url": "https://api.github.com/users/matu3ba/following{/other_user}",
                "gists_url": "https://api.github.com/users/matu3ba/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matu3ba",
                "id": 13089667,
                "login": "matu3ba",
                "node_id": "MDQ6VXNlcjEzMDg5NjY3",
                "organizations_url": "https://api.github.com/users/matu3ba/orgs",
                "received_events_url": "https://api.github.com/users/matu3ba/received_events",
                "repos_url": "https://api.github.com/users/matu3ba/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matu3ba/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matu3ba/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matu3ba"
            }
        },
        {
            "author_association": "NONE",
            "body": "Above issue is from my terminal project ðŸ˜„ Happy to be educated I'm doing it wrong, but if I am, it appears Kitty is doing the wrong thing, too.\r\n\r\nNote that this isn't restricted to Kitty keyboard protocol, because Kitty uses the legacy xterm/fixterms encoding for functional keys (source: https://sw.kovidgoyal.net/kitty/keyboard-protocol/#legacy-functional-keys and https://www.leonerd.org.uk/hacks/fixterms/). In both, it is described that the above quoted encodings are correct.",
            "created_at": "2023-09-09T16:30:30Z",
            "html_url": "https://github.com/neovim/neovim/issues/25068#issuecomment-1712549626",
            "id": 1712549626,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25068",
            "node_id": "IC_kwDOAPphoM5mE276",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1712549626/reactions"
            },
            "updated_at": "2023-09-09T21:00:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1712549626",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1299?v=4",
                "events_url": "https://api.github.com/users/mitchellh/events{/privacy}",
                "followers_url": "https://api.github.com/users/mitchellh/followers",
                "following_url": "https://api.github.com/users/mitchellh/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitchellh/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mitchellh",
                "id": 1299,
                "login": "mitchellh",
                "node_id": "MDQ6VXNlcjEyOTk=",
                "organizations_url": "https://api.github.com/users/mitchellh/orgs",
                "received_events_url": "https://api.github.com/users/mitchellh/received_events",
                "repos_url": "https://api.github.com/users/mitchellh/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mitchellh/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitchellh/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mitchellh"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@matu3ba, @mitchellh. I think you should open a new issue about that, since this issue is specifically about how nvim deals with CMD + SHIFT mappings. \r\n\r\nYour issue is most likely a TUI one, since since all those combinations work in Neovide, so the Neovim core deals with them correctly.",
            "created_at": "2023-09-09T16:56:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/25068#issuecomment-1712554276",
            "id": 1712554276,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25068",
            "node_id": "IC_kwDOAPphoM5mE4Ek",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1712554276/reactions"
            },
            "updated_at": "2023-09-09T21:00:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1712554276",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25068/comments",
    "created_at": "2023-09-09T13:44:09Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25068/events",
    "html_url": "https://github.com/neovim/neovim/issues/25068",
    "id": 1888748984,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "BFDADC",
            "default": false,
            "description": "Low-risk. Do NOT ask \"can I work on this\", just read CONTRIBUTING.md",
            "id": 407246773,
            "name": "complexity:low",
            "node_id": "MDU6TGFiZWw0MDcyNDY3NzM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/complexity:low"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "key bindings",
            "id": 3304938718,
            "name": "mappings",
            "node_id": "MDU6TGFiZWwzMzA0OTM4NzE4",
            "url": "https://api.github.com/repos/neovim/neovim/labels/mappings"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25068/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5wlAW4",
    "number": 25068,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25068/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25068/timeline",
    "title": "CMD + SHIFT mappings are inconsistent",
    "updated_at": "2024-02-03T03:05:39Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25068",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
        "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
        "followers_url": "https://api.github.com/users/fredizzimo/followers",
        "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
        "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/fredizzimo",
        "id": 9946255,
        "login": "fredizzimo",
        "node_id": "MDQ6VXNlcjk5NDYyNTU=",
        "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
        "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
        "repos_url": "https://api.github.com/users/fredizzimo/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/fredizzimo"
    }
}