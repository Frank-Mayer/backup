{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\nTriggering omni completion after a `.` and then selecting an item from the pop-up menu inserts an extra `.`:\r\n![](https://user-images.githubusercontent.com/1154912/228121313-c362acc3-5a3a-4c10-a010-5d5e83c4567b.gif)\r\n\r\nI can only reproduce this with tsserver, so [I filed an issue over there](https://github.com/typescript-language-server/typescript-language-server/issues/711), but they pointed me back towards Neovim.\r\n\r\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\r\n\r\n<details><summary>minimal config</summary>\r\n\r\n```lua\r\nvim.opt.completeopt = { \"menuone\", \"noselect\" }\r\nvim.keymap.set(\"i\", \"<c-space>\", \"<c-x><c-o>\")\r\n\r\n--- CHANGE THESE\r\nlocal pattern = \"typescript\"\r\nlocal cmd = { \"typescript-language-server\", \"--stdio\" }\r\n-- Add files/folders here that indicate the root of a project\r\nlocal root_markers = { \".git\", \".editorconfig\", \"package.json\" }\r\n-- Change to table with settings if required\r\nlocal settings = vim.empty_dict()\r\n\r\nvim.api.nvim_create_autocmd(\"FileType\", {\r\n\tpattern = pattern,\r\n\tcallback = function(args)\r\n\t\tlocal match = vim.fs.find(root_markers, { path = args.file, upward = true })[1]\r\n\t\tlocal root_dir = match and vim.fn.fnamemodify(match, \":p:h\") or nil\r\n\t\tvim.lsp.start({\r\n\t\t\tname = \"bugged-ls\",\r\n\t\t\tcmd = cmd,\r\n\t\t\troot_dir = root_dir,\r\n\t\t\tsettings = settings,\r\n\t\t})\r\n\t\tvim.lsp.set_log_level(\"debug\")\r\n\tend,\r\n})\r\n```\r\n</details>\r\n\r\n1. `npm install --global typescript-language-server`\r\n2. Create a new directory and `npm init` with `index.ts` as the entry point\r\n3. Create `index.ts` and add the following\r\n\r\n```typescript\r\nconst new_object = {\r\n\tabc: \"test\",\r\n\tbcd: \"test2\",\r\n\tcde: \"test3\",\r\n};\r\n```\r\n\r\n4. On a new line type `new_object.`\r\n5. Trigger omni completion with `<c-x><c-o>` or the `<c-space>` keymap I included in the minimal config\r\n6. Use `<c-n>` to select the first completion item in the pop-up menu\r\n\r\n### Expected behavior\r\n\r\nThe completion item would be inserted as `abc`, resulting in:\r\n\r\n```typescript\r\nnew_object.abc\r\n```\r\n\r\nThe actual behavior is that the completion item is inserted as `.abc`, resulting in:\r\n\r\n```typescript\r\nnew_object..abc\r\n```\r\n\r\n### Neovim version (nvim -v)\r\n\r\n```\r\nNVIM v0.8.3\r\nBuild type: Release\r\nLuaJIT 2.1.0-beta3\r\nCompiled by brew@Ventura-arm64.local\r\n\r\nFeatures: +acl +iconv +tui\r\nSee \":help feature-compile\"\r\n\r\n   system vimrc file: \"$VIM/sysinit.vim\"\r\n  fall-back for $VIM: \"/opt/homebrew/Cellar/neovim/0.8.3/share/nvim\"\r\n\r\nRun :checkhealth for more info\r\n```\r\n\r\n### Language server name/version\r\n\r\ntypescript-language-server 3.3.1\r\n\r\n### Operating system/version\r\n\r\nmacOS 13.3\r\n\r\n### Log file\r\n\r\nhttps://gist.github.com/heygarrett/019363da1150ef2fc3c5bcbc56ebd7c0",
    "closed_at": "2023-08-11T12:20:07Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "I can confirm that this is happening to me as well.",
            "created_at": "2023-03-30T11:12:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/22803#issuecomment-1490119034",
            "id": 1490119034,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/22803",
            "node_id": "IC_kwDOAPphoM5Y0Wl6",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1490119034/reactions"
            },
            "updated_at": "2023-03-30T11:12:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1490119034",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/454988?v=4",
                "events_url": "https://api.github.com/users/Vizualni/events{/privacy}",
                "followers_url": "https://api.github.com/users/Vizualni/followers",
                "following_url": "https://api.github.com/users/Vizualni/following{/other_user}",
                "gists_url": "https://api.github.com/users/Vizualni/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Vizualni",
                "id": 454988,
                "login": "Vizualni",
                "node_id": "MDQ6VXNlcjQ1NDk4OA==",
                "organizations_url": "https://api.github.com/users/Vizualni/orgs",
                "received_events_url": "https://api.github.com/users/Vizualni/received_events",
                "repos_url": "https://api.github.com/users/Vizualni/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Vizualni/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Vizualni/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Vizualni"
            }
        },
        {
            "author_association": "NONE",
            "body": "Relevant comment: https://github.com/typescript-language-server/typescript-language-server/issues/711#issuecomment-1490151455 ",
            "created_at": "2023-03-30T12:39:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/22803#issuecomment-1490232496",
            "id": 1490232496,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/22803",
            "node_id": "IC_kwDOAPphoM5Y0ySw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1490232496/reactions"
            },
            "updated_at": "2023-03-30T12:39:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1490232496",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/454988?v=4",
                "events_url": "https://api.github.com/users/Vizualni/events{/privacy}",
                "followers_url": "https://api.github.com/users/Vizualni/followers",
                "following_url": "https://api.github.com/users/Vizualni/following{/other_user}",
                "gists_url": "https://api.github.com/users/Vizualni/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Vizualni",
                "id": 454988,
                "login": "Vizualni",
                "node_id": "MDQ6VXNlcjQ1NDk4OA==",
                "organizations_url": "https://api.github.com/users/Vizualni/orgs",
                "received_events_url": "https://api.github.com/users/Vizualni/received_events",
                "repos_url": "https://api.github.com/users/Vizualni/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Vizualni/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Vizualni/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Vizualni"
            }
        },
        {
            "author_association": "NONE",
            "body": "I am currently experiencing this issue as well.",
            "created_at": "2023-04-04T23:57:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/22803#issuecomment-1496739754",
            "id": 1496739754,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/22803",
            "node_id": "IC_kwDOAPphoM5ZNm-q",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1496739754/reactions"
            },
            "updated_at": "2023-04-04T23:57:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1496739754",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1329249?v=4",
                "events_url": "https://api.github.com/users/kennethlee/events{/privacy}",
                "followers_url": "https://api.github.com/users/kennethlee/followers",
                "following_url": "https://api.github.com/users/kennethlee/following{/other_user}",
                "gists_url": "https://api.github.com/users/kennethlee/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kennethlee",
                "id": 1329249,
                "login": "kennethlee",
                "node_id": "MDQ6VXNlcjEzMjkyNDk=",
                "organizations_url": "https://api.github.com/users/kennethlee/orgs",
                "received_events_url": "https://api.github.com/users/kennethlee/received_events",
                "repos_url": "https://api.github.com/users/kennethlee/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kennethlee/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kennethlee/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kennethlee"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/22803/comments",
    "created_at": "2023-03-28T17:21:09Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/22803/events",
    "html_url": "https://github.com/neovim/neovim/issues/22803",
    "id": 1644373215,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/22803/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5iAyTf",
    "number": 22803,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 4,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 4,
        "url": "https://api.github.com/repos/neovim/neovim/issues/22803/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/22803/timeline",
    "title": "Extra period inserted when selecting omni completion item from pop-up menu with tsserver",
    "updated_at": "2023-08-11T12:20:07Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/22803",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1154912?v=4",
        "events_url": "https://api.github.com/users/heygarrett/events{/privacy}",
        "followers_url": "https://api.github.com/users/heygarrett/followers",
        "following_url": "https://api.github.com/users/heygarrett/following{/other_user}",
        "gists_url": "https://api.github.com/users/heygarrett/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/heygarrett",
        "id": 1154912,
        "login": "heygarrett",
        "node_id": "MDQ6VXNlcjExNTQ5MTI=",
        "organizations_url": "https://api.github.com/users/heygarrett/orgs",
        "received_events_url": "https://api.github.com/users/heygarrett/received_events",
        "repos_url": "https://api.github.com/users/heygarrett/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/heygarrett/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/heygarrett/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/heygarrett"
    }
}