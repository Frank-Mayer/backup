{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\r\n\r\nHi, thanks for the work on this editor !\r\n\r\nI noticed recently that using `markdown` and `markdow_inline` parsers [here](https://github.com/MDeiml/tree-sitter-markdown), the buffer parsing seems to fail when switching back and forth with e.g `ctrl-o` and `ctrl-i`.\r\nThe parsing is fine when entering and editing the buffer on the first time. However, when moving away and coming back, the parsing seems to fail, but as soon as an action is performed on the buffer (e.g just saving), everything \"synchronizes back\" (without even using the command \"solving\" the issue https://github.com/nvim-treesitter/nvim-treesitter/issues/78, that is why I am opening this one)\r\n\r\nI think this is a neovim related issue because the latter bug does not exist anymore when not setting `vim.wo.foldmethod = \"marker\"`.\r\n\r\nThanks for your time and your attention to this.\r\n\r\n### Steps to reproduce\r\n\r\n1. Use the following `init.lua` with `nvim-treesitter` plugin installed\r\n```lua\r\nlocal success, treesitter = pcall(require, \"nvim-treesitter.configs\")\r\n\r\nif not success then\r\n  return\r\nend\r\n\r\ntreesitter.setup {\r\n  ensure_installed = { \"c\", \"lua\", \"vim\", \"vimdoc\", \"query\", \"markdown\", \"markdown_inline\" },\r\n  sync_install = false,\r\n  auto_install = false,\r\n  highlight = {\r\n    enable = true,\r\n    additional_vim_regex_highlighting = false,\r\n  },\r\n  indent = {\r\n    enable = false,\r\n  },\r\n  ignore_install = {},\r\n  modules = {},\r\n}\r\n\r\n-- default vim.wo.foldenable = true\r\nvim.wo.foldmethod = \"marker\"\r\n```\r\n\r\n2. Try with the following two markdown notes\r\n```markdown\r\n- Write some things\r\n    - Here some tests\r\n    ```python\r\n    print(\"hello neovim\")\r\n\r\n\r\n    class NeoVim:\r\n\r\n        def __init__(self, great):\r\n            self.great = great\r\n    ```\r\n```\r\n\r\n```markdown\r\n- Write some things\r\n    - Here some tests\r\n    ```javascript\r\n    const weak = new WeakSet()\r\n    const obj = { hej: \"hej\" }\r\n    weak.add(obj)\r\n\r\n    if (weak.has(obj) {\r\n        console.log(weak);\r\n    }\r\n    ```\r\n```\r\n\r\n3. Try to jumps between the two of them back and forth with `ctrl-o` or `ctrl-i` \r\n4. One should observe that the highlighting of the code is failing and other niceties of the previous parsers are not working.\r\n\r\n\r\n### Expected behavior\r\n\r\nEven with the latter setting `foldmethod` set to `\"marker\"`, I would have expected the previous switching to work fine.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.10.0-dev-2133+g5a8fe0769\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nno treesitter\r\n\r\n### Operating system/version\r\n\r\nUbuntu 22.04.3 LTS\r\n\r\n### Terminal name/version\r\n\r\nkitty 0.31.0\r\n\r\n### $TERM environment variable\r\n\r\nxterm-kitty\r\n\r\n### Installation\r\n\r\nbuild from repo (release build type)",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think this could have been fixed by https://github.com/neovim/neovim/pull/28530. Can you still reproduce on the latest version?",
            "created_at": "2024-05-11T05:23:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/27094#issuecomment-2105566498",
            "id": 2105566498,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27094",
            "node_id": "IC_kwDOAPphoM59gGUi",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2105566498/reactions"
            },
            "updated_at": "2024-05-11T05:23:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2105566498",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/19489738?v=4",
                "events_url": "https://api.github.com/users/tomtomjhj/events{/privacy}",
                "followers_url": "https://api.github.com/users/tomtomjhj/followers",
                "following_url": "https://api.github.com/users/tomtomjhj/following{/other_user}",
                "gists_url": "https://api.github.com/users/tomtomjhj/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tomtomjhj",
                "id": 19489738,
                "login": "tomtomjhj",
                "node_id": "MDQ6VXNlcjE5NDg5NzM4",
                "organizations_url": "https://api.github.com/users/tomtomjhj/orgs",
                "received_events_url": "https://api.github.com/users/tomtomjhj/received_events",
                "repos_url": "https://api.github.com/users/tomtomjhj/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tomtomjhj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tomtomjhj/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tomtomjhj"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27094/comments",
    "created_at": "2024-01-19T15:56:11Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27094/events",
    "html_url": "https://github.com/neovim/neovim/issues/27094",
    "id": 2090830324,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "waiting for reply from the author",
            "id": 248229439,
            "name": "needs:response",
            "node_id": "MDU6TGFiZWwyNDgyMjk0Mzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:response"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1799626557,
            "name": "treesitter",
            "node_id": "MDU6TGFiZWwxNzk5NjI2NTU3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/treesitter"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 2598645343,
            "name": "folds",
            "node_id": "MDU6TGFiZWwyNTk4NjQ1MzQz",
            "url": "https://api.github.com/repos/neovim/neovim/labels/folds"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27094/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM58n4n0",
    "number": 27094,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27094/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27094/timeline",
    "title": "switching back and forth from a markdown buffer seems to make the parsing fail when the vim.o.foldmethod is set to \"marker\"",
    "updated_at": "2024-05-12T12:45:16Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27094",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/72404196?v=4",
        "events_url": "https://api.github.com/users/lmenou/events{/privacy}",
        "followers_url": "https://api.github.com/users/lmenou/followers",
        "following_url": "https://api.github.com/users/lmenou/following{/other_user}",
        "gists_url": "https://api.github.com/users/lmenou/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/lmenou",
        "id": 72404196,
        "login": "lmenou",
        "node_id": "MDQ6VXNlcjcyNDA0MTk2",
        "organizations_url": "https://api.github.com/users/lmenou/orgs",
        "received_events_url": "https://api.github.com/users/lmenou/received_events",
        "repos_url": "https://api.github.com/users/lmenou/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/lmenou/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lmenou/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/lmenou"
    }
}