{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nVisual glitch occurs when a line has any non-space characters whose columns are less than or equal to the terminal width, and so many trailing spaces that the line length is greater than twice of the terminal width.\r\n\r\n![long](https://github.com/neovim/neovim/assets/11627708/a9df737a-ac11-4ff0-b677-7997a2b3ff71)\r\n\n\n### Steps to reproduce\n\nSet the terminal width to 80.\r\n\r\nDownload [a.txt](https://github.com/neovim/neovim/files/12480777/a.txt) and open it. The line length of the first line is 161.\r\nMove the cursor.\r\n\r\nRedraw fixes the glitch.\n\n### Expected behavior\n\nNo visual glitch.\n\n### Neovim version (nvim -v)\n\nv0.10.0-dev-995+gb2c3e9c72\n\n### Vim (not Nvim) behaves the same?\n\nno, vim 9.0.1736\n\n### Operating system/version\n\nEndeavourOS\n\n### Terminal name/version\n\nGNOME Terminal 3.48.2 using VTE 0.72.2 +BIDI +GNUTLS +ICU +SYSTEMD\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nbuild from repo",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Seem to be caused by #23891",
            "created_at": "2023-08-30T23:36:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/24955#issuecomment-1699988339",
            "id": 1699988339,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24955",
            "node_id": "IC_kwDOAPphoM5lU8Nz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1699988339/reactions"
            },
            "updated_at": "2023-08-30T23:36:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1699988339",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This unconditional final column wrap doesn't look correct:\r\nhttps://github.com/neovim/neovim/blob/ee56daebb6468075e743db0d605cb3f2a1699419/src/nvim/tui/tui.c#L1479\r\n\r\nIf the next call to `tui_raw_line()` wants to clear the next screen line, it doesn't print any characters, so in most terminals cursor hasn't advanced to the next screen line yet, and the cursor row on the grid is wrong.\r\n\r\nI think this call should be removed, as `print_cell()` already calls `final_column_wrap()` when appropriate.\r\n\r\n@rickyz @bfredl Any ideas?",
            "created_at": "2023-08-31T04:03:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/24955#issuecomment-1700335744",
            "id": 1700335744,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24955",
            "node_id": "IC_kwDOAPphoM5lWRCA",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700335744/reactions"
            },
            "updated_at": "2023-08-31T04:03:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700335744",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I think this call should be removed, as print_cell() already calls final_column_wrap() when appropriate.\r\n\r\nNot in order to implement the wrapping line behavior of `kLineFlagWrap`. for the vast majority of terminals, `print_cell()` does _not_ call `final_column_wrap()` after printing the last char of the line.\r\n\r\n> If the next call to tui_raw_line() wants to clear the next screen line, it doesn't print any characters, \r\n\r\nThis looks like the real problem which should be fixed as such. after the change to use the grid_line event, TUI code might use clearing by accident even though nvim intended real spaces to be written. I think the fix is simple though: remember if _last_ line immediately did `kLineFlagWrap`, then a real char must always be printed, even if it is just a dummy space before clearing the rest of the line.\r\n",
            "created_at": "2023-08-31T08:14:26Z",
            "html_url": "https://github.com/neovim/neovim/issues/24955#issuecomment-1700571724",
            "id": 1700571724,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24955",
            "node_id": "IC_kwDOAPphoM5lXKpM",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700571724/reactions"
            },
            "updated_at": "2023-08-31T08:14:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700571724",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Ah yes, clearing the line seems to be the actual problem here, as the user should need to copy the spaces.",
            "created_at": "2023-08-31T08:24:40Z",
            "html_url": "https://github.com/neovim/neovim/issues/24955#issuecomment-1700586966",
            "id": 1700586966,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24955",
            "node_id": "IC_kwDOAPphoM5lXOXW",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700586966/reactions"
            },
            "updated_at": "2023-08-31T08:24:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1700586966",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/24955/comments",
    "created_at": "2023-08-30T23:22:07Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/24955/events",
    "html_url": "https://github.com/neovim/neovim/issues/24955",
    "id": 1874509576,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        },
        {
            "color": "f9d0c4",
            "default": false,
            "description": "wrong behavior that was introduced in a previous commit (please bisect)",
            "id": 619474658,
            "name": "bug-regression",
            "node_id": "MDU6TGFiZWw2MTk0NzQ2NTg=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-regression"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue has been tracked to a specific commit",
            "id": 1481421490,
            "name": "has:bisected",
            "node_id": "MDU6TGFiZWwxNDgxNDIxNDkw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:bisected"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/24955/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 124,
        "created_at": "2023-02-02T14:11:43Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
            "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
            "followers_url": "https://api.github.com/users/bfredl/followers",
            "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
            "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bfredl",
            "id": 1363104,
            "login": "bfredl",
            "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
            "organizations_url": "https://api.github.com/users/bfredl/orgs",
            "received_events_url": "https://api.github.com/users/bfredl/received_events",
            "repos_url": "https://api.github.com/users/bfredl/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bfredl"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/36",
        "id": 8997654,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/36/labels",
        "node_id": "MI_kwDOAPphoM4AiUsW",
        "number": 36,
        "open_issues": 142,
        "state": "open",
        "title": "0.10",
        "updated_at": "2023-08-31T22:08:29Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/36"
    },
    "node_id": "I_kwDOAPphoM5vur8I",
    "number": 24955,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/24955/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/24955/timeline",
    "title": "Glitch for a Long Line with Trailing Spaces",
    "updated_at": "2023-08-31T08:24:40Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/24955",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11627708?v=4",
        "events_url": "https://api.github.com/users/e-kwsm/events{/privacy}",
        "followers_url": "https://api.github.com/users/e-kwsm/followers",
        "following_url": "https://api.github.com/users/e-kwsm/following{/other_user}",
        "gists_url": "https://api.github.com/users/e-kwsm/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/e-kwsm",
        "id": 11627708,
        "login": "e-kwsm",
        "node_id": "MDQ6VXNlcjExNjI3NzA4",
        "organizations_url": "https://api.github.com/users/e-kwsm/orgs",
        "received_events_url": "https://api.github.com/users/e-kwsm/received_events",
        "repos_url": "https://api.github.com/users/e-kwsm/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/e-kwsm/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/e-kwsm/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/e-kwsm"
    }
}