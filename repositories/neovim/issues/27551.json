{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nWhen installing neovim on Windows using t he MSI setup, versions 0.9.0 and newer only ever add the neovim program directory to the `PATH` environment variable of the current user who is running the installer, not everyone.\r\n\r\nThis leads to neovim (`nvim` command) not being available to any user on the computer except one.\r\n\r\nThis appears to be a regression from the following PR: https://github.com/neovim/neovim/pull/22856\r\nwhich was soon after partially, but not fully, reverted in https://github.com/neovim/neovim/commit/95fe166d13fe51d1656c659dbb78b258a6f5dcd8\r\n\r\nThe problem is that the \"System\" attribute in the WiX \"Environment\" block remains changed to \"no\":\r\n\r\n```diff\r\n    <CPackWiXFragment Id=\"CM_CP_bin.nvim.exe\">\r\n      <Environment\r\n        Id='UpdatePath'\r\n        Name='PATH'\r\n        Action='set'\r\n        Permanent='no'\r\n-       System='yes'\r\n+       System='no'\r\n        Part='last'\r\n        Value='[INSTALL_ROOT]bin'\r\n      />\r\n    </CPackWiXFragment>\r\n```\r\n\r\nWiX Docs v3: https://wixtoolset.org/docs/v3/xsd/wix/environment/\r\nWiX Docs v4: https://wixtoolset.org/docs/schema/wxs/environment/#attributes\r\n\r\n> System (YesNoTypeUnion]):\r\n> Specifies that the environment variable should be added to the system environment space. The default is 'no' which indicates the environment variable is added to the user environment space.\r\n\r\nInstalling neovim 0.8.3 using the MSI installer, everything works as expected\n\n### Steps to reproduce\n\ncurl.exe -L \"https://github.com/neovim/neovim/releases/download/v0.9.5/nvim-win64.msi\" -o \"nvim095-win64.msi\"\r\ncmd.exe /D /C start \"\" /WAIT /B msiexec.exe /i \"nvim095-win64.msi\" /qn ALLUSERS=1\r\n\r\npowershell.exe -noprofile -c \"[environment]::GetEnvironmentVariable('PATH', 'machine') -split ';'\"\r\npowershell.exe -noprofile -c \"[environment]::GetEnvironmentVariable('PATH', 'user') -split ';'\"\n\n### Expected behavior\n\nNeovim / the `nvim` command should be available to all users after Neovim has been installed, like it was before v0.9.0.\n\n### Neovim version (nvim -v)\n\nNVIM v0.9.5\n\n### Vim (not Nvim) behaves the same?\n\n-\n\n### Operating system/version\n\nWindows Server 2022 Build 10.0.20348.2322\n\n### Terminal name/version\n\nMicrosoft Conhost 10.0.20348.2322\n\n### $TERM environment variable\n\n<not set>\n\n### Installation\n\nMSI",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "@ateoi",
            "created_at": "2024-02-20T11:30:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/27551#issuecomment-1954018897",
            "id": 1954018897,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27551",
            "node_id": "IC_kwDOAPphoM50d_ZR",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1954018897/reactions"
            },
            "updated_at": "2024-02-20T11:30:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1954018897",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27551/comments",
    "created_at": "2024-02-20T11:12:28Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27551/events",
    "html_url": "https://github.com/neovim/neovim/issues/27551",
    "id": 2144131220,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "d4c5f9",
            "default": false,
            "description": null,
            "id": 109461219,
            "name": "platform:windows",
            "node_id": "MDU6TGFiZWwxMDk0NjEyMTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/platform:windows"
        },
        {
            "color": "e6e6e6",
            "default": false,
            "description": "packaging and distributing Nvim to users",
            "id": 124686703,
            "name": "distribution",
            "node_id": "MDU6TGFiZWwxMjQ2ODY3MDM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/distribution"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27551/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 604,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Low priority. Not planned for the current target, may be reassigned.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 430,
        "state": "open",
        "title": "backlog",
        "updated_at": "2024-02-21T16:00:07Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM5_zNiU",
    "number": 27551,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27551/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27551/timeline",
    "title": "Windows: MSI installer only adds neovim to PATH for the current user (regression in 0.9.0+)",
    "updated_at": "2024-02-20T11:30:23Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27551",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/25607767?v=4",
        "events_url": "https://api.github.com/users/jantari/events{/privacy}",
        "followers_url": "https://api.github.com/users/jantari/followers",
        "following_url": "https://api.github.com/users/jantari/following{/other_user}",
        "gists_url": "https://api.github.com/users/jantari/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/jantari",
        "id": 25607767,
        "login": "jantari",
        "node_id": "MDQ6VXNlcjI1NjA3NzY3",
        "organizations_url": "https://api.github.com/users/jantari/orgs",
        "received_events_url": "https://api.github.com/users/jantari/received_events",
        "repos_url": "https://api.github.com/users/jantari/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/jantari/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jantari/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/jantari"
    }
}