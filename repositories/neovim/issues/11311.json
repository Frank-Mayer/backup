{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "@norcalli suggested:\r\n\r\n> Do we have any style guides for Lua on returning nil vs asserting inside\r\n> a function? Idiomatic lua would return nil and maybe a message as a second\r\n> parameter so that the caller can do `local value = assert(fn())`, which is what\r\n> I would recommend\r\n\r\nWe should:\r\n\r\n- Document the `local value = assert(fn())` idiom in `:help lua`\r\n- Document guidelines in `:help lua` and/or `:help dev-lua`\r\n- Consider this policy/guideline for the project:\r\n  - ~~\"Library functions\" should \"return `nil` + message\". Examples: `trim()`, `first()`~~\r\n  - **Guideline:** `assert()` or `error()` (\"fail early\", avoid silent/distant failure) for invalid usage (analogous to syntax error)\r\n  - Return `nil` + message for expected failure modes (failed requests, etc.): when caller is expected to handle the failure (control-flow)\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> \"Library functions\" should \"return nil + message\"  Examples: trim(), first(), ...\r\n\r\nUsing `if err != nil` error handling in every single utility function would just turn the code into a mess for no gain. In general, these functions will fail because there was something wrong with the arguments the caller sent in. There is nothing a plugin really can do about such an error than fix their code so it won't happen again in the first place, so adding explicit `assert()` at every call site is just redundant.\r\n\r\nRather, I think should use `value, err` return for functions where we explicitly \"expect the unexpected\", for instance when we communicate with the external world. When doing a LSP request it is _expected_ that the server might return an error (especially when dealing with multiple unknown servers) even if we did every thing right locally.\r\n\r\nAlso, errors should not be used in lua for expected sentinel conditions. @norcalli mentioned `nvim.api.nvim_get_var` throwing an error on missing var, which is not idomatic lua for sure but rather a mismatch of API conventions (in the API every error is already \"value, err\" internally) with lua conventions. A new `vim.g.my_var` interface should instead return `vim.NIL` (from #11310 ) for `g:my_var = v:null` and `nil` when it is missing.",
            "created_at": "2019-10-29T07:30:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/11311#issuecomment-547292227",
            "id": 547292227,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/11311",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzI5MjIyNw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547292227/reactions"
            },
            "updated_at": "2019-10-29T07:30:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547292227",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "updated, thanks!",
            "created_at": "2019-10-29T07:49:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/11311#issuecomment-547297185",
            "id": 547297185,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/11311",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzI5NzE4NQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547297185/reactions"
            },
            "updated_at": "2021-08-27T12:19:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547297185",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "For the record I agree with @bfredl on his refinement of the conditions and would add the summary of `If the user is using the library function wrong, that's a fatal error` as a guideline. This would include things like type errors which could go silently undetected otherwise. ",
            "created_at": "2019-10-29T07:52:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/11311#issuecomment-547298066",
            "id": 547298066,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/11311",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzI5ODA2Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547298066/reactions"
            },
            "updated_at": "2021-08-27T12:20:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547298066",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/296363?v=4",
                "events_url": "https://api.github.com/users/norcalli/events{/privacy}",
                "followers_url": "https://api.github.com/users/norcalli/followers",
                "following_url": "https://api.github.com/users/norcalli/following{/other_user}",
                "gists_url": "https://api.github.com/users/norcalli/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/norcalli",
                "id": 296363,
                "login": "norcalli",
                "node_id": "MDQ6VXNlcjI5NjM2Mw==",
                "organizations_url": "https://api.github.com/users/norcalli/orgs",
                "received_events_url": "https://api.github.com/users/norcalli/received_events",
                "repos_url": "https://api.github.com/users/norcalli/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/norcalli/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/norcalli/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/norcalli"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> add the summary of `If the user is using the library function wrong, that's a fatal error` as a guideline\r\n\r\nI did: see \"invalid usage\".",
            "created_at": "2019-10-29T08:13:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/11311#issuecomment-547304749",
            "id": 547304749,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/11311",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzMwNDc0OQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547304749/reactions"
            },
            "updated_at": "2021-08-27T12:20:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/547304749",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/11311/comments",
    "created_at": "2019-10-29T04:33:27Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/11311/events",
    "html_url": "https://github.com/neovim/neovim/issues/11311",
    "id": 513687605,
    "labels": [
        {
            "color": "FBCA04",
            "default": false,
            "description": "A discussion has run its course and a decision has to be made how to proceed",
            "id": 83851236,
            "name": "needs:decision",
            "node_id": "MDU6TGFiZWw4Mzg1MTIzNg==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:decision"
        },
        {
            "color": "c5def5",
            "default": true,
            "description": "",
            "id": 84744038,
            "name": "documentation",
            "node_id": "MDU6TGFiZWw4NDc0NDAzOA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/documentation"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "stdlib",
            "id": 573222693,
            "name": "lua",
            "node_id": "MDU6TGFiZWw1NzMyMjI2OTM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lua"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/11311/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 601,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Low priority. Not planned for the current target, may be reassigned.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 515,
        "state": "open",
        "title": "backlog",
        "updated_at": "2024-04-01T02:46:11Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "MDU6SXNzdWU1MTM2ODc2MDU=",
    "number": 11311,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/11311/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/11311/timeline",
    "title": "Lua stdlib: guidelines for raising errors",
    "updated_at": "2024-03-28T20:43:55Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/11311",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk"
    }
}