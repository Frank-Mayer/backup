{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nSending multiline messages throgh Noice causes assertion failure. At the moment I cannot simplify the problem within a reasonable time.\r\n\r\nI looked into https://github.com/neovim/neovim/issues/22919\n\n### Steps to reproduce\n\n- save the following content to `init.lua`:\r\n```lua\r\nlocal configDir = vim.fn.expand('<sfile>:p:h')\r\n\r\nvim.env['XDG_CONFIG_HOME'] = configDir\r\nvim.env['XDG_DATA_HOME'] = configDir .. '/.xdg/data'\r\nvim.env['XDG_STATE_HOME'] = configDir .. '/.xdg/state'\r\nvim.env['XDG_CACHE_HOME'] = configDir .. '/.xdg/cache'\r\nlocal stdPathConfig = vim.fn.stdpath('config')\r\n\r\nvim.opt.runtimepath:prepend(stdPathConfig)\r\nvim.opt.packpath:prepend(stdPathConfig)\r\nlocal plugins_path = vim.fn.fnamemodify('plugins/', ':p')\r\n\r\nfor name, url in pairs {\r\n  ['nui'] = 'https://github.com/MunifTanjim/nui.nvim',\r\n  ['noice.nvim'] = 'https://github.com/folke/noice.nvim',\r\n} do\r\n  local install_path = plugins_path .. name\r\n  if vim.fn.isdirectory(install_path) == 0 then\r\n    vim.fn.system { 'git', 'clone', '--depth=1', url, install_path }\r\n  end\r\n  vim.opt.runtimepath:append(install_path)\r\nend\r\n\r\nrequire('noice').setup({})\r\nvim.notify_once('\\n')\r\n```\r\n\r\n- run `nvim --clean -u init.lua`. For me nvim ends with code 134 and backtrace:\r\n```cpp\r\n#0  __pthread_kill_implementation (threadid=<optimized out>, signo=signo@entry=6, no_tid=no_tid@entry=0) at ./nptl/pthread_kill.c:44\r\n#1  0x00007fcb90e2114f in __pthread_kill_internal (signo=6, threadid=<optimized out>) at ./nptl/pthread_kill.c:78\r\n#2  0x00007fcb90dd3462 in __GI_raise (sig=sig@entry=6) at ../sysdeps/posix/raise.c:26\r\n#3  0x00007fcb90dbd4b2 in __GI_abort () at ./stdlib/abort.c:79\r\n#4  0x00007fcb90dbd3d5 in __assert_fail_base (fmt=0x7fcb90f31dc8 \"%s%s%s:%u: %s%sAssertion `%s' failed.\\n%n\", assertion=assertion@entry=0x55d27eff8f95 \"to_scroll >= 0\", \r\n    file=file@entry=0x55d27f018a98 \".../src/nvim/message.c\", line=line@entry=2444, function=function@entry=0x55d27efcc580 <__PRETTY_FUNCTION__.0> \"msg_scroll_flush\") at ./assert/assert.c:92\r\n#5  0x00007fcb90dcc3a2 in __assert_fail (assertion=assertion@entry=0x55d27eff8f95 \"to_scroll >= 0\", file=file@entry=0x55d27f018a98 \".../src/nvim/message.c\", line=line@entry=2444, \r\n    function=function@entry=0x55d27efcc580 <__PRETTY_FUNCTION__.0> \"msg_scroll_flush\") at ./assert/assert.c:101\r\n#6  0x000055d27ed8f93d in msg_scroll_flush () at .../src/nvim/message.c:2444\r\n#7  0x000055d27ee72119 in ui_flush () at .../src/nvim/ui.c:499\r\n#8  0x000055d27ecb5b64 in screen_resize (width=<optimized out>, height=<optimized out>) at .../src/nvim/drawscreen.c:375\r\n#9  0x000055d27ee70dfc in ui_refresh () at .../src/nvim/ui.c:228\r\n#10 0x000055d27ee72d10 in ui_add_cb (ns_id=1, cb=52, ext_widgets=<optimized out>) at .../src/nvim/ui.c:721\r\n#11 0x000055d27ed630b8 in nlua_ui_attach (lstate=0x7fcb90d75380) at .../src/nvim/lua/executor.c:690\r\n#12 0x000055d27ef32406 in lj_BC_FUNCC ()\r\n#13 0x000055d27ef1e855 in lua_pcall (L=L@entry=0x7fcb90d75380, nargs=nargs@entry=1, nresults=nresults@entry=1, errfunc=errfunc@entry=-3) at lj_api.c:1116\r\n#14 0x000055d27ed5bd09 in nlua_pcall (lstate=lstate@entry=0x7fcb90d75380, nargs=nargs@entry=1, nresults=nresults@entry=1) at .../src/nvim/lua/executor.c:164\r\n#15 0x000055d27ed62275 in nlua_call_ref (ref=<optimized out>, name=<optimized out>, args=..., retval=true, err=0x0) at .../src/nvim/lua/executor.c:1591\r\n#16 0x000055d27ec82079 in call_autocmd_callback (ac=ac@entry=0x55d27fd20100, apc=apc@entry=0x7ffc71c4a8d0) at .../src/nvim/autocmd.c:2007\r\n#17 0x000055d27ec84145 in getnextac (c=<optimized out>, cookie=0x7ffc71c4a8d0, indent=<optimized out>, do_concat=<optimized out>) at .../src/nvim/autocmd.c:2064\r\n#18 0x000055d27ed18015 in do_cmdline (cmdline=<optimized out>, fgetline=0x55d27ec83fb2 <getnextac>, cookie=0x7ffc71c4a8d0, flags=7) at .../src/nvim/ex_docmd.c:505\r\n#19 0x000055d27ec82d11 in apply_autocmds_group (event=EVENT_VIMENTER, fname=0x55d27fdc0a90 \"\", fname_io=<optimized out>, force=<optimized out>, group=group@entry=-3, buf=0x55d27fcec7f0, eap=0x0, data=0x0)\r\n    at .../src/nvim/autocmd.c:1792\r\n#20 0x000055d27ec833b1 in apply_autocmds (event=<optimized out>, fname=<optimized out>, fname_io=<optimized out>, force=<optimized out>, buf=<optimized out>) at .../src/nvim/autocmd.c:1462\r\n#21 0x000055d27ec38038 in main (argc=5, argv=<optimized out>) at .../src/nvim/main.c:592\r\n```\n\n### Expected behavior\n\nMessage can be displayed. \n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0-dev-1081+gf859d16ae\n\n### Vim (not Nvim) behaves the same?\n\n- \n\n### Operating system/version\n\nDebian Sid\n\n### Terminal name/version\n\ntmux 3.3a-4, kitty 0.26.5-5\n\n### $TERM environment variable\n\ntmux-256color\n\n### Installation\n\nfrom repo",
    "closed_at": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25100/comments",
    "created_at": "2023-09-11T18:51:05Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25100/events",
    "html_url": "https://github.com/neovim/neovim/issues/25100",
    "id": 1891071487,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 113026979,
            "name": "ui",
            "node_id": "MDU6TGFiZWwxMTMwMjY5Nzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui"
        },
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "UI extensibility, events, protocol",
            "id": 640132777,
            "name": "ui-ext",
            "node_id": "MDU6TGFiZWw2NDAxMzI3Nzc=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui-ext"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "UI messages, log messages",
            "id": 5637083595,
            "name": "messages",
            "node_id": "LA_kwDOAPphoM8AAAABT_8Ryw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/messages"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25100/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5wt3X_",
    "number": 25100,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25100/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25100/timeline",
    "title": "Assertion failure with newline character in message and `screen_resize`",
    "updated_at": "2023-09-11T21:05:29Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25100",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
        "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
        "followers_url": "https://api.github.com/users/przepompownia/followers",
        "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
        "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/przepompownia",
        "id": 11404453,
        "login": "przepompownia",
        "node_id": "MDQ6VXNlcjExNDA0NDUz",
        "organizations_url": "https://api.github.com/users/przepompownia/orgs",
        "received_events_url": "https://api.github.com/users/przepompownia/received_events",
        "repos_url": "https://api.github.com/users/przepompownia/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/przepompownia"
    }
}