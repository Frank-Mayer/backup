{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\nHaving registered the following autocmd\r\n\r\n```lua\r\nvim.api.nvim_create_autocmd({ \"WinLeave\", \"WinEnter\" }, {\r\n    pattern = \"*\",\r\n    callback = function(args)\r\n        vim.print('win - ' .. args.buf)\r\n    end\r\n})\r\n\r\nvim.api.nvim_create_autocmd({ \"BufLeave\", \"BufEnter\" }, {\r\n        pattern = \"*\",\r\n        callback = function(args)\r\n        vim.print('buf - ' .. args.buf)\r\n        end\r\n})\r\n\r\nvim.cmd([[\r\n    nmap gt <cmd>tabnew<cr>\r\n]])\r\n```\r\nBufLeave and BufEnter work as expected, however WinLeave and WinEnter do not. Win* events point to the same buffer (from the first tab). Buf* events point at the old and then the new one, as expected.\r\n\r\nBoth events point at the same buffer, the docs are somewhat unclear, as there is a note pertaining to file but nothing is mentioned what goes on when a new buffer is created as a consequence of tabnew.\r\n\r\n```md\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t*WinEnter*\r\nWinEnter\t\t\tAfter entering another window.  Not done for\r\n\t\t\t\tthe first window, when Vim has just started.\r\n\t\t\t\tUseful for setting the window height.\r\n\t\t\t\t_**If the window is for another buffer, Vim\r\n\t\t\t\texecutes the BufEnter autocommands after the**_\r\n\t\t\t\tWinEnter autocommands.\r\n\t\t\t\t**Note: For split and tabpage commands the\r\n\t\t\t\tWinEnter event is triggered after the split\r\n\t\t\t\tor tab command but before the file is loaded.**\r\n\r\n\t\t\t\t\t\t\t*WinLeave*\r\nWinLeave\t\t\tBefore leaving a window.  If the window to be\r\n\t\t\t\tentered next is for a different buffer, _**Vim\r\n\t\t\t\texecutes the BufLeave autocommands before the**_\r\n\t\t\t\tWinLeave autocommands (but not for \":new\").\r\n\t\t\t\tNot used for \":qa\" or \":q\" when exiting Vim.\r\n\t\t\t\tBefore WinClosed.\r\n```\r\n\r\n### Steps to reproduce\r\n\r\nSee above\r\n\r\n### Expected behavior\r\n\r\nWinEnter should point to the buf in the new tab not the old one. The way BufEnter points to the buffer we enter, in the new tab, and BufLeave points to the buffer we left in the prev tab\r\n\r\n### Neovim version (nvim -v)\r\n\r\n0.10.0\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nyes\r\n\r\n### Operating system/version\r\n\r\nubuntu 22\r\n\r\n### Terminal name/version\r\n\r\nalacritty\r\n\r\n### $TERM environment variable\r\n\r\nalacritty\r\n\r\n### Installation\r\n\r\ngithub",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "@zeertzjq is that trully a documentation issue, or something that does not work as indended ? Seems inconsistent, as WinEnter and Leave are triggered, and produce correct results, if you navigate to already existing tab. ",
            "created_at": "2024-06-20T13:37:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/29430#issuecomment-2180726384",
            "id": 2180726384,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29430",
            "node_id": "IC_kwDOAPphoM6B-z5w",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2180726384/reactions"
            },
            "updated_at": "2024-06-20T13:37:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2180726384",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/15955811?v=4",
                "events_url": "https://api.github.com/users/asmodeus812/events{/privacy}",
                "followers_url": "https://api.github.com/users/asmodeus812/followers",
                "following_url": "https://api.github.com/users/asmodeus812/following{/other_user}",
                "gists_url": "https://api.github.com/users/asmodeus812/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/asmodeus812",
                "id": 15955811,
                "login": "asmodeus812",
                "node_id": "MDQ6VXNlcjE1OTU1ODEx",
                "organizations_url": "https://api.github.com/users/asmodeus812/orgs",
                "received_events_url": "https://api.github.com/users/asmodeus812/received_events",
                "repos_url": "https://api.github.com/users/asmodeus812/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/asmodeus812/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/asmodeus812/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/asmodeus812"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Yes. \"before the file is loaded\" means before the buffer is created.",
            "created_at": "2024-06-20T14:01:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/29430#issuecomment-2180786722",
            "id": 2180786722,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29430",
            "node_id": "IC_kwDOAPphoM6B_Coi",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2180786722/reactions"
            },
            "updated_at": "2024-06-20T14:01:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2180786722",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "NONE",
            "body": "I see, then in case one would like to cover the true WinEnter use case, one has to use `TabNew, WinNew and WinEnter` ?",
            "created_at": "2024-06-20T14:12:52Z",
            "html_url": "https://github.com/neovim/neovim/issues/29430#issuecomment-2180814698",
            "id": 2180814698,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29430",
            "node_id": "IC_kwDOAPphoM6B_Jdq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2180814698/reactions"
            },
            "updated_at": "2024-06-20T14:12:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2180814698",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/15955811?v=4",
                "events_url": "https://api.github.com/users/asmodeus812/events{/privacy}",
                "followers_url": "https://api.github.com/users/asmodeus812/followers",
                "following_url": "https://api.github.com/users/asmodeus812/following{/other_user}",
                "gists_url": "https://api.github.com/users/asmodeus812/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/asmodeus812",
                "id": 15955811,
                "login": "asmodeus812",
                "node_id": "MDQ6VXNlcjE1OTU1ODEx",
                "organizations_url": "https://api.github.com/users/asmodeus812/orgs",
                "received_events_url": "https://api.github.com/users/asmodeus812/received_events",
                "repos_url": "https://api.github.com/users/asmodeus812/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/asmodeus812/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/asmodeus812/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/asmodeus812"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Vim (not Nvim) behaves the same?\r\n> no\r\n\r\ndoes vim really differ here?",
            "created_at": "2024-06-20T16:01:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/29430#issuecomment-2181049016",
            "id": 2181049016,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29430",
            "node_id": "IC_kwDOAPphoM6CACq4",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2181049016/reactions"
            },
            "updated_at": "2024-09-29T00:09:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2181049016",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "@justinmk, edited the issue, vim behaves the same.",
            "created_at": "2024-06-21T03:14:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/29430#issuecomment-2181917800",
            "id": 2181917800,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29430",
            "node_id": "IC_kwDOAPphoM6CDWxo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2181917800/reactions"
            },
            "updated_at": "2024-09-29T00:09:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2181917800",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/15955811?v=4",
                "events_url": "https://api.github.com/users/asmodeus812/events{/privacy}",
                "followers_url": "https://api.github.com/users/asmodeus812/followers",
                "following_url": "https://api.github.com/users/asmodeus812/following{/other_user}",
                "gists_url": "https://api.github.com/users/asmodeus812/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/asmodeus812",
                "id": 15955811,
                "login": "asmodeus812",
                "node_id": "MDQ6VXNlcjE1OTU1ODEx",
                "organizations_url": "https://api.github.com/users/asmodeus812/orgs",
                "received_events_url": "https://api.github.com/users/asmodeus812/received_events",
                "repos_url": "https://api.github.com/users/asmodeus812/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/asmodeus812/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/asmodeus812/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/asmodeus812"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Internally `tabnew` is a shortcut for\r\n\r\n```\r\ntab split\r\nenew\r\n```\r\n\r\nThe first command triggers winleave/winenter with old buffer active; then the second one does bufleave/bufenter for a new buffer. This is how virtually all \"-new\" commands work in Vim.\r\n\r\nBtw. There is no such thing as \"true winenter\". If the current window is changed (for whatever reason) then winleave/winenter is triggered. Events are never about commands used, they are about \"state changes\".",
            "created_at": "2024-06-27T11:36:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/29430#issuecomment-2194449907",
            "id": 2194449907,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29430",
            "node_id": "IC_kwDOAPphoM6CzKXz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2194449907/reactions"
            },
            "updated_at": "2024-06-27T11:36:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2194449907",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35012635?v=4",
                "events_url": "https://api.github.com/users/matveyt/events{/privacy}",
                "followers_url": "https://api.github.com/users/matveyt/followers",
                "following_url": "https://api.github.com/users/matveyt/following{/other_user}",
                "gists_url": "https://api.github.com/users/matveyt/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/matveyt",
                "id": 35012635,
                "login": "matveyt",
                "node_id": "MDQ6VXNlcjM1MDEyNjM1",
                "organizations_url": "https://api.github.com/users/matveyt/orgs",
                "received_events_url": "https://api.github.com/users/matveyt/received_events",
                "repos_url": "https://api.github.com/users/matveyt/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/matveyt/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/matveyt/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/matveyt"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/29430/comments",
    "created_at": "2024-06-20T12:29:12Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/29430/events",
    "html_url": "https://github.com/neovim/neovim/issues/29430",
    "id": 2364322525,
    "labels": [
        {
            "color": "c5def5",
            "default": true,
            "description": "",
            "id": 84744038,
            "name": "documentation",
            "node_id": "MDU6TGFiZWw4NDc0NDAzOA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/documentation"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "events, autocommands",
            "id": 3341085842,
            "name": "events",
            "node_id": "MDU6TGFiZWwzMzQxMDg1ODQy",
            "url": "https://api.github.com/repos/neovim/neovim/labels/events"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/29430/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 649,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 589,
        "state": "open",
        "title": "backlog",
        "updated_at": "2024-09-30T17:10:20Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM6M7LLd",
    "number": 29430,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/29430/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/29430/timeline",
    "title": "WinLeave and WinEnter point at the same buffer on tabnew",
    "updated_at": "2024-09-29T00:10:05Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/29430",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/15955811?v=4",
        "events_url": "https://api.github.com/users/asmodeus812/events{/privacy}",
        "followers_url": "https://api.github.com/users/asmodeus812/followers",
        "following_url": "https://api.github.com/users/asmodeus812/following{/other_user}",
        "gists_url": "https://api.github.com/users/asmodeus812/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/asmodeus812",
        "id": 15955811,
        "login": "asmodeus812",
        "node_id": "MDQ6VXNlcjE1OTU1ODEx",
        "organizations_url": "https://api.github.com/users/asmodeus812/orgs",
        "received_events_url": "https://api.github.com/users/asmodeus812/received_events",
        "repos_url": "https://api.github.com/users/asmodeus812/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/asmodeus812/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/asmodeus812/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/asmodeus812"
    }
}