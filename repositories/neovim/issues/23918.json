{
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
        "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
        "followers_url": "https://api.github.com/users/lewis6991/followers",
        "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
        "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/lewis6991",
        "id": 7904185,
        "login": "lewis6991",
        "node_id": "MDQ6VXNlcjc5MDQxODU=",
        "organizations_url": "https://api.github.com/users/lewis6991/orgs",
        "received_events_url": "https://api.github.com/users/lewis6991/received_events",
        "repos_url": "https://api.github.com/users/lewis6991/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/lewis6991",
        "user_view_type": "public"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
            "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
            "followers_url": "https://api.github.com/users/lewis6991/followers",
            "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
            "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/lewis6991",
            "id": 7904185,
            "login": "lewis6991",
            "node_id": "MDQ6VXNlcjc5MDQxODU=",
            "organizations_url": "https://api.github.com/users/lewis6991/orgs",
            "received_events_url": "https://api.github.com/users/lewis6991/received_events",
            "repos_url": "https://api.github.com/users/lewis6991/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/lewis6991",
            "user_view_type": "public"
        }
    ],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nUpon upgrading to nvim-0.9.1 I noticed a huge slowdown. It is especially noticeable with some plugins enabled.\r\n\r\nFor example, commenting with `Comment.nvim` or `mini.comment` takes a very long time (5 seconds?), with `nvim-ts-rainbow` plugin installed. Either https://github.com/mrjones2014/nvim-ts-rainbow or https://github.com/HiPhish/nvim-ts-rainbow2 causes the slowdown.\r\n\r\nReverting the neovim commit https://github.com/neovim/neovim/commit/1b09bcef522754452e46294a2340050f390a590b fixes the issue.\r\n\r\nI think the culprit comes from both the rainbow plugin and the neovim core, thus reporting the issue here.\n\n### Steps to reproduce\n\n1. Install the following plugins.\r\n\r\nhttps://github.com/nvim-treesitter/nvim-treesitter\r\nhttps://github.com/mrjones2014/nvim-ts-rainbow\r\nhttps://github.com/numToStr/Comment.nvim\r\n\r\n2. Configure with\r\n\r\n```lua\r\nrequire(\"Comment\").setup()\r\nrequire(\"nvim-treesitter.configs\").setup {\r\n  indent = {\r\n    enable = true,\r\n  },\r\n\r\n  ensure_installed = {\r\n    \"lua\",\r\n  },\r\n\r\n  sync_install = false,\r\n  auto_install = true,\r\n\r\n  highlight = {\r\n    enable = true,\r\n  },\r\n\r\n  rainbow = {\r\n    enable = true,\r\n    extended_mode = true, -- Also highlight non-bracket delimiters like html tags, boolean or table: lang -> boolean\r\n    max_file_lines = nil, -- Do not enable for files with more than n lines, int\r\n  },\r\n}\r\n```\r\n\r\n3. Open a large file with over 1000 lines. Select a tree-sitter node region (Visual line). `gc` to comment the block. It takes 5 seconds to comment.\r\nIf the region is not a tree-sitter node, it is fast. For example, select anything large that starts with `{` and ends with `}` in lua. it will be slow. If you select non-matching brackets like\r\n```lua\r\n{\r\n  {\r\n    -- ...\r\n  }\r\n```\r\nThen it is fast.\r\n\r\nFor example, try this file: https://github.com/kiyoon/dotfiles/blob/376d50216f7100e6782c5788ea008d9ab2da30fd/nvim/lua/kiyoon/lazy.lua\r\n\r\nCommenting from line 10 to 48 is slow. Commenting from line 9 to 48 is fast.\r\n\r\n4. Try using nvim-0.9.0 or reverting the commit. It doesn't have the problem anymore. \n\n### Expected behavior\n\nShould be commented instantly.\n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0-dev-449+gcc4169777\n\n### Vim (not Nvim) behaves the same?\n\ntreesitter related\n\n### Operating system/version\n\nUbuntu 22.04\n\n### Terminal name/version\n\nwezterm 20230408-112425-69ae8472\n\n### $TERM environment variable\n\ntmux-256color\n\n### Installation\n\nappimage / build from repo",
    "closed_at": "2024-12-16T16:54:38Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
        "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
        "followers_url": "https://api.github.com/users/lewis6991/followers",
        "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
        "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/lewis6991",
        "id": 7904185,
        "login": "lewis6991",
        "node_id": "MDQ6VXNlcjc5MDQxODU=",
        "organizations_url": "https://api.github.com/users/lewis6991/orgs",
        "received_events_url": "https://api.github.com/users/lewis6991/received_events",
        "repos_url": "https://api.github.com/users/lewis6991/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/lewis6991",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "https://github.com/nvim-treesitter/nvim-treesitter-textobjects/issues/461\r\n\r\nThis issue also claims that using nvim-0.9.0 is faster when opening zig files. I don't know how to reproduce this one, though. The author doesn't use `nvim-ts-rainbow` plugin.",
            "created_at": "2023-06-05T13:30:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/23918#issuecomment-1576813867",
            "id": 1576813867,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23918",
            "node_id": "IC_kwDOAPphoM5d_EUr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1576813867/reactions"
            },
            "updated_at": "2023-06-05T13:31:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1576813867",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/12980409?v=4",
                "events_url": "https://api.github.com/users/kiyoon/events{/privacy}",
                "followers_url": "https://api.github.com/users/kiyoon/followers",
                "following_url": "https://api.github.com/users/kiyoon/following{/other_user}",
                "gists_url": "https://api.github.com/users/kiyoon/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kiyoon",
                "id": 12980409,
                "login": "kiyoon",
                "node_id": "MDQ6VXNlcjEyOTgwNDA5",
                "organizations_url": "https://api.github.com/users/kiyoon/orgs",
                "received_events_url": "https://api.github.com/users/kiyoon/received_events",
                "repos_url": "https://api.github.com/users/kiyoon/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kiyoon/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kiyoon/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kiyoon",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Just as a data point, it _is_ instant with `mini.nvim` and without a rainbow plugin.",
            "created_at": "2023-06-05T15:20:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/23918#issuecomment-1577008428",
            "id": 1577008428,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23918",
            "node_id": "IC_kwDOAPphoM5d_z0s",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1577008428/reactions"
            },
            "updated_at": "2023-06-05T15:20:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1577008428",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "You can switch to https://github.com/HiPhish/rainbow-delimiters.nvim and try this https://github.com/ayamir/nvimdots/pull/868/files#diff-7afb3c58f8ec9d7f1f1c2cee79bda98f970246cf3943df4438f3504f6695a979",
            "created_at": "2023-07-18T19:21:04Z",
            "html_url": "https://github.com/neovim/neovim/issues/23918#issuecomment-1640859695",
            "id": 1640859695,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23918",
            "node_id": "IC_kwDOAPphoM5hzYgv",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1640859695/reactions"
            },
            "updated_at": "2023-07-18T19:21:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1640859695",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41792945?v=4",
                "events_url": "https://api.github.com/users/fecet/events{/privacy}",
                "followers_url": "https://api.github.com/users/fecet/followers",
                "following_url": "https://api.github.com/users/fecet/following{/other_user}",
                "gists_url": "https://api.github.com/users/fecet/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fecet",
                "id": 41792945,
                "login": "fecet",
                "node_id": "MDQ6VXNlcjQxNzkyOTQ1",
                "organizations_url": "https://api.github.com/users/fecet/orgs",
                "received_events_url": "https://api.github.com/users/fecet/received_events",
                "repos_url": "https://api.github.com/users/fecet/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fecet/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fecet/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fecet",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@fecet Thanks for the tip. I'm trying it out.",
            "created_at": "2023-07-19T20:46:47Z",
            "html_url": "https://github.com/neovim/neovim/issues/23918#issuecomment-1642733151",
            "id": 1642733151,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23918",
            "node_id": "IC_kwDOAPphoM5h6h5f",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642733151/reactions"
            },
            "updated_at": "2023-07-19T20:46:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642733151",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/12980409?v=4",
                "events_url": "https://api.github.com/users/kiyoon/events{/privacy}",
                "followers_url": "https://api.github.com/users/kiyoon/followers",
                "following_url": "https://api.github.com/users/kiyoon/following{/other_user}",
                "gists_url": "https://api.github.com/users/kiyoon/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kiyoon",
                "id": 12980409,
                "login": "kiyoon",
                "node_id": "MDQ6VXNlcjEyOTgwNDA5",
                "organizations_url": "https://api.github.com/users/kiyoon/orgs",
                "received_events_url": "https://api.github.com/users/kiyoon/received_events",
                "repos_url": "https://api.github.com/users/kiyoon/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kiyoon/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kiyoon/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kiyoon",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Closing as stale. Will reopen if still an issue.",
            "created_at": "2024-12-16T16:54:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/23918#issuecomment-2546149223",
            "id": 2546149223,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23918",
            "node_id": "IC_kwDOAPphoM6Xwydn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2546149223/reactions"
            },
            "updated_at": "2024-12-16T16:54:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2546149223",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/23918/comments",
    "created_at": "2023-06-05T13:19:15Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/23918/events",
    "html_url": "https://github.com/neovim/neovim/issues/23918",
    "id": 1741771509,
    "labels": [
        {
            "color": "FEF2C0",
            "default": false,
            "description": "performance, latency, cpu/memory usage",
            "id": 101930601,
            "name": "performance",
            "node_id": "MDU6TGFiZWwxMDE5MzA2MDE=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/performance"
        },
        {
            "color": "f9d0c4",
            "default": false,
            "description": "wrong behavior that was introduced in a previous commit (please bisect)",
            "id": 619474658,
            "name": "bug-regression",
            "node_id": "MDU6TGFiZWw2MTk0NzQ2NTg=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-regression"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue has been tracked to a specific commit",
            "id": 1481421490,
            "name": "has:bisected",
            "node_id": "MDU6TGFiZWwxNDgxNDIxNDkw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:bisected"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1799626557,
            "name": "treesitter",
            "node_id": "MDU6TGFiZWwxNzk5NjI2NTU3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/treesitter"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/23918/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5n0VL1",
    "number": 23918,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 5,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 5,
        "url": "https://api.github.com/repos/neovim/neovim/issues/23918/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/23918/timeline",
    "title": "Treesitter being slow on nvim-0.9.1. Noticeable with some plugins.",
    "updated_at": "2024-12-16T16:54:40Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/23918",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/12980409?v=4",
        "events_url": "https://api.github.com/users/kiyoon/events{/privacy}",
        "followers_url": "https://api.github.com/users/kiyoon/followers",
        "following_url": "https://api.github.com/users/kiyoon/following{/other_user}",
        "gists_url": "https://api.github.com/users/kiyoon/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/kiyoon",
        "id": 12980409,
        "login": "kiyoon",
        "node_id": "MDQ6VXNlcjEyOTgwNDA5",
        "organizations_url": "https://api.github.com/users/kiyoon/orgs",
        "received_events_url": "https://api.github.com/users/kiyoon/received_events",
        "repos_url": "https://api.github.com/users/kiyoon/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/kiyoon/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/kiyoon/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/kiyoon",
        "user_view_type": "public"
    }
}