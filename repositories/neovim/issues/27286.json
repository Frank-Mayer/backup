{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nThis issue is similar to https://github.com/neovim/neovim/issues/25365, but for the `alternate-file`. I previously opened this as a \"feature request\" issue but was told it fits more the \"bug report\" issue.\r\n\r\nIt often happens that when deleting a buffer (with `:bd`), say `file1`, that buffer is just unlisted and \"invisibly\" stays the `alternate-file` for another buffer `file2`. When `file2` is active, pressing `Ctrl-^` will make neovim attempt to re-open `file1`.\r\n\r\nProblems:\r\n- some buffers can't be reloaded\r\n- typically, a buffer was deleted for a reason, so it's unlikely that someone would use the `Ctrl-^` command with the intention to reload that buffer (although in certain scenarios this could be a valid use case)\r\n\r\nIf instead one doesn't just delete the buffer, but wipes it with `:bw`, then doing `Ctrl-^` as above, one gets the error \"E23: No alternate file\".\n\n### Steps to reproduce\n\n`nvim --clean file1`\r\n`:e file2`\r\n`:e file3`\r\nNow, `file3` is active, and `file2` is the `alternate-file`.\r\n`:bd2` to close `file2`, and the active buffer is still `file3`.\r\npress `Ctrl-^`\r\nNow, `file2` is loaded again even though it was just deleted.\n\n### Expected behavior\n\nI believe that for most use-cases, it would be practical that when deleting/wiping a buffer, another buffer predictably becomes the alternate buffer. The most obvious candidate would be closest other listed buffer in the `jumplist`.\n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0-dev-2250+g6bba4bece\n\n### Vim (not Nvim) behaves the same?\n\nno, vim 8.2\n\n### Operating system/version\n\nUbuntu 22.04\n\n### Terminal name/version\n\nkonsole 23.08.4\n\n### $TERM environment variable\n\ntmux-256color\n\n### Installation\n\nappimage (nightly)",
    "closed_at": "2024-02-01T14:10:27Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> I believe that for most use-cases, it would be practical that when deleting/wiping a buffer, another buffer predictably becomes the alternate buffer. The most obvious candidate would be closest other listed buffer in the `jumplist`.\r\n\r\nI don't think this makes sense. Alternate file is not jumplist and there is no such thing as \"another buffer predictably becomes the alternate buffer\".",
            "created_at": "2024-02-01T14:10:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/27286#issuecomment-1921417842",
            "id": 1921417842,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27286",
            "node_id": "IC_kwDOAPphoM5yhoJy",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921417842/reactions"
            },
            "updated_at": "2024-02-01T14:14:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921417842",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This is how it's supposed to work, and does work like that on Vim 9.1.",
            "created_at": "2024-02-01T14:20:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/27286#issuecomment-1921449133",
            "id": 1921449133,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27286",
            "node_id": "IC_kwDOAPphoM5yhvyt",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921449133/reactions"
            },
            "updated_at": "2024-02-01T14:20:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921449133",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7416158?v=4",
                "events_url": "https://api.github.com/users/craigmac/events{/privacy}",
                "followers_url": "https://api.github.com/users/craigmac/followers",
                "following_url": "https://api.github.com/users/craigmac/following{/other_user}",
                "gists_url": "https://api.github.com/users/craigmac/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/craigmac",
                "id": 7416158,
                "login": "craigmac",
                "node_id": "MDQ6VXNlcjc0MTYxNTg=",
                "organizations_url": "https://api.github.com/users/craigmac/orgs",
                "received_events_url": "https://api.github.com/users/craigmac/received_events",
                "repos_url": "https://api.github.com/users/craigmac/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/craigmac/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/craigmac/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/craigmac"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "It is true that vim works the same way, but I didn't see this behavior of reloading deleted buffers documented, neither at the docs for `Ctrl-^` nor `alternate-file`.\r\nSo AFAICT, this is undocumented behavior that also doesn't make much sense (especially trying to load non-loadable ephemeral buffers!). Even if my proposed solution is not liked, I think the issue itself persists.",
            "created_at": "2024-02-01T14:42:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/27286#issuecomment-1921493785",
            "id": 1921493785,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27286",
            "node_id": "IC_kwDOAPphoM5yh6sZ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921493785/reactions"
            },
            "updated_at": "2024-02-01T14:42:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921493785",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10359335?v=4",
                "events_url": "https://api.github.com/users/Maltimore/events{/privacy}",
                "followers_url": "https://api.github.com/users/Maltimore/followers",
                "following_url": "https://api.github.com/users/Maltimore/following{/other_user}",
                "gists_url": "https://api.github.com/users/Maltimore/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Maltimore",
                "id": 10359335,
                "login": "Maltimore",
                "node_id": "MDQ6VXNlcjEwMzU5MzM1",
                "organizations_url": "https://api.github.com/users/Maltimore/orgs",
                "received_events_url": "https://api.github.com/users/Maltimore/received_events",
                "repos_url": "https://api.github.com/users/Maltimore/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Maltimore/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Maltimore/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Maltimore"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@Maltimore You might be able to script something that does what you want by combining a `BufDelete` autocommand and setting the `@#` register. But I don't think the default behavior here is going to change. Some people like and want this behavior and may depend on it (seeing as it's been around since the beginning).",
            "created_at": "2024-02-01T15:44:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/27286#issuecomment-1921624906",
            "id": 1921624906,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27286",
            "node_id": "IC_kwDOAPphoM5yiatK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921624906/reactions"
            },
            "updated_at": "2024-02-01T15:44:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1921624906",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thanks @gpanders! I'll see if I can come up with something and post it here if so, so others who find this issue can use it as well.",
            "created_at": "2024-02-01T21:12:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/27286#issuecomment-1922253883",
            "id": 1922253883,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27286",
            "node_id": "IC_kwDOAPphoM5yk0Q7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1922253883/reactions"
            },
            "updated_at": "2024-02-01T21:12:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1922253883",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10359335?v=4",
                "events_url": "https://api.github.com/users/Maltimore/events{/privacy}",
                "followers_url": "https://api.github.com/users/Maltimore/followers",
                "following_url": "https://api.github.com/users/Maltimore/following{/other_user}",
                "gists_url": "https://api.github.com/users/Maltimore/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Maltimore",
                "id": 10359335,
                "login": "Maltimore",
                "node_id": "MDQ6VXNlcjEwMzU5MzM1",
                "organizations_url": "https://api.github.com/users/Maltimore/orgs",
                "received_events_url": "https://api.github.com/users/Maltimore/received_events",
                "repos_url": "https://api.github.com/users/Maltimore/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Maltimore/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Maltimore/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Maltimore"
            }
        },
        {
            "author_association": "NONE",
            "body": "I use alternate file a lot. In order to open recent active buffer, I do this:\r\n\r\n## Code\r\n\r\n```lua\r\n-- Initialize the buffer history table\r\nlocal buffer_history = {}\r\n\r\n-- Function to update buffer history\r\nlocal function update_buffer_history()\r\n  local current_buf = vim.api.nvim_get_current_buf()\r\n  -- Remove current buffer if it's already in the history to prevent duplicates\r\n  for i, buf in ipairs(buffer_history) do\r\n    if buf == current_buf then\r\n      table.remove(buffer_history, i)\r\n      break\r\n    end\r\n  end\r\n  -- Insert current buffer at the start of the list\r\n  table.insert(buffer_history, 1, current_buf)\r\nend\r\n\r\n-- Attach the update function to the BufEnter event\r\nvim.api.nvim_create_autocmd('BufEnter', {\r\n  callback = update_buffer_history,\r\n})\r\n\r\n-- Function to switch to the last available buffer\r\nlocal function switch_to_last_available_buffer()\r\n  local current_buf = vim.api.nvim_get_current_buf()\r\n  for i = 2, #buffer_history do\r\n    local buf = buffer_history[i]\r\n    if vim.api.nvim_buf_is_loaded(buf) and buf ~= current_buf then\r\n      vim.api.nvim_set_current_buf(buf)\r\n      return\r\n    end\r\n  end\r\n  print 'No suitable alternate buffer found'\r\nend\r\n\r\n-- Map Ctrl-^\r\nvim.keymap.set('n', '<C-^>', '', { noremap = true, callback = switch_to_last_available_buffer })\r\n```\r\n\r\n## Explanation:\r\n\r\n- Global Buffer History: When Neovim starts, it initializes a global list `g:buffer_history` to track buffers based on your usage.\r\n- Update Logic: Every time you enter a buffer, it's added to the front of this list, ensuring the most recently used buffer is always at the front, after the current one.\r\n- Switching Function: `SwitchToLastAvailableBuffer` checks this list to find the first buffer that is still open (and not the current buffer) to switch to.\r\n- Mapping: It remaps `Ctrl-^` to use this new function, overriding the default behavior that can lead to attempting to switch to a closed buffer.\r\n\r\n---\r\n\r\nMaybe this approach is not that beautiful, but for me it get the job done. \r\nI hope it help you, @Maltimore",
            "created_at": "2024-06-28T01:08:33Z",
            "html_url": "https://github.com/neovim/neovim/issues/27286#issuecomment-2195909477",
            "id": 2195909477,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27286",
            "node_id": "IC_kwDOAPphoM6C4utl",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2195909477/reactions"
            },
            "updated_at": "2024-06-28T01:11:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2195909477",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/50038157?v=4",
                "events_url": "https://api.github.com/users/alfariiizi/events{/privacy}",
                "followers_url": "https://api.github.com/users/alfariiizi/followers",
                "following_url": "https://api.github.com/users/alfariiizi/following{/other_user}",
                "gists_url": "https://api.github.com/users/alfariiizi/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/alfariiizi",
                "id": 50038157,
                "login": "alfariiizi",
                "node_id": "MDQ6VXNlcjUwMDM4MTU3",
                "organizations_url": "https://api.github.com/users/alfariiizi/orgs",
                "received_events_url": "https://api.github.com/users/alfariiizi/received_events",
                "repos_url": "https://api.github.com/users/alfariiizi/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/alfariiizi/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/alfariiizi/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/alfariiizi"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27286/comments",
    "created_at": "2024-02-01T14:05:36Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27286/events",
    "html_url": "https://github.com/neovim/neovim/issues/27286",
    "id": 2112605630,
    "labels": [
        {
            "color": "e6e6e6",
            "default": false,
            "description": "current behavior is by design, and change is not desired",
            "id": 77997479,
            "name": "closed:wontfix",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3OQ==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/closed:wontfix"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27286/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM59682-",
    "number": 27286,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27286/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27286/timeline",
    "title": "`Ctrl-^` (`alternate-file` buffer) behaves unintuitively when deleting buffers",
    "updated_at": "2024-06-28T01:11:48Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27286",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/10359335?v=4",
        "events_url": "https://api.github.com/users/Maltimore/events{/privacy}",
        "followers_url": "https://api.github.com/users/Maltimore/followers",
        "following_url": "https://api.github.com/users/Maltimore/following{/other_user}",
        "gists_url": "https://api.github.com/users/Maltimore/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Maltimore",
        "id": 10359335,
        "login": "Maltimore",
        "node_id": "MDQ6VXNlcjEwMzU5MzM1",
        "organizations_url": "https://api.github.com/users/Maltimore/orgs",
        "received_events_url": "https://api.github.com/users/Maltimore/received_events",
        "repos_url": "https://api.github.com/users/Maltimore/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Maltimore/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Maltimore/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Maltimore"
    }
}