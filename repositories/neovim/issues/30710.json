{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nI checked the docs and searched online, but as far as I know, `vim.lsp.buf.code_action()` does not currently offer a way to customize the actions shown in the menu. Allowing customization could be useful in cases where there are many available actions or actions with similar wordings, and adding the name of the language server that is offering the action can help select the correct option.\n\nSorry in advance if this feature already exists but I was not able to find anything related to it.\n\n### Expected behavior\n\nAllow a way to customize `vim.lsp.buf.code_action()` to show the name of the language servers",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "+1 for more customization/configuration points within neovim core -- without relying on custom `vim.ui.select` too much.\n\nBut this is possible if you override `vim.ui.select`, as the code action entry items passed to `vim.ui.select()` already contains the context information, containing the id of the LSP client (via `item.ctx.client_id`.\n\nIf you use some cool plugins like https://github.com/stevearc/dressing.nvim, the feature you're specifically looking for is already there out-of-box (when using a telescope backend):\n\n<img src=\"https://github.com/user-attachments/assets/bb19d082-299b-4848-9d69-33f4f74fa026\" width=600 />\n",
            "created_at": "2024-10-07T19:35:12Z",
            "html_url": "https://github.com/neovim/neovim/issues/30710#issuecomment-2397730861",
            "id": 2397730861,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30710",
            "node_id": "IC_kwDOAPphoM6O6ngt",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2397730861/reactions"
            },
            "updated_at": "2024-10-07T19:36:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2397730861",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1009873?v=4",
                "events_url": "https://api.github.com/users/wookayin/events{/privacy}",
                "followers_url": "https://api.github.com/users/wookayin/followers",
                "following_url": "https://api.github.com/users/wookayin/following{/other_user}",
                "gists_url": "https://api.github.com/users/wookayin/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/wookayin",
                "id": 1009873,
                "login": "wookayin",
                "node_id": "MDQ6VXNlcjEwMDk4NzM=",
                "organizations_url": "https://api.github.com/users/wookayin/orgs",
                "received_events_url": "https://api.github.com/users/wookayin/received_events",
                "repos_url": "https://api.github.com/users/wookayin/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/wookayin/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/wookayin/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/wookayin"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> customize `vim.lsp.buf.code_action()` to show the name of the language servers\n\nWhy don't we do this by default? Seems like a reasonable default behavior.",
            "created_at": "2024-10-09T11:38:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/30710#issuecomment-2402078329",
            "id": 2402078329,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30710",
            "node_id": "IC_kwDOAPphoM6PLM55",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2402078329/reactions"
            },
            "updated_at": "2024-10-09T11:38:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2402078329",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "@wookayin thanks for pointing me to override `vim.ui.select`, this is the implementation I ended up with:\n\n```lua\nlocal original_vim_ui_select = vim.ui.select\n---@diagnostic disable-next-line: duplicate-set-field\nvim.ui.select = function(items, select_opts, on_choice)\n    if select_opts.kind ~= \"codeaction\" then\n        return original_vim_ui_select(\n            items,\n            select_opts,\n            on_choice\n        )\n    end\n\n    -- original fn: https://github.com/neovim/neovim/blob/release-0.10/runtime/lua/vim/lsp/buf.lua#L812\n    ---@param item {action: lsp.Command|lsp.CodeAction}\n    select_opts.format_item = function(item)\n        local formatted = item.action.title\n            :gsub(\"\\r\\n\", \"\\\\r\\\\n\")\n            :gsub(\"\\n\", \"\\\\n\")\n\n        local client_id = item.ctx and item.ctx.client_id\n        if client_id then\n            local action_client =\n                vim.lsp.get_client_by_id(client_id)\n            local source_name = action_client\n                    and action_client.name\n                or \"unknown\"\n\n            formatted = formatted .. \" [\" .. source_name .. \"]\"\n        end\n\n        return formatted\n    end\n\n    original_vim_ui_select(items, select_opts, on_choice)\nend\n```\n\nI tried to call the original `format_item` but I was getting a stack overflow error, not sure why",
            "created_at": "2024-10-11T22:32:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/30710#issuecomment-2408199222",
            "id": 2408199222,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30710",
            "node_id": "IC_kwDOAPphoM6PijQ2",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2408199222/reactions"
            },
            "updated_at": "2024-10-11T22:33:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2408199222",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6783539?v=4",
                "events_url": "https://api.github.com/users/piedrahitapablo/events{/privacy}",
                "followers_url": "https://api.github.com/users/piedrahitapablo/followers",
                "following_url": "https://api.github.com/users/piedrahitapablo/following{/other_user}",
                "gists_url": "https://api.github.com/users/piedrahitapablo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/piedrahitapablo",
                "id": 6783539,
                "login": "piedrahitapablo",
                "node_id": "MDQ6VXNlcjY3ODM1Mzk=",
                "organizations_url": "https://api.github.com/users/piedrahitapablo/orgs",
                "received_events_url": "https://api.github.com/users/piedrahitapablo/received_events",
                "repos_url": "https://api.github.com/users/piedrahitapablo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/piedrahitapablo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/piedrahitapablo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/piedrahitapablo"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/30710/comments",
    "created_at": "2024-10-07T15:18:38Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/30710/events",
    "html_url": "https://github.com/neovim/neovim/issues/30710",
    "id": 2570762402,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "needs a clear design proposal",
            "id": 124510010,
            "name": "needs:design",
            "node_id": "MDU6TGFiZWwxMjQ1MTAwMTA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:design"
        },
        {
            "color": "BFDADC",
            "default": false,
            "description": "Low-risk, self-contained. Do NOT ask \"can I work on this\", just read CONTRIBUTING.md",
            "id": 407246773,
            "name": "complexity:low",
            "node_id": "MDU6TGFiZWw0MDcyNDY3NzM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/complexity:low"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/30710/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 246,
        "created_at": "2014-11-26T22:13:11Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "We don't plan to work on this, but will accept high quality contributions from someone who will own the feature and follow up on bug reports.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/9",
        "id": 881978,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/9/labels",
        "node_id": "MDk6TWlsZXN0b25lODgxOTc4",
        "number": 9,
        "open_issues": 267,
        "state": "open",
        "title": "needs-owner",
        "updated_at": "2024-10-14T19:27:30Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/9"
    },
    "node_id": "I_kwDOAPphoM6ZOrii",
    "number": 30710,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/30710/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/30710/timeline",
    "title": "LSP: vim.lsp.buf.code_action() option to show name of the language server providing the action",
    "updated_at": "2024-10-12T22:50:25Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/30710",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/6783539?v=4",
        "events_url": "https://api.github.com/users/piedrahitapablo/events{/privacy}",
        "followers_url": "https://api.github.com/users/piedrahitapablo/followers",
        "following_url": "https://api.github.com/users/piedrahitapablo/following{/other_user}",
        "gists_url": "https://api.github.com/users/piedrahitapablo/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/piedrahitapablo",
        "id": 6783539,
        "login": "piedrahitapablo",
        "node_id": "MDQ6VXNlcjY3ODM1Mzk=",
        "organizations_url": "https://api.github.com/users/piedrahitapablo/orgs",
        "received_events_url": "https://api.github.com/users/piedrahitapablo/received_events",
        "repos_url": "https://api.github.com/users/piedrahitapablo/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/piedrahitapablo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/piedrahitapablo/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/piedrahitapablo"
    }
}