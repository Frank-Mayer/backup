{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Neovim Version\r\n```\r\nNVIM v0.6.0-dev+112-ge7bde44d6\r\nBuild type: Release\r\nLuaJIT 2.1.0-beta3\r\nCompilation: /Library/Developer/CommandLineTools/usr/bin/cc -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1 -DNVIM_TS_HAS_SET_MATCH_LIMIT -O2 -DNDEBUG -Wall -Wextra -pedantic -Wno-unused-parameter -Wstrict-prototypes -std=gnu99 -Wshadow -Wconversion -Wmissing-prototypes -Wimplicit-fallthrough -Wvla -fstack-protector-strong -fno-common -fdiagnostics-color=always -DINCLUDE_GENERATED_DECLARATIONS -D_GNU_SOURCE -DNVIM_MSGPACK_HAS_FLOAT32 -DNVIM_UNIBI_HAS_VAR_FROM -DMIN_LOG_LEVEL=3 -I/Users/dhruvmanilawala/contributing/neovim/build/config -I/Users/dhruvmanilawala/contributing/neovim/src -I/Users/dhruvmanilawala/contributing/neovim/.deps/usr/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX11.3.sdk/usr/include -I/usr/local/opt/gettext/include -I/Users/dhruvmanilawala/contributing/neovim/build/src/nvim/auto -I/Users/dhruvmanilawala/contributing/neovim/build/include\r\nCompiled by dhruvmanilawala@mbp\r\n\r\nFeatures: +acl +iconv +tui\r\nSee \":help feature-compile\"\r\n\r\n   system vimrc file: \"$VIM/sysinit.vim\"\r\n  fall-back for $VIM: \"/Users/dhruvmanilawala/neovim/share/nvim\"\r\n\r\nRun :checkhealth for more info\r\n```\r\n\r\n### Operating system/version:\r\n\r\nmacOS Big Sur 11.3\r\n\r\n### Terminal name/version:\r\n\r\nkitty 0.22.2 created by Kovid Goyal\r\n\r\n### TERM environment variable\r\n\r\nxterm-kitty\r\n\r\n### Installation\r\n\r\nbuilt from repo\r\n\r\n### Steps to reproduce\r\n\r\nUsing the below `minimal.vim`:\r\n```vim\r\nset nocompatible hidden laststatus=2\r\nmap Q <nop>\r\n\r\nset cursorline\r\n\r\naugroup testing_focus_events_in_terminal\r\n  autocmd!\r\n  \" Here, when the focus is gained back, the cursorline is set but the cursor\r\n  \" itself disappears.\r\n  autocmd FocusGained * set cursorline\r\n  autocmd FocusLost * set nocursorline\r\naugroup END\r\n```\r\n\r\n1. Start Neovim with `nvim -u minimal.vim --noplugin`\r\n2. Open terminal with `:terminal` and go to terminal (insert) mode\r\n3. Move to another OS/terminal window, thus triggering the `FocusLost` event\r\n4. Move back to Neovim, thus triggering the `FocusGained` event\r\n\r\nHere, the cursorline is set, but the cursor itself disappears.\r\n\r\n\r\n\r\n### Vim\r\n\r\nIn Vim, the cursorline is not ~set~ displayed in the terminal.\r\n\r\n```\r\nVIM - Vi IMproved 8.2 (2019 Dec 12, compiled Aug 02 2021 17:10:38)\r\nmacOS version - x86_64\r\nIncluded patches: 1-3275\r\nCompiled by Homebrew\r\nHuge version without GUI.  Features included (+) or not (-):\r\n+acl               +file_in_path      +mouse_urxvt       -tag_any_white\r\n+arabic            +find_in_path      +mouse_xterm       -tcl\r\n+autocmd           +float             +multi_byte        +termguicolors\r\n+autochdir         +folding           +multi_lang        +terminal\r\n-autoservername    -footer            -mzscheme          +terminfo\r\n-balloon_eval      +fork()            +netbeans_intg     +termresponse\r\n+balloon_eval_term +gettext           +num64             +textobjects\r\n-browse            -hangul_input      +packages          +textprop\r\n++builtin_terms    +iconv             +path_extra        +timers\r\n+byte_offset       +insert_expand     +perl              +title\r\n+channel           +ipv6              +persistent_undo   -toolbar\r\n+cindent           +job               +popupwin          +user_commands\r\n-clientserver      +jumplist          +postscript        +vartabs\r\n+clipboard         +keymap            +printer           +vertsplit\r\n+cmdline_compl     +lambda            +profile           +virtualedit\r\n+cmdline_hist      +langmap           -python            +visual\r\n+cmdline_info      +libcall           +python3           +visualextra\r\n+comments          +linebreak         +quickfix          +viminfo\r\n+conceal           +lispindent        +reltime           +vreplace\r\n+cryptv            +listcmds          +rightleft         +wildignore\r\n+cscope            +localmap          +ruby              +wildmenu\r\n+cursorbind        +lua               +scrollbind        +windows\r\n+cursorshape       +menu              +signs             +writebackup\r\n+dialog_con        +mksession         +smartindent       -X11\r\n+diff              +modify_fname      -sodium            -xfontset\r\n+digraphs          +mouse             -sound             -xim\r\n-dnd               -mouseshape        +spell             -xpm\r\n-ebcdic            +mouse_dec         +startuptime       -xsmp\r\n+emacs_tags        -mouse_gpm         +statusline        -xterm_clipboard\r\n+eval              -mouse_jsbterm     -sun_workshop      -xterm_save\r\n+ex_extra          +mouse_netterm     +syntax            \r\n+extra_search      +mouse_sgr         +tag_binary        \r\n-farsi             -mouse_sysmouse    -tag_old_static    \r\n   system vimrc file: \"$VIM/vimrc\"\r\n     user vimrc file: \"$HOME/.vimrc\"\r\n 2nd user vimrc file: \"~/.vim/vimrc\"\r\n      user exrc file: \"$HOME/.exrc\"\r\n       defaults file: \"$VIMRUNTIME/defaults.vim\"\r\n  fall-back for $VIM: \"/usr/local/share/vim\"\r\nCompilation: clang -c -I. -Iproto -DHAVE_CONFIG_H -DMACOS_X -DMACOS_X_DARWIN -g -O2 -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1 \r\nLinking: clang -L. -fstack-protector-strong -L/usr/local/lib -L/usr/local/opt/libyaml/lib -L/usr/local/opt/openssl@1.1/lib -L/usr/local/opt/readline/lib -L/usr/local/lib -o vim -lm -lncurses -liconv -lintl -framework AppKit -L/usr/local/opt/lua/lib -llua5.4 -mmacosx-version-min=11.3 -fstack-protector-strong -L/usr/local/lib -L/usr/local/Cellar/perl/5.34.0/lib/perl5/5.34.0/darwin-thread-multi-2level/CORE -lperl -L/usr/local/opt/python@3.9/Frameworks/Python.framework/Versions/3.9/lib/python3.9/config-3.9-darwin -lpython3.9 -framework CoreFoundation -lruby.3.0 -L/usr/local/Cellar/ruby/3.0.2/lib \r\n\r\n```\r\n\r\n### Expected behavior\r\n\r\nI don't know the inner workings of Vim but it does not set the cursorline while in terminal mode.\r\n\r\n1. Start Vim with `vim -u minimal.vim --noplugin`\r\n2. Open terminal with `:terminal` and go to terminal (insert) mode\r\n3. Press <kbd>C-w</kbd> (`termwinkey`) and `:set cursorline?`\r\n\r\nYou will see that the cursorline is set but it is not shown.\r\n\r\n\r\n### Actual behavior\r\n\r\n### In Neovim terminal:\r\n\r\n_State after step 2_\r\n![Screenshot 2021-08-13 at 10 56 03](https://user-images.githubusercontent.com/67177269/129309181-af123fe3-84d8-446a-801d-2683ecb9c7bd.png)\r\n\r\n_State after step 4_\r\n![Screenshot 2021-08-13 at 10 56 12](https://user-images.githubusercontent.com/67177269/129309195-acfce2b4-c43e-4ae7-aefc-92274fb602e6.png)\r\n",
    "closed_at": "2024-09-20T21:43:02Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "In v0.6 and above the steps to reproduce are a bit different:\r\n```vim\r\nset nocompatible hidden laststatus=2\r\n\r\nset cursorline\r\n\r\naugroup testing_focus_events_in_terminal\r\n  autocmd!\r\n  \" Here, when the focus is gained back, the cursorline is set but the cursor\r\n  \" itself disappears.\r\n  autocmd FocusGained * set cursorline cursorlineopt=line\r\n  autocmd FocusLost * set nocursorline\r\naugroup END\r\n```",
            "created_at": "2022-03-25T08:25:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/15355#issuecomment-1078772963",
            "id": 1078772963,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/15355",
            "node_id": "IC_kwDOAPphoM5ATMTj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1078772963/reactions"
            },
            "updated_at": "2022-03-25T08:25:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1078772963",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "With #27893 'cursorline' highlight is still shown in terminal mode, but cursor highlight no longer disappears.",
            "created_at": "2024-03-17T09:29:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/15355#issuecomment-2002378549",
            "id": 2002378549,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/15355",
            "node_id": "IC_kwDOAPphoM53Wd81",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002378549/reactions"
            },
            "updated_at": "2024-03-17T09:29:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002378549",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> 'cursorline' highlight is still shown in terminal mode\r\n\r\ntesting 84e85aeb10ae, cursorline no longer appears in terminal-mode. Though I don't see why it should be any different than regular insert-mode...",
            "created_at": "2024-09-20T21:43:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/15355#issuecomment-2364657484",
            "id": 2364657484,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/15355",
            "node_id": "IC_kwDOAPphoM6M8c9M",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2364657484/reactions"
            },
            "updated_at": "2024-09-20T21:43:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2364657484",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/15355/comments",
    "created_at": "2021-08-13T05:48:07Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/15355/events",
    "html_url": "https://github.com/neovim/neovim/issues/15355",
    "id": 970082643,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "built-in :terminal or :shell",
            "id": 212696822,
            "name": "terminal",
            "node_id": "MDU6TGFiZWwyMTI2OTY4MjI=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/terminal"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1786207367,
            "name": "highlight",
            "node_id": "MDU6TGFiZWwxNzg2MjA3MzY3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/highlight"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/15355/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU5NzAwODI2NDM=",
    "number": 15355,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/15355/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/15355/timeline",
    "title": "Cursor disappears when setting `cursorline` on `FocusGained` in the terminal",
    "updated_at": "2024-09-20T21:43:30Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/15355",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/67177269?v=4",
        "events_url": "https://api.github.com/users/dhruvmanila/events{/privacy}",
        "followers_url": "https://api.github.com/users/dhruvmanila/followers",
        "following_url": "https://api.github.com/users/dhruvmanila/following{/other_user}",
        "gists_url": "https://api.github.com/users/dhruvmanila/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/dhruvmanila",
        "id": 67177269,
        "login": "dhruvmanila",
        "node_id": "MDQ6VXNlcjY3MTc3MjY5",
        "organizations_url": "https://api.github.com/users/dhruvmanila/orgs",
        "received_events_url": "https://api.github.com/users/dhruvmanila/received_events",
        "repos_url": "https://api.github.com/users/dhruvmanila/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/dhruvmanila/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dhruvmanila/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/dhruvmanila"
    }
}