{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "The Neovim options code is an incomprehensible mess filled with code duplication, special logic for every option, multiple code paths for the same thing, lack of generalization, etc. This makes Neovim options difficult to maintain, and even more difficult to extend, which has been a blocker towards the addition of new option types (e.g. Callback, Array, Dictionary).\n\nThis is a roadmap for refactoring Neovim options to be more extensible and maintainable. This is not an absolutely concrete roadmap and each item is subject to change, further additions and deletions may also be made at any time.\n\n- [ ] Unify interfaces for options.\n  - [x] Implement a single type to represent any option value. #23850\n  - [x] Unify `do_set_option_value` and `set_option_value` codepaths. #25394\n  - [ ] Unify interfaces for number, boolean and string options.\n    - [x] Unify interfaces for setting number and boolean options. #25394\n    - [x] Unify interfaces for setting number/boolean and string options. #25674\n    - [x] Unify separate interfaces for setting string options (e.g. `set_string_option_direct`, `set_string_option_global`, etc.). #26970\n    - [ ] Remove functions specific to string options (e.g. `free_string_option`, `clear_string_option`, `check_string_option`) and replace them with something more general.\n    - [x] Unify `put_set(num|bool|string)`. #30993\n    - [x] Use `OptVal` for option `def_val`. #26691 \n  - [ ] Unify `get_option_value` and `get_option_value_strict` if possible. #30974\n  - [ ] Use a struct for option variables and make it so that the option index can be used to directly access the variable, instead of having to manually hardcode a variable for each option.\n  - [x] Replace `p_force_on` and `p_force_off` with an `immutable` property for options. #26209\n  - [ ] Unify interfaces for handling TTY options by giving TTY options an option index and also turning some TTY options into immutable options.\n  - [ ] Unify `enable_if = false`, `immutable` and `hidden` into just `immutable. #28400\n- [x] Replace option flag macros with enum values. #30961\n- [x] Remove `P_ALLOCED` and always allocate option values. #30917\n- [x] Check if `OPT_FREE` is necessary and remove it if it isn't. #26963\n- [x] Refactor `set_option_default`.  #26691\n- [ ] Remove logic for platform-specific options (`shellslash` / `completeslash`). #28400\n- [ ] Autogenerate option variables.\n  - [ ] Global option variables\n  - [ ] Buffer/window option variables\n  - [ ] Option flags\n  - [ ] Make it possible to directly access an option's variable at any scope through the option's index, perhaps by autogenerating `get_varp` and `get_varp_scope`.\n  - [ ] Remove `.indir` and `PV_*` macros if possible. #31066\n- [ ] Use a separate option type (`kOptValTypeUnset`?) to indicate an unset local value for a global-local option, instead of using arbitrary values for each option. This also would mean that boolean options no longer need to be represented using tri-states and instead can be actual booleans.\n- [ ] Use `bool` type for boolean option variables, instead of `int`.\n- [ ] Revamp option scopes. #29314\n  - [ ] Allow options to support an arbitrary amount of scopes. #31066\n  - [ ] Remove `OPT_LOCAL` and `OPT_GLOBAL`\n- [ ] Move option callbacks to separate file.\n  - [ ] Move option callbacks from `option.c` to separate file. #30996\n  - [ ] Move option and expand callbacks from `optionstr.c` to a separate file and remove `optionstr.c` if possible.\n- [ ] Use reference counted strings for string options.\n- [ ] Remove `empty_string_option`.\n- [ ] Allow options to have multiple types.\n  - [x] Replace `P_(NUM|BOOL|STRING)` flags with `kOptValType*` flags and move type flags to a separate variable from other option flags. #26512\n- [ ] Fix the behavior of `winbar` and make it possible to unset winbar for a single window. #18660\n- [ ] Convert `kOptFlagFunc` to a separate option type for callback options, instead of having them be shoehorned into string options.\n- [ ] Add support for Array and Dictionary options.\n- [ ] Convert all list-like or map-like string options to Array / Dictionary options.\n- [ ] Add a dict-based configuration format for complicated options such as `winbar`, `tabline`, `statusline`, etc.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25672/comments",
    "created_at": "2023-10-16T17:51:46Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25672/events",
    "html_url": "https://github.com/neovim/neovim/issues/25672",
    "id": 1945777384,
    "labels": [
        {
            "color": "C5DEF5",
            "default": false,
            "description": "changes that are not features or bugfixes",
            "id": 106949155,
            "name": "refactor",
            "node_id": "MDU6TGFiZWwxMDY5NDkxNTU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/refactor"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "configuration, settings",
            "id": 4242493821,
            "name": "options",
            "node_id": "LA_kwDOAPphoM7831F9",
            "url": "https://api.github.com/repos/neovim/neovim/labels/options"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25672/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5z-jTo",
    "number": 25672,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 15,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 3,
        "hooray": 0,
        "laugh": 0,
        "rocket": 12,
        "total_count": 30,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25672/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25672/timeline",
    "title": "Options refactor roadmap",
    "updated_at": "2024-11-04T22:09:43Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25672",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/29580810?v=4",
        "events_url": "https://api.github.com/users/famiu/events{/privacy}",
        "followers_url": "https://api.github.com/users/famiu/followers",
        "following_url": "https://api.github.com/users/famiu/following{/other_user}",
        "gists_url": "https://api.github.com/users/famiu/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/famiu",
        "id": 29580810,
        "login": "famiu",
        "node_id": "MDQ6VXNlcjI5NTgwODEw",
        "organizations_url": "https://api.github.com/users/famiu/orgs",
        "received_events_url": "https://api.github.com/users/famiu/received_events",
        "repos_url": "https://api.github.com/users/famiu/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/famiu/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/famiu/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/famiu",
        "user_view_type": "public"
    }
}