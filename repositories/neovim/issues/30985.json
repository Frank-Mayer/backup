{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\neditor is being interrupted with message `rust_analyzer: -32802: server cancelled the request` while typing on every keystroke after the latest updates of rust-analyzer\n\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\n\nJust start typing in `main.rs` inside `fn main() {|}` of `cargo new --bin test_project`\n\n```lua\nlocal pattern = 'rust'\nlocal cmd = { '/opt/homebrew/bin/rust-analyzer' }\n-- Add files/folders here that indicate the root of a project\nlocal root_markers = { 'Cargo.toml' }\n-- Change to table with settings if required\nlocal settings = vim.empty_dict()\n\nvim.api.nvim_create_autocmd('FileType', {\n    pattern = pattern,\n    callback = function(args)\n        local match = vim.fs.find(root_markers, { path = args.file, upward = true })[1]\n        local root_dir = match and vim.fn.fnamemodify(match, ':p:h') or nil\n        vim.lsp.start({\n            name = 'rust-analyzer',\n            cmd = cmd,\n            root_dir = root_dir,\n            settings = settings\n        })\n    end\n})\n```\n\n### Expected behavior\n\nThere is no this message with interrupt\n\n### Nvim version (nvim -v)\n\nNVIM v0.10.2 Build type: Release LuaJIT 2.1.1727870382\n\n### Language server name/version\n\nrust-analyzer 0.0.0 (3b3a87fe9 2024-10-27)\n\n### Operating system/version\n\nmacos 15.1\n\n### Log file\n\n_No response_",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Seems to be caused by https://github.com/rust-lang/rust-analyzer/pull/18408/commits/8eef1c52757f1ca444792b22433e696364a2b86d",
            "created_at": "2024-10-30T04:25:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/30985#issuecomment-2445815118",
            "id": 2445815118,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30985",
            "node_id": "IC_kwDOAPphoM6RyC1O",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2445815118/reactions"
            },
            "updated_at": "2024-10-30T04:25:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2445815118",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Hmm I can't reproduce this using rust-analyzer 1.84.0-nightly (1e4f10ba 2024-10-29) and master Neovim. Are you sure that no further settings are needed?\n\nhttps://github.com/user-attachments/assets/f0df20f4-76b3-4387-bfe8-352dec59acc7\n\n",
            "created_at": "2024-10-30T05:19:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/30985#issuecomment-2445880408",
            "id": 2445880408,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30985",
            "node_id": "IC_kwDOAPphoM6RySxY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2445880408/reactions"
            },
            "updated_at": "2024-10-30T05:19:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2445880408",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "rust-analyzer 0.0.0 (468b5cd43 2024-10-29)\n\n\n![Image](https://github.com/user-attachments/assets/879058b5-9c87-4e58-950e-0b2ceb3e1a00)\n",
            "created_at": "2024-10-30T06:01:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/30985#issuecomment-2445941047",
            "id": 2445941047,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30985",
            "node_id": "IC_kwDOAPphoM6Ryhk3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2445941047/reactions"
            },
            "updated_at": "2024-10-30T06:01:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2445941047",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "https://github.com/user-attachments/assets/4d6a6048-25ab-473f-82d5-05d24ecca966\n\nSorry, thought gif from glepnir was enough. I guess something fast should happen to trigger cancellation of the previous request to the server. fast typing or typing before server has indexed the project\n\nAnd the configuration is really basic as attached in the issue description",
            "created_at": "2024-10-30T12:54:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/30985#issuecomment-2447051514",
            "id": 2447051514,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30985",
            "node_id": "IC_kwDOAPphoM6R2wr6",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2447051514/reactions"
            },
            "updated_at": "2024-10-30T13:02:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2447051514",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/28891532?v=4",
                "events_url": "https://api.github.com/users/vikulikov/events{/privacy}",
                "followers_url": "https://api.github.com/users/vikulikov/followers",
                "following_url": "https://api.github.com/users/vikulikov/following{/other_user}",
                "gists_url": "https://api.github.com/users/vikulikov/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/vikulikov",
                "id": 28891532,
                "login": "vikulikov",
                "node_id": "MDQ6VXNlcjI4ODkxNTMy",
                "organizations_url": "https://api.github.com/users/vikulikov/orgs",
                "received_events_url": "https://api.github.com/users/vikulikov/received_events",
                "repos_url": "https://api.github.com/users/vikulikov/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/vikulikov/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vikulikov/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/vikulikov",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Workaround to ignore the `ServerCancelled` error:\n```lua\n\nfor _, method in ipairs({ 'textDocument/diagnostic', 'workspace/diagnostic' }) do\n    local default_diagnostic_handler = vim.lsp.handlers[method]\n    vim.lsp.handlers[method] = function(err, result, context, config)\n        if err ~= nil and err.code == -32802 then\n            return\n        end\n        return default_diagnostic_handler(err, result, context, config)\n    end\nend\n```",
            "created_at": "2024-10-30T14:22:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/30985#issuecomment-2447329525",
            "id": 2447329525,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30985",
            "node_id": "IC_kwDOAPphoM6R30j1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 10,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 10,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2447329525/reactions"
            },
            "updated_at": "2024-10-30T14:22:50Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2447329525",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/22473248?v=4",
                "events_url": "https://api.github.com/users/Jesse-Bakker/events{/privacy}",
                "followers_url": "https://api.github.com/users/Jesse-Bakker/followers",
                "following_url": "https://api.github.com/users/Jesse-Bakker/following{/other_user}",
                "gists_url": "https://api.github.com/users/Jesse-Bakker/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Jesse-Bakker",
                "id": 22473248,
                "login": "Jesse-Bakker",
                "node_id": "MDQ6VXNlcjIyNDczMjQ4",
                "organizations_url": "https://api.github.com/users/Jesse-Bakker/orgs",
                "received_events_url": "https://api.github.com/users/Jesse-Bakker/received_events",
                "repos_url": "https://api.github.com/users/Jesse-Bakker/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Jesse-Bakker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Jesse-Bakker/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Jesse-Bakker",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "I can confirm that this issue affects me too. Using Arch and the problem was introduced after doing `pacman -Suy`.\n\nThe workaround of @Jesse-Bakker worked for me, thanks!",
            "created_at": "2024-10-30T15:32:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/30985#issuecomment-2447562137",
            "id": 2447562137,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30985",
            "node_id": "IC_kwDOAPphoM6R4tWZ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2447562137/reactions"
            },
            "updated_at": "2024-10-30T15:32:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2447562137",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/59975766?v=4",
                "events_url": "https://api.github.com/users/samvv/events{/privacy}",
                "followers_url": "https://api.github.com/users/samvv/followers",
                "following_url": "https://api.github.com/users/samvv/following{/other_user}",
                "gists_url": "https://api.github.com/users/samvv/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/samvv",
                "id": 59975766,
                "login": "samvv",
                "node_id": "MDQ6VXNlcjU5OTc1NzY2",
                "organizations_url": "https://api.github.com/users/samvv/orgs",
                "received_events_url": "https://api.github.com/users/samvv/received_events",
                "repos_url": "https://api.github.com/users/samvv/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/samvv/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/samvv/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/samvv",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/30985/comments",
    "created_at": "2024-10-29T17:20:23Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/30985/events",
    "html_url": "https://github.com/neovim/neovim/issues/30985",
    "id": 2621897266,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "We need minimal steps to reproduce the issue",
            "id": 298863445,
            "name": "needs:repro",
            "node_id": "MDU6TGFiZWwyOTg4NjM0NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:repro"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/30985/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 92,
        "created_at": "2023-12-07T23:09:35Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "",
        "due_on": "2024-12-25T08:00:00Z",
        "html_url": "https://github.com/neovim/neovim/milestone/41",
        "id": 10283236,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/41/labels",
        "node_id": "MI_kwDOAPphoM4AnOjk",
        "number": 41,
        "open_issues": 54,
        "state": "open",
        "title": "0.11",
        "updated_at": "2024-10-31T12:07:28Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/41"
    },
    "node_id": "I_kwDOAPphoM6cRvoy",
    "number": 30985,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 17,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 17,
        "url": "https://api.github.com/repos/neovim/neovim/issues/30985/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/30985/timeline",
    "title": "LSP: rust_analyzer: -32802: server cancelled the request",
    "updated_at": "2024-11-04T14:00:23Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/30985",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/28891532?v=4",
        "events_url": "https://api.github.com/users/vikulikov/events{/privacy}",
        "followers_url": "https://api.github.com/users/vikulikov/followers",
        "following_url": "https://api.github.com/users/vikulikov/following{/other_user}",
        "gists_url": "https://api.github.com/users/vikulikov/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/vikulikov",
        "id": 28891532,
        "login": "vikulikov",
        "node_id": "MDQ6VXNlcjI4ODkxNTMy",
        "organizations_url": "https://api.github.com/users/vikulikov/orgs",
        "received_events_url": "https://api.github.com/users/vikulikov/received_events",
        "repos_url": "https://api.github.com/users/vikulikov/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/vikulikov/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/vikulikov/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/vikulikov",
        "user_view_type": "public"
    }
}