{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nWhen `breakindent` is enabled, plugins like [indent-blankline.nvim](https://github.com/lukas-reineke/indent-blankline.nvim) is unable to draw virtual text within the indentation area. This causes the rendered guidelines to be broken up:\r\n![image](https://user-images.githubusercontent.com/72612857/232233546-a46d7da1-062c-4ac7-a8d2-2f548eb3663d.png)\r\nRelated issue: https://github.com/lukas-reineke/indent-blankline.nvim/issues/149\n\n### Expected behavior\n\nIt should be possible to draw virtual text in the indentation area. This will make the guidelines smooth and continuous. This is how it looks when there are no word-wrapping:\r\n![image](https://user-images.githubusercontent.com/72612857/232233806-d6d2dbe6-e225-4048-aac9-861d928d71c0.png)\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Maybe `virt_text_win_col` can be extended to support this.",
            "created_at": "2023-04-15T15:32:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1509872627",
            "id": 1509872627,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5Z_tPz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1509872627/reactions"
            },
            "updated_at": "2023-04-15T15:33:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1509872627",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "After #23759 this is achievable using `virt_text_win_col`:\r\n```vim\r\n40vnew\r\nset breakindent\r\ncall setline(1, repeat('  foo bar', 10))\r\nlet ns = nvim_create_namespace('')\r\ncall nvim_buf_set_extmark(0, ns, 0, 40, {'virt_text': [['|']], 'virt_text_win_col': 1})\r\ncall nvim_buf_set_extmark(0, ns, 0, 80, {'virt_text': [['|']], 'virt_text_win_col': 1})\r\n```",
            "created_at": "2023-05-28T05:14:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1565890709",
            "id": 1565890709,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dVZiV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1565890709/reactions"
            },
            "updated_at": "2023-05-28T05:14:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1565890709",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thank you!",
            "created_at": "2023-05-28T10:34:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1566075086",
            "id": 1566075086,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dWGjO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1566075086/reactions"
            },
            "updated_at": "2023-05-28T10:34:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1566075086",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/72612857?v=4",
                "events_url": "https://api.github.com/users/musjj/events{/privacy}",
                "followers_url": "https://api.github.com/users/musjj/followers",
                "following_url": "https://api.github.com/users/musjj/following{/other_user}",
                "gists_url": "https://api.github.com/users/musjj/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/musjj",
                "id": 72612857,
                "login": "musjj",
                "node_id": "MDQ6VXNlcjcyNjEyODU3",
                "organizations_url": "https://api.github.com/users/musjj/orgs",
                "received_events_url": "https://api.github.com/users/musjj/received_events",
                "repos_url": "https://api.github.com/users/musjj/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/musjj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/musjj/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/musjj"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> After https://github.com/neovim/neovim/pull/23759 this is achievable using virt_text_win_col:\r\n\r\nI'm not sure how useful this actually is to this end.\r\nI don't think it is feasible for plugins to determine at which columns lines are wrapping, it depends on too many options.\r\nWould it make sense to add a \"wrap\" option to the API to indicate that the virtual text should be repeated at column \"start_col\" for each wrapped line?",
            "created_at": "2023-06-01T00:25:48Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1571137186",
            "id": 1571137186,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dpaai",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571137186/reactions"
            },
            "updated_at": "2023-06-01T00:25:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571137186",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This sounds very special-cased. And what is `start_col`?",
            "created_at": "2023-06-01T00:30:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1571139718",
            "id": 1571139718,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dpbCG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571139718/reactions"
            },
            "updated_at": "2023-06-01T00:30:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571139718",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> This sounds very special-cased.\r\n\r\nIndeed, I can't think of another use-case other than indentation markers but who knows.\r\n\r\n> And what is start_col?\r\n\r\nJust `col` I guess, the column an extmark is placed at. If we were to add a `wrap` or `repeat` option, I think it would make sense that it is repeated at column `col` relative to the start of the (wrapped) screenline.",
            "created_at": "2023-06-01T00:36:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1571143373",
            "id": 1571143373,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dpb7N",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571143373/reactions"
            },
            "updated_at": "2023-06-01T00:36:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571143373",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Just `col` I guess, the column an extmark is placed at. If we were to add a wrap or repeat option, I think it would make sense that it is repeated at column `col` relative to the start of the (wrapped) screenline.\r\n\r\nI don't think this makes sense. `col` is a byte index.",
            "created_at": "2023-06-01T00:39:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1571144868",
            "id": 1571144868,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dpcSk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571144868/reactions"
            },
            "updated_at": "2023-06-01T00:39:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571144868",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Oh, with a buffer displayed in multiple windows this also becomes tricky. Related: #19654",
            "created_at": "2023-06-01T00:42:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1571146152",
            "id": 1571146152,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dpcmo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571146152/reactions"
            },
            "updated_at": "2023-06-01T00:42:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571146152",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Indeed, the point is that this use-case can only be handled by `win_line()` itself.\r\nIn the case of indentation markers `col` is simply zero (perhaps it _only_ makes sense if `col` is zero because it is a byte index indeed).\r\nAdding an option to repeat the extmark for each wrapped line could solve this problem.",
            "created_at": "2023-06-01T00:45:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1571147792",
            "id": 1571147792,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5dpdAQ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571147792/reactions"
            },
            "updated_at": "2023-06-01T00:47:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1571147792",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Adding an option to repeat the extmark for each wrapped line could solve this problem.\r\n\r\nAny thoughts on this @zeertzjq @bfredl? I think simply not de-activating the virt text extmark results in the desired behavior:\r\n\r\n<details><summary>Example repeated indent virt text across wrapped line</summary>\r\n\r\n![image](https://github.com/neovim/neovim/assets/31730729/1085f5b6-fde5-4484-8063-157e759cc2fa)\r\n</details>\r\n<details><summary>Patch:</summary>\r\n\r\n```diff\r\ndiff --git a/src/nvim/api/extmark.c b/src/nvim/api/extmark.c\r\nindex 14454b626..905c2f965 100644\r\n--- a/src/nvim/api/extmark.c\r\n+++ b/src/nvim/api/extmark.c\r\n@@ -179,6 +179,7 @@ static Array extmark_to_array(const ExtmarkInfo *extmark, bool id, bool add_dict\r\n       Array chunks = virt_text_to_array(decor->virt_text, hl_name);\r\n       PUT(dict, \"virt_text\", ARRAY_OBJ(chunks));\r\n       PUT(dict, \"virt_text_hide\", BOOLEAN_OBJ(decor->virt_text_hide));\r\n+      PUT(dict, \"virt_text_wrap\", BOOLEAN_OBJ(decor->virt_text_wrap));\r\n       if (decor->virt_text_pos == kVTWinCol) {\r\n         PUT(dict, \"virt_text_win_col\", INTEGER_OBJ(decor->col));\r\n       }\r\n@@ -687,6 +688,7 @@ Integer nvim_buf_set_extmark(Buffer buffer, Integer ns_id, Integer line, Integer\r\n \r\n   decor.hl_eol = opts->hl_eol;\r\n   decor.virt_text_hide = opts->virt_text_hide;\r\n+  decor.virt_text_wrap = opts->virt_text_wrap;\r\n \r\n   if (HAS_KEY(opts, set_extmark, hl_mode)) {\r\n     String str = opts->hl_mode;\r\ndiff --git a/src/nvim/api/keysets.h b/src/nvim/api/keysets.h\r\nindex 18f6d5368..9c26d673e 100644\r\n--- a/src/nvim/api/keysets.h\r\n+++ b/src/nvim/api/keysets.h\r\n@@ -30,6 +30,7 @@ typedef struct {\r\n   String virt_text_pos;\r\n   Integer virt_text_win_col;\r\n   Boolean virt_text_hide;\r\n+  Boolean virt_text_wrap;\r\n   Boolean hl_eol;\r\n   String hl_mode;\r\n   Boolean ephemeral;\r\ndiff --git a/src/nvim/decoration.h b/src/nvim/decoration.h\r\nindex fef5ff7c2..bbb7c8e8c 100644\r\n--- a/src/nvim/decoration.h\r\n+++ b/src/nvim/decoration.h\r\n@@ -52,6 +52,7 @@ struct Decoration {\r\n \r\n   // TODO(bfredl): at some point turn this into FLAGS\r\n   bool virt_text_hide;\r\n+  bool virt_text_wrap;\r\n   bool hl_eol;\r\n   bool virt_lines_above;\r\n   bool conceal;\r\n@@ -71,7 +72,7 @@ struct Decoration {\r\n   bool ui_watched;  // watched for win_extmark\r\n };\r\n #define DECORATION_INIT { KV_INITIAL_VALUE, KV_INITIAL_VALUE, 0, kVTEndOfLine, \\\r\n-                          kHlModeUnknown, false, false, false, false, kNone, \\\r\n+                          kHlModeUnknown, false, false, false, false, false, kNone, \\\r\n                           DECOR_PRIORITY_BASE, 0, 0, NULL, 0, 0, 0, 0, 0, false }\r\n \r\n typedef struct {\r\ndiff --git a/src/nvim/drawline.c b/src/nvim/drawline.c\r\nindex e5d2ba755..639efdaa6 100644\r\n--- a/src/nvim/drawline.c\r\n+++ b/src/nvim/drawline.c\r\n@@ -324,7 +324,9 @@ static void draw_virt_text(win_T *wp, buf_T *buf, int col_off, int *end_col, int\r\n       col = draw_virt_text_item(buf, item->draw_col, item->decor.virt_text,\r\n                                 item->decor.hl_mode, max_col, vcol, wp->w_p_rl);\r\n     }\r\n-    item->draw_col = INT_MIN;  // deactivate\r\n+    if (!item->decor.virt_text_wrap) {\r\n+      item->draw_col = INT_MIN;  // deactivate\r\n+    }\r\n     if (item->decor.virt_text_pos == kVTEndOfLine && do_eol) {\r\n       if (wp->w_p_rl) {\r\n         state->eol_col = col - 1;\r\n```\r\n</details>\r\n\r\nIn this case, a plugin like indent-blankline would need to make sure to only set this flag to true if `'breakindent'` is enabled.",
            "created_at": "2023-10-07T00:50:18Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1751534494",
            "id": 1751534494,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5oZkue",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1751534494/reactions"
            },
            "updated_at": "2023-10-07T00:52:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1751534494",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "`virt_text_wrap` may not be an accurate name for this, but I can't think of a better name.",
            "created_at": "2023-10-07T01:08:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/23108#issuecomment-1751540447",
            "id": 1751540447,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23108",
            "node_id": "IC_kwDOAPphoM5oZmLf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1751540447/reactions"
            },
            "updated_at": "2023-10-07T01:08:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1751540447",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        }
    ],
    "comments": 11,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/23108/comments",
    "created_at": "2023-04-15T15:23:41Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/23108/events",
    "html_url": "https://github.com/neovim/neovim/issues/23108",
    "id": 1669453499,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 113026979,
            "name": "ui",
            "node_id": "MDU6TGFiZWwxMTMwMjY5Nzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "extmarks, decorations, virtual text, namespaces",
            "id": 1680119719,
            "name": "extmarks",
            "node_id": "MDU6TGFiZWwxNjgwMTE5NzE5",
            "url": "https://api.github.com/repos/neovim/neovim/labels/extmarks"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/23108/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5jgda7",
    "number": 23108,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/neovim/neovim/issues/23108/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": "reopened",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/23108/timeline",
    "title": "Virtual text in indented word-wrapped area",
    "updated_at": "2023-10-07T01:08:17Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/23108",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/72612857?v=4",
        "events_url": "https://api.github.com/users/musjj/events{/privacy}",
        "followers_url": "https://api.github.com/users/musjj/followers",
        "following_url": "https://api.github.com/users/musjj/following{/other_user}",
        "gists_url": "https://api.github.com/users/musjj/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/musjj",
        "id": 72612857,
        "login": "musjj",
        "node_id": "MDQ6VXNlcjcyNjEyODU3",
        "organizations_url": "https://api.github.com/users/musjj/orgs",
        "received_events_url": "https://api.github.com/users/musjj/received_events",
        "repos_url": "https://api.github.com/users/musjj/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/musjj/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/musjj/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/musjj"
    }
}