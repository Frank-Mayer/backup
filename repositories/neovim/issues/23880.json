{
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/40792180?v=4",
        "events_url": "https://api.github.com/users/smjonas/events{/privacy}",
        "followers_url": "https://api.github.com/users/smjonas/followers",
        "following_url": "https://api.github.com/users/smjonas/following{/other_user}",
        "gists_url": "https://api.github.com/users/smjonas/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/smjonas",
        "id": 40792180,
        "login": "smjonas",
        "node_id": "MDQ6VXNlcjQwNzkyMTgw",
        "organizations_url": "https://api.github.com/users/smjonas/orgs",
        "received_events_url": "https://api.github.com/users/smjonas/received_events",
        "repos_url": "https://api.github.com/users/smjonas/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/smjonas/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/smjonas/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/smjonas"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/40792180?v=4",
            "events_url": "https://api.github.com/users/smjonas/events{/privacy}",
            "followers_url": "https://api.github.com/users/smjonas/followers",
            "following_url": "https://api.github.com/users/smjonas/following{/other_user}",
            "gists_url": "https://api.github.com/users/smjonas/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/smjonas",
            "id": 40792180,
            "login": "smjonas",
            "node_id": "MDQ6VXNlcjQwNzkyMTgw",
            "organizations_url": "https://api.github.com/users/smjonas/orgs",
            "received_events_url": "https://api.github.com/users/smjonas/received_events",
            "repos_url": "https://api.github.com/users/smjonas/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/smjonas/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/smjonas/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/smjonas"
        }
    ],
    "author_association": "NONE",
    "body": "### Problem\n\nEditing the following file with `nvim --clean`\r\n\r\n```sh\r\n#! /usr/bin/env nix-shell\r\n#! nix-shell -i bash -p hello\r\nhello\r\n```\r\n\r\ncauses neovim to detect the filetype as `nix`, even though that's a bash script. It seems to do that as soon as the shebang matches `/usr/bin/env nix.*`, but I couldn't find which piece of code is responsible for this.\n\n### Steps to reproduce\n\nSee above.\n\n### Expected behavior\n\nIf parsing out the `-i` argument to nix-shell is too hard, at least don't detect any file type.\n\n### Neovim version (nvim -v)\n\n0.9.0\n\n### Vim (not Nvim) behaves the same?\n\nno, vim 9.0.1441 (detected as `conf`)\n\n### Operating system/version\n\nNixOS unstable\n\n### Terminal name/version\n\nalacritty irrelevant\n\n### $TERM environment variable\n\nalacritty\n\n### Installation\n\nnixpkgs",
    "closed_at": "2023-06-08T17:19:15Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "Yes, `--clean` reproduces this.",
            "created_at": "2023-06-02T09:41:49Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573450334",
            "id": 1573450334,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dyPJe",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573450334/reactions"
            },
            "updated_at": "2023-06-02T09:41:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573450334",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "NONE",
            "body": "This behaviour was introduced between neovim 0.8.3 and 0.9.0. (bisected to https://github.com/NixOS/nixpkgs/commit/8eb9ed0cd532e776c7cba121c1f900b75980391f in nixpkgs)",
            "created_at": "2023-06-02T10:18:47Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573497989",
            "id": 1573497989,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dyayF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573497989/reactions"
            },
            "updated_at": "2023-06-02T10:20:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573497989",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "That's not much to go on; can you bisect the actual commit?",
            "created_at": "2023-06-02T10:20:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573500000",
            "id": 1573500000,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dybRg",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573500000/reactions"
            },
            "updated_at": "2023-06-02T10:20:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573500000",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "Sure, but at first glance to the changelog this looks suspicious:\r\n\r\n> filetype.vim is removed in favor of [lua-filetype](https://neovim.io/doc/user/lua.html#lua-filetype)",
            "created_at": "2023-06-02T10:22:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573502077",
            "id": 1573502077,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dybx9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573502077/reactions"
            },
            "updated_at": "2023-06-02T10:22:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573502077",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Well, yes, but the question is whether this was introduced in a later refactor commit.\r\n\r\n(By the way, Vim 9.0.1544 doesn't detect this file at all just from the contents. What is the actual name of the file?)",
            "created_at": "2023-06-02T10:24:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573504138",
            "id": 1573504138,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dycSK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573504138/reactions"
            },
            "updated_at": "2023-06-02T10:24:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573504138",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "I know it doesn't, which is why I was reporting here in the first place.\r\n\r\n> no, vim 9.0.1441 (detected as `conf`)\r\n\r\nThe name of the file is `format` or `foo`.",
            "created_at": "2023-06-02T10:25:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573506293",
            "id": 1573506293,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dycz1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573506293/reactions"
            },
            "updated_at": "2023-06-02T10:25:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573506293",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "OK, the name is important. ",
            "created_at": "2023-06-02T10:33:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573515059",
            "id": 1573515059,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dye8z",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573515059/reactions"
            },
            "updated_at": "2023-06-02T10:33:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573515059",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "And is `conf` the correct filetype, or should this really be something like `sh` or `bash`?\r\n",
            "created_at": "2023-06-02T10:34:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573517324",
            "id": 1573517324,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dyfgM",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573517324/reactions"
            },
            "updated_at": "2023-06-02T10:34:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573517324",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "I'm not sure what `conf` is, I took it to mean \"I couldn't detect anything useful\". The correct filetype would be `bash` but I don't expect vim (or neovim) to detect that.",
            "created_at": "2023-06-02T10:37:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573519929",
            "id": 1573519929,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dygI5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573519929/reactions"
            },
            "updated_at": "2023-06-02T10:37:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573519929",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "No, `conf` is a specific filetype (for some config files), which is even more wrong than \"none\" (which is what _should_ happen if the filetype couldn't be detected). \r\n\r\nBut why wouldn't you expect it to be detected correctly? So please open an issue at Vim requesting this to be detected as `bash`; we'll port the changes to our code then.",
            "created_at": "2023-06-02T10:39:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573522863",
            "id": 1573522863,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dyg2v",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573522863/reactions"
            },
            "updated_at": "2023-06-02T10:39:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573522863",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "(closing here since there's no need to track this; we port updates to the filetype logic as a matter of course.)",
            "created_at": "2023-06-02T10:40:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573523785",
            "id": 1573523785,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dyhFJ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573523785/reactions"
            },
            "updated_at": "2023-06-02T10:40:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573523785",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "Bisected to b518aceaa8f738e581e58aacae93514699b5ff8e. Apparently the `nix` in the shebang is enough to make it default to a `nix` filetype.\r\n\r\nSo I guess the behaviour I'm observing is a desperate fallback from neovim because vim couldn't detect anything meaningful?\r\n\r\nI'm not sure if this should be fixed in vim or in a dedicated nix plugin, as the logic for detecting `nix-shell` filetypes is going to be somewhat involved... (The `-i` argument on the second line says what the interpreter for the script should be.)\r\n\r\nThanks anyway!",
            "created_at": "2023-06-02T11:03:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573549418",
            "id": 1573549418,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dynVq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573549418/reactions"
            },
            "updated_at": "2023-06-02T11:08:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573549418",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "NONE",
            "body": "Related: https://github.com/LnL7/vim-nix/issues/10",
            "created_at": "2023-06-02T11:06:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573554161",
            "id": 1573554161,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dyofx",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573554161/reactions"
            },
            "updated_at": "2023-06-02T11:06:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573554161",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> So I guess the behaviour I'm observing is a desperate fallback from neovim because vim couldn't detect anything meaningful?\r\n\r\nYes, or rather a _different_ desperate fallback from Vim, neither of which can detect this.\r\n\r\n(To be honest, I'm not sure we should have merged that PR, as we've been pretty strict about aligning with Vim for the reason we've seen here...)\r\n\r\n> I'm not sure if this should be fixed in vim or in a dedicated nix plugin, as the logic for detecting nix-shell filetypes is going to be somewhat involved... (The -i argument on the second line says what the interpreter for the script should be.)\r\n\r\nWell, \"involved\" never stopped Vim before... Worth a shot, I'd say, if you think that this is a sufficiently prevalent use case. (Personally, I'd prefer if nix-specific stuff stayed nix-specific -- hermetic, if you will...)",
            "created_at": "2023-06-02T12:02:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1573624711",
            "id": 1573624711,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5dy5uH",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573624711/reactions"
            },
            "updated_at": "2023-06-02T12:02:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1573624711",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "So I've implemented nix-shell shebang detection as a proof of concept: https://github.com/LnL7/vim-nix/pull/51\r\n\r\nIt works fine with vim, but with neovim the filetype is still detected as `nix` due to https://github.com/neovim/neovim/commit/b518aceaa8f738e581e58aacae93514699b5ff8e.\r\n\r\nIf I remove the `!did_filetype()` check (which I don't want to do anyway, because then file extensions don't take precedence over this any more), the filetype is set correctly, but for some reason the LSP client (I'm using nvim-lspconfig with `nil_ls`) still reports errors as if this were a `nix` file.\r\n\r\nIs there something to be fixed in neovim here, or am I doing it wrong?",
            "created_at": "2023-06-08T15:39:34Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1582846729",
            "id": 1582846729,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5eWFMJ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1582846729/reactions"
            },
            "updated_at": "2023-06-08T15:40:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1582846729",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Use `vim.filetype.add` for Neovim.",
            "created_at": "2023-06-08T15:42:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1582851603",
            "id": 1582851603,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5eWGYT",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1582851603/reactions"
            },
            "updated_at": "2023-06-08T15:42:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1582851603",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks! I'll look into that later; for now I've opened an issue to see if this can be upstreamed in vim: https://github.com/vim/vim/issues/12507\r\n\r\nFeel free to close this one.",
            "created_at": "2023-06-08T17:18:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1583055077",
            "id": 1583055077,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5eW4Dl",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1583055077/reactions"
            },
            "updated_at": "2023-06-08T17:18:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1583055077",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
                "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
                "followers_url": "https://api.github.com/users/ncfavier/followers",
                "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
                "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ncfavier",
                "id": 4323933,
                "login": "ncfavier",
                "node_id": "MDQ6VXNlcjQzMjM5MzM=",
                "organizations_url": "https://api.github.com/users/ncfavier/orgs",
                "received_events_url": "https://api.github.com/users/ncfavier/received_events",
                "repos_url": "https://api.github.com/users/ncfavier/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ncfavier"
            }
        },
        {
            "author_association": "NONE",
            "body": "I think it would be simpler if there's a way to turn off shebang detection for `nix-shell`. It seems that this is caused by this line:\r\nhttps://github.com/neovim/neovim/blob/72e619ca92b527140e1323f4e281b7f3ad35f380/runtime/lua/vim/filetype/detect.lua#L1608\r\n\r\nWhich, oddly, was added after this issue was made (what was the original cause of this issue?): https://github.com/neovim/neovim/pull/23961\r\n\r\nIn any case, I don't think this is desirable or correct. `nix-shell`, when used as a shebang, practically always redirects to a different interpreter (from `man nix-shell`):\r\n\r\n```\r\nYou can use nix-shell as a script interpreter to allow scripts written in\r\narbitrary languages  to  obtain  their own dependencies via Nix. This is done\r\nby starting the script with the following lines:\r\n\r\n#! /usr/bin/env nix-shell\r\n#! nix-shell -i real-interpreter -p packages\r\n\r\nwhere real-interpreter is the “real” script interpreter that will be invoked\r\nby nix-shell after it has obtained the dependencies and initialised the\r\nenvironment, and packages are the attribute names of the dependencies in\r\nNixpkgs.\r\n```\r\n\r\nSo the contents of the script is never going to be written in the `nix` language (if you want to do that, you'd just write a `.nix` file).\r\n\r\nAs for filetype detection, the user can simply add a modeline at the top of their script, like this:\r\n\r\n```sh\r\n#!/usr/bin/env nix-shell\r\n#!nix-shell -i bash -p bash\r\n# vim: ft=sh\r\n```\r\n\r\nBut unfortunately, this method does not mesh very well with shebang detection. This is because the filetype will be set twice, once for the shebang detection and another for the modeline. So in a typical setup, you will end up with two simultaneous LSP clients, one for `nix` and one for `bash`.\r\n\r\nEDIT: Quick and dirty fix that you can drop into your config for now:\r\n\r\n```lua\r\nlocal match_contents = require(\"vim.filetype.detect\").match_contents\r\nrequire(\"vim.filetype.detect\").match_contents = function(...)\r\n  local result = match_contents(...)\r\n  if result ~= \"nix\" then -- just don't ever return nix\r\n    return result\r\n  end\r\nend\r\n```",
            "created_at": "2023-08-10T01:07:47Z",
            "html_url": "https://github.com/neovim/neovim/issues/23880#issuecomment-1672385702",
            "id": 1672385702,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23880",
            "node_id": "IC_kwDOAPphoM5jrpSm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1672385702/reactions"
            },
            "updated_at": "2023-08-10T01:39:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1672385702",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/72612857?v=4",
                "events_url": "https://api.github.com/users/musjj/events{/privacy}",
                "followers_url": "https://api.github.com/users/musjj/followers",
                "following_url": "https://api.github.com/users/musjj/following{/other_user}",
                "gists_url": "https://api.github.com/users/musjj/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/musjj",
                "id": 72612857,
                "login": "musjj",
                "node_id": "MDQ6VXNlcjcyNjEyODU3",
                "organizations_url": "https://api.github.com/users/musjj/orgs",
                "received_events_url": "https://api.github.com/users/musjj/received_events",
                "repos_url": "https://api.github.com/users/musjj/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/musjj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/musjj/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/musjj"
            }
        }
    ],
    "comments": 18,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/23880/comments",
    "created_at": "2023-06-02T09:36:29Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/23880/events",
    "html_url": "https://github.com/neovim/neovim/issues/23880",
    "id": 1737831863,
    "labels": [
        {
            "color": "f9d0c4",
            "default": false,
            "description": "wrong behavior that was introduced in a previous commit (please bisect)",
            "id": 619474658,
            "name": "bug-regression",
            "node_id": "MDU6TGFiZWw2MTk0NzQ2NTg=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-regression"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue has been tracked to a specific commit",
            "id": 1481421490,
            "name": "has:bisected",
            "node_id": "MDU6TGFiZWwxNDgxNDIxNDkw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:bisected"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "filetype detection, filetype.lua",
            "id": 3708202139,
            "name": "filetype",
            "node_id": "LA_kwDOAPphoM7dBqyb",
            "url": "https://api.github.com/repos/neovim/neovim/labels/filetype"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/23880/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5nlTW3",
    "number": 23880,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/23880/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/23880/timeline",
    "title": "filetype wrongly detected as nix for nix-shell shebangs",
    "updated_at": "2023-08-10T01:39:01Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/23880",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/4323933?v=4",
        "events_url": "https://api.github.com/users/ncfavier/events{/privacy}",
        "followers_url": "https://api.github.com/users/ncfavier/followers",
        "following_url": "https://api.github.com/users/ncfavier/following{/other_user}",
        "gists_url": "https://api.github.com/users/ncfavier/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ncfavier",
        "id": 4323933,
        "login": "ncfavier",
        "node_id": "MDQ6VXNlcjQzMjM5MzM=",
        "organizations_url": "https://api.github.com/users/ncfavier/orgs",
        "received_events_url": "https://api.github.com/users/ncfavier/received_events",
        "repos_url": "https://api.github.com/users/ncfavier/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ncfavier/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ncfavier/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ncfavier"
    }
}