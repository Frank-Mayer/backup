{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nI've been using Gnome Terminal before WezTerm, and undercurl worked well.  \r\nI tried WezTerm and I noticed that it doesn't work out of the box. I had to install their terminfo file to activate this.  \r\nIt's not a big deal to install it, but I wonder how it could support Gnome Terminal without it. (it means it can be done for WezTerm as well?)\r\n\r\nI raised an issue there, but the maintainer suggested me to request this feature here.\r\nhttps://github.com/wez/wezterm/issues/415\n\n### Expected behavior\n\nOut-of-the-box undercurl support in WezTerm without additional terminfo file.\r\n\r\nIt seems to me that WezTerm only uses xterm-256color for all other stuff and only introduced wezterm terminfo just because of neovim. So if neovim supports this, they probably could remove additional terminfo as well.",
    "closed_at": "2024-03-26T06:25:02Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "is there a way for nvim to dynamically detect wezterm? e.g. a query-reseponse code, or in the worst case a $TERM string. @wez \r\n\r\ncurrently we are only looking at terminfo: https://github.com/neovim/neovim/blob/904c13e6b572552a676efcaec640dfa8bd199e59/src/nvim/tui/tui.c#L2145\r\n\r\nperhaps we should assume undercurl support for xterm-compatible terminals these days.",
            "created_at": "2023-01-09T12:36:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/21699#issuecomment-1375564842",
            "id": 1375564842,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21699",
            "node_id": "IC_kwDOAPphoM5R_XQq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1375564842/reactions"
            },
            "updated_at": "2023-01-09T12:37:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1375564842",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "Hmm, based on what @kiyoon said, it sounded like neovim came up with undercurl support for Gnome Terminal which (on my system), has `TERM=xterm-256color`, so I assumed that it was doing some probing.  I wonder if there is more to that environment/setup?\r\n\r\nFor probing I'd suggest taking a look at this section of the notcurses docs:\r\nhttps://github.com/dankamongmen/notcurses/blob/06241120500d5f4f4c3ac8fa111a42f1d0df8af8/TERMINALS.md#queries that briefly mentions how it detects various terminals.\r\n\r\nFor wezterm (and xterm and contour), you can issue an `XTVERSION` (`CSI > 0 q`) query, followed by `CSI c` (`Send Primary Device Attributes`). The latter is present so that terminals that don't respond to `XTVERSION` don't leave you hanging waiting for a response: every terminal responds to `CSI c`.\r\n\r\nwezterm's `XTVERSION` response will look something like:\r\n\r\n```\r\n; printf \"\\e[>0q\" ; od -c\r\n^[P>|WezTerm 20230108-075823-c9a0537b^[\\\r\n0000000 033   P   >   |   W   e   z   T   e   r   m       2   0   2   3\r\n0000020   0   1   0   8   -   0   7   5   8   2   3   -   c   9   a   0\r\n0000040   5   3   7   b 033   \\ \r\n```\r\n\r\nyou can also use the environment to detect a local wezterm (and a couple of other terminals):\r\n\r\n```\r\n; env | grep TERM_PROGRAM\r\nTERM_PROGRAM=WezTerm\r\nTERM_PROGRAM_VERSION=20230108-075823-c9a0537b\r\n```\r\n\r\nwezterm's `XTVERSION` response is equivalent to `\"${TERM_PROGRAM} ${TERM_PROGRAM_VERSION}\"`.\r\n\r\nundercurl support was added to wezterm in version `20210203-095643-70a364eb`.\r\n\r\nwezterm's version numbers are composed from the date, time and git hash of the build, so you can compare them lexicographically  to determine which is newer with eg: `strcmp` or similar.\r\n\r\n",
            "created_at": "2023-01-09T14:11:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/21699#issuecomment-1375682786",
            "id": 1375682786,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21699",
            "node_id": "IC_kwDOAPphoM5R_0Di",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 5,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 5,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1375682786/reactions"
            },
            "updated_at": "2023-01-09T14:11:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1375682786",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/117777?v=4",
                "events_url": "https://api.github.com/users/wez/events{/privacy}",
                "followers_url": "https://api.github.com/users/wez/followers",
                "following_url": "https://api.github.com/users/wez/following{/other_user}",
                "gists_url": "https://api.github.com/users/wez/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/wez",
                "id": 117777,
                "login": "wez",
                "node_id": "MDQ6VXNlcjExNzc3Nw==",
                "organizations_url": "https://api.github.com/users/wez/orgs",
                "received_events_url": "https://api.github.com/users/wez/received_events",
                "repos_url": "https://api.github.com/users/wez/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/wez/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/wez/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/wez"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">I had to install their terminfo file to activate this.\r\n\r\nI don't see why this is considered a bad thing. The terminfo entry is the method for communicating to applications what a terminal is capable of. Lying about being `xterm-256color` just causes complications, and we end up having to create a bunch of exceptions and special cases because of this.",
            "created_at": "2023-01-10T18:13:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/21699#issuecomment-1377660380",
            "id": 1377660380,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21699",
            "node_id": "IC_kwDOAPphoM5SHW3c",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377660380/reactions"
            },
            "updated_at": "2023-01-10T18:13:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377660380",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> > I had to install their terminfo file to activate this.\r\n> \r\n> I don't see why this is considered a bad thing. The terminfo entry is the method for communicating to applications what a terminal is capable of. Lying about being `xterm-256color` just causes complications, and we end up having to create a bunch of exceptions and special cases because of this.\r\n\r\nSorry for my ignorance about the project. If it creates a lot of complications in your project, you can ignore the request and as I said I don't mind installing the terminfo! It wasn't difficult at all.\r\n\r\nAnd I think the Gnome Terminal undercurl doesn't work over SSH, which makes me think that as you said it's not a standard in xterm-256color and surely your team is trying hard to detect the correct terminfo as best as possible although it may not be possible with all types of layers like tmux and SSH.",
            "created_at": "2023-01-10T18:25:13Z",
            "html_url": "https://github.com/neovim/neovim/issues/21699#issuecomment-1377674229",
            "id": 1377674229,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21699",
            "node_id": "IC_kwDOAPphoM5SHaP1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377674229/reactions"
            },
            "updated_at": "2023-01-10T18:25:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377674229",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/12980409?v=4",
                "events_url": "https://api.github.com/users/kiyoon/events{/privacy}",
                "followers_url": "https://api.github.com/users/kiyoon/followers",
                "following_url": "https://api.github.com/users/kiyoon/following{/other_user}",
                "gists_url": "https://api.github.com/users/kiyoon/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kiyoon",
                "id": 12980409,
                "login": "kiyoon",
                "node_id": "MDQ6VXNlcjEyOTgwNDA5",
                "organizations_url": "https://api.github.com/users/kiyoon/orgs",
                "received_events_url": "https://api.github.com/users/kiyoon/received_events",
                "repos_url": "https://api.github.com/users/kiyoon/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kiyoon/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kiyoon/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kiyoon"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/21699/comments",
    "created_at": "2023-01-09T03:35:10Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/21699/events",
    "html_url": "https://github.com/neovim/neovim/issues/21699",
    "id": 1524876186,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/21699/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 343,
        "created_at": "2023-02-02T14:11:43Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
            "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
            "followers_url": "https://api.github.com/users/bfredl/followers",
            "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
            "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bfredl",
            "id": 1363104,
            "login": "bfredl",
            "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
            "organizations_url": "https://api.github.com/users/bfredl/orgs",
            "received_events_url": "https://api.github.com/users/bfredl/received_events",
            "repos_url": "https://api.github.com/users/bfredl/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bfredl"
        },
        "description": "",
        "due_on": "2024-05-01T07:00:00Z",
        "html_url": "https://github.com/neovim/neovim/milestone/36",
        "id": 8997654,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/36/labels",
        "node_id": "MI_kwDOAPphoM4AiUsW",
        "number": 36,
        "open_issues": 38,
        "state": "open",
        "title": "0.10",
        "updated_at": "2024-04-01T11:13:57Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/36"
    },
    "node_id": "I_kwDOAPphoM5a48Oa",
    "number": 21699,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 10,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 10,
        "url": "https://api.github.com/repos/neovim/neovim/issues/21699/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/21699/timeline",
    "title": "Undercurl support with WezTerm",
    "updated_at": "2024-03-26T06:25:02Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/21699",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/12980409?v=4",
        "events_url": "https://api.github.com/users/kiyoon/events{/privacy}",
        "followers_url": "https://api.github.com/users/kiyoon/followers",
        "following_url": "https://api.github.com/users/kiyoon/following{/other_user}",
        "gists_url": "https://api.github.com/users/kiyoon/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/kiyoon",
        "id": 12980409,
        "login": "kiyoon",
        "node_id": "MDQ6VXNlcjEyOTgwNDA5",
        "organizations_url": "https://api.github.com/users/kiyoon/orgs",
        "received_events_url": "https://api.github.com/users/kiyoon/received_events",
        "repos_url": "https://api.github.com/users/kiyoon/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/kiyoon/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/kiyoon/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/kiyoon"
    }
}