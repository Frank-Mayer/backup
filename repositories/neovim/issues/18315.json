{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Neovim version (nvim -v)\r\n\r\nNVIM v0.8.0-dev+2-g08a144912\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nno\r\n\r\n### Operating system/version\r\n\r\nalpine linux edge\r\n\r\n### Terminal name/version\r\n\r\nfoot version: 1.12.1-3-g7045c177 (Apr 27 2022, branch 'master') +pgo +ime +graphemes -assertions\r\n\r\n### $TERM environment variable\r\n\r\nfoot\r\n\r\n### Installation\r\n\r\nself-compiled (`cmake -G Ninja -B build -DCMAKE_BUILD_TYPE=Release`, with CFLAGS `\"-O2 -ftree-vectorize -flto -DNDEBUG -march=native -fPIC -fstack-clash-protection -fstack-protector-strong -fcf-protection -pipe -fomit-frame-pointer\"`, cc `gcc (Alpine 11.2.1_git20220219) 11.2.1 20220219`)\r\n\r\n### How to reproduce the issue\r\n\r\nnot exactly sure. this happens at random when just invoking `nvim somefile` (and sometimes just `nvim`). once it happens, it can be reproduced repeatedly, but reopening the terminal/moving stuff around makes it stop, until it mysteriously comes back a day or two later.  \r\n\r\n<details>\r\n<summary>asan</summary>  \r\n\r\n```\r\n=================================================================\r\n==68027==ERROR: AddressSanitizer: heap-use-after-free on address 0x616000081980 at pc 0x558de9a75905 bp 0x7ffc1bb05eb0 sp 0x7ffc1bb05678\r\nREAD of size 3 at 0x616000081980 thread T0\r\n    #0 0x558de9a75904 in strlen /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5\r\n    #1 0x558de9ebca6c in xstrdup (/home/demon/src/neovim/build/bin/nvim+0x7f5a6c)\r\n    #2 0x558dea03c466 in do_in_path (/home/demon/src/neovim/build/bin/nvim+0x975466)\r\n    #3 0x558dea041c75 in load_plugins (/home/demon/src/neovim/build/bin/nvim+0x97ac75)\r\n    #4 0x558de9e64349 in main (/home/demon/src/neovim/build/bin/nvim+0x79d349)\r\n    #5 0x7f3b979fda21 in libc_start_main_stage2 /home/buildozer/aports/main/musl/src/v1.2.3/src/env/__libc_start_main.c:95:2\r\n\r\n0x616000081980 is located 0 bytes inside of 638-byte region [0x616000081980,0x616000081bfe)\r\nfreed by thread T0 here:\r\n    #0 0x558de9ace942 in free /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/asan_malloc_linux.cpp:52:3\r\n    #1 0x558de9f7b432 in did_set_string_option option.c\r\n    #2 0x558de9f6ab2b in set_option_value (/home/demon/src/neovim/build/bin/nvim+0x8a3b2b)\r\n    #3 0x558dea0455ab in add_pack_dir_to_rtp runtime.c\r\n    #4 0x558dea045a43 in add_pack_plugin runtime.c\r\n    #5 0x558dea03ca26 in do_in_path (/home/demon/src/neovim/build/bin/nvim+0x975a26)\r\n    #6 0x558dea04203f in ex_packadd (/home/demon/src/neovim/build/bin/nvim+0x97b03f)\r\n\r\npreviously allocated by thread T0 here:\r\n    #0 0x558de9acea6e in malloc /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/asan_malloc_linux.cpp:69:3\r\n    #1 0x558de9ebc394 in xmalloc (/home/demon/src/neovim/build/bin/nvim+0x7f5394)\r\n    #2 0x558dea0455ab in add_pack_dir_to_rtp runtime.c\r\n    #3 0x558dea0417f6 in add_pack_start_dir runtime.c\r\n    #4 0x558dea03cbaf in do_in_path (/home/demon/src/neovim/build/bin/nvim+0x975baf)\r\n    #5 0x558dea041a9c in ex_packloadall (/home/demon/src/neovim/build/bin/nvim+0x97aa9c)\r\n    #6 0x558de9b23cac in nlua_api_nvim_command lua_api_c_bindings.generated.c\r\n    #7 0x7f3b978c3f74  (/usr/lib/libluajit-5.1.so.2+0xaf74)\r\n\r\nSUMMARY: AddressSanitizer: heap-use-after-free /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5 in strlen\r\nShadow bytes around the buggy address:\r\n  0x0c2c800082e0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c800082f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008300: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008310: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008320: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n=>0x0c2c80008330:[fd]fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008340: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008350: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008360: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008370: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80008380: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n==68027==ABORTING\r\n\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n<summary> gdb (no symbols) </summary>\r\n\r\n```\r\n(gdb) bt full\r\n#0  0x00007ffff7fb7854 in strlen (s=<optimized out>) at src/string/strlen.c:17\r\n        a = 0x7ffff71be2b0 <error: Cannot access memory at address 0x7ffff71be2b0>\r\n        w = 0x7ffff71be2b0\r\n#1  0x00005555557fedc6 in do_in_path ()\r\nNo symbol table info available.\r\n#2  0x00005555557ffd86 in do_in_path_and_pp ()\r\nNo symbol table info available.\r\n#3  0x00005555558029cb in load_plugins ()\r\nNo symbol table info available.\r\n#4  0x00005555555d1d1e in main ()\r\nNo symbol table info available.\r\n```\r\n\r\n</details>\r\nrunning address-sanitizer always reproduces the above on program startup (for me)- and getting that rare random segfault in a gdb backtrace points to the same strlen function, so i think this is some STRLEN/xstrdup related memory corruption that only very sporadically actually fails.  \r\n\r\n### Expected behavior\r\n\r\nno segfault\r\n\r\n### Actual behavior\r\n\r\nsegfault",
    "closed_at": "2023-07-18T22:47:06Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "oh, and the asan reproduction was just  \r\n```\r\nCFLAGS=\"-fsanitize=address\" CC=clang cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Release\r\nASAN_OPTIONS=halt_on_error=0 cmake --build build\r\n./build/bin/nvim 2>log\r\n```\r\non latest master- not using the cmake ASAN options.  \r\nusing `-DCLANG_ASAN_UBSAN=ON` instead of -fsanitize cflags yields almost the same results, however, just seemingly without xstrdup:  \r\n\r\n<details>\r\n<summary>asan 2</summary>\r\n\r\n```\r\n=================================================================\r\n==80998==ERROR: AddressSanitizer: heap-use-after-free on address 0x616000070b80 at pc 0x55690f852865 bp 0x7ffc4075d8f0 sp 0x7ffc4075d0b8\r\nREAD of size 3 at 0x616000070b80 thread T0\r\n    #0 0x55690f852864 in strlen /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5\r\n    #1 0x55690ff29106 in do_in_path (/home/demon/src/neovim/build/bin/nvim+0xc1e106)\r\n    #2 0x55690ff2e652 in load_plugins (/home/demon/src/neovim/build/bin/nvim+0xc23652)\r\n    #3 0x55690fcedc88 in main (/home/demon/src/neovim/build/bin/nvim+0x9e2c88)\r\n    #4 0x7f35b3000a21 in libc_start_main_stage2 /home/buildozer/aports/main/musl/src/v1.2.3/src/env/__libc_start_main.c:95:2\r\n\r\n0x616000070b80 is located 0 bytes inside of 638-byte region [0x616000070b80,0x616000070dfe)\r\nfreed by thread T0 here:\r\n    #0 0x55690f8ab8a2 in free /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/asan_malloc_linux.cpp:52:3\r\n    #1 0x55690fe40f5b in did_set_string_option (/home/demon/src/neovim/build/bin/nvim+0xb35f5b)\r\n    #2 0x55690fe2cc8e in set_option_value (/home/demon/src/neovim/build/bin/nvim+0xb21c8e)\r\n    #3 0x55690ff31041 in add_pack_dir_to_rtp (/home/demon/src/neovim/build/bin/nvim+0xc26041)\r\n    #4 0x55690ff3159e in add_pack_plugin (/home/demon/src/neovim/build/bin/nvim+0xc2659e)\r\n    #5 0x55690ff2eb73 in add_opt_pack_plugin (/home/demon/src/neovim/build/bin/nvim+0xc23b73)\r\n    #6 0x55690ff29542 in do_in_path (/home/demon/src/neovim/build/bin/nvim+0xc1e542)\r\n    #7 0x55690ff2e9c3 in ex_packadd (/home/demon/src/neovim/build/bin/nvim+0xc239c3)\r\n    #8 0x55690fba79fa in do_one_cmd (/home/demon/src/neovim/build/bin/nvim+0x89c9fa)\r\n    #9 0x55690fba06aa in do_cmdline (/home/demon/src/neovim/build/bin/nvim+0x8956aa)\r\n    #10 0x55690fb98894 in do_source (/home/demon/src/neovim/build/bin/nvim+0x88d894)\r\n    #11 0x55690ff2de0c in source_callback.llvm.13089318507116750427 (/home/demon/src/neovim/build/bin/nvim+0xc22e0c)\r\n    #12 0x55690ff29542 in do_in_path (/home/demon/src/neovim/build/bin/nvim+0xc1e542)\r\n    #13 0x55690ff2e638 in load_plugins (/home/demon/src/neovim/build/bin/nvim+0xc23638)\r\n    #14 0x55690fcedc88 in main (/home/demon/src/neovim/build/bin/nvim+0x9e2c88)\r\n    #15 0x7f35b3000a21 in libc_start_main_stage2 /home/buildozer/aports/main/musl/src/v1.2.3/src/env/__libc_start_main.c:95:2\r\n\r\npreviously allocated by thread T0 here:\r\n    #0 0x55690f8ab9ce in __interceptor_malloc /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/asan_malloc_linux.cpp:69:3\r\n    #1 0x55690fd693f9 in xmalloc (/home/demon/src/neovim/build/bin/nvim+0xa5e3f9)\r\n    #2 0x55690fd69657 in xmallocz (/home/demon/src/neovim/build/bin/nvim+0xa5e657)\r\n    #3 0x55690fe2c8d0 in set_option_value (/home/demon/src/neovim/build/bin/nvim+0xb218d0)\r\n    #4 0x55690ff31041 in add_pack_dir_to_rtp (/home/demon/src/neovim/build/bin/nvim+0xc26041)\r\n    #5 0x55690ff2e18f in add_pack_start_dir (/home/demon/src/neovim/build/bin/nvim+0xc2318f)\r\n    #6 0x55690ff29635 in do_in_path (/home/demon/src/neovim/build/bin/nvim+0xc1e635)\r\n    #7 0x55690ff2e418 in ex_packloadall (/home/demon/src/neovim/build/bin/nvim+0xc23418)\r\n    #8 0x55690fba79fa in do_one_cmd (/home/demon/src/neovim/build/bin/nvim+0x89c9fa)\r\n    #9 0x55690fba06aa in do_cmdline (/home/demon/src/neovim/build/bin/nvim+0x8956aa)\r\n    #10 0x55690f905c3d in nlua_api_nvim_command (/home/demon/src/neovim/build/bin/nvim+0x5fac3d)\r\n    #11 0x7f35b2ec6f74  (/usr/lib/libluajit-5.1.so.2+0xaf74)\r\n\r\nSUMMARY: AddressSanitizer: heap-use-after-free /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.0.src/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5 in strlen\r\nShadow bytes around the buggy address:\r\n  0x0c2c80006120: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80006130: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80006140: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80006150: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80006160: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n=>0x0c2c80006170:[fd]fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80006180: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c80006190: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c800061a0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c800061b0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c800061c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n==80998==ABORTING\r\n```\r\n\r\n</details>",
            "created_at": "2022-04-30T11:05:40Z",
            "html_url": "https://github.com/neovim/neovim/issues/18315#issuecomment-1113968886",
            "id": 1113968886,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18315",
            "node_id": "IC_kwDOAPphoM5CZdD2",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1113968886/reactions"
            },
            "updated_at": "2022-04-30T11:05:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1113968886",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/102837530?v=4",
                "events_url": "https://api.github.com/users/nekopsykose/events{/privacy}",
                "followers_url": "https://api.github.com/users/nekopsykose/followers",
                "following_url": "https://api.github.com/users/nekopsykose/following{/other_user}",
                "gists_url": "https://api.github.com/users/nekopsykose/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nekopsykose",
                "id": 102837530,
                "login": "nekopsykose",
                "node_id": "U_kgDOBiEtGg",
                "organizations_url": "https://api.github.com/users/nekopsykose/orgs",
                "received_events_url": "https://api.github.com/users/nekopsykose/received_events",
                "repos_url": "https://api.github.com/users/nekopsykose/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nekopsykose/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nekopsykose/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nekopsykose"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I cannot reproduce this with ASAN with glibc, so it might be specific to musl libc",
            "created_at": "2022-05-16T11:09:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/18315#issuecomment-1127535021",
            "id": 1127535021,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18315",
            "node_id": "IC_kwDOAPphoM5DNNGt",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1127535021/reactions"
            },
            "updated_at": "2023-07-18T22:27:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1127535021",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/22473248?v=4",
                "events_url": "https://api.github.com/users/Jesse-Bakker/events{/privacy}",
                "followers_url": "https://api.github.com/users/Jesse-Bakker/followers",
                "following_url": "https://api.github.com/users/Jesse-Bakker/following{/other_user}",
                "gists_url": "https://api.github.com/users/Jesse-Bakker/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Jesse-Bakker",
                "id": 22473248,
                "login": "Jesse-Bakker",
                "node_id": "MDQ6VXNlcjIyNDczMjQ4",
                "organizations_url": "https://api.github.com/users/Jesse-Bakker/orgs",
                "received_events_url": "https://api.github.com/users/Jesse-Bakker/received_events",
                "repos_url": "https://api.github.com/users/Jesse-Bakker/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Jesse-Bakker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Jesse-Bakker/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Jesse-Bakker"
            }
        },
        {
            "author_association": "NONE",
            "body": "a slightly better asan with debug symbols:  \r\n\r\n<details>\r\n\r\n<summary> asan </summary>\r\n\r\n```\r\n=================================================================\r\n==60903==ERROR: AddressSanitizer: heap-use-after-free on address 0x616000003380 at pc 0x564702b93b50 bp 0x7ffe0c60a6d0 sp 0x7ffe0c609e98\r\nREAD of size 3 at 0x616000003380 thread T0\r\n    #0 0x564702b93b4f in strlen /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.3.src/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5\r\n    #1 0x5647032c75fc in xstrdup /home/demon/src/neovim/src/nvim/memory.c:424:24\r\n    #2 0x564703662854 in vim_strsave /home/demon/src/neovim/src/nvim/strings.c:56:20\r\n    #3 0x5647034fbcef in do_in_path /home/demon/src/neovim/src/nvim/runtime.c:84:22\r\n    #4 0x564703500c30 in do_in_path_and_pp /home/demon/src/neovim/src/nvim/runtime.c:392:13\r\n    #5 0x564703502f7e in source_in_path /home/demon/src/neovim/src/nvim/runtime.c:645:10\r\n    #6 0x564703503595 in load_plugins /home/demon/src/neovim/src/nvim/runtime.c:960:5\r\n    #7 0x564703211e7a in main /home/demon/src/neovim/src/nvim/main.c:395:3\r\n    #8 0x7fc9efd86a21 in libc_start_main_stage2 /home/buildozer/aports/main/musl/src/v1.2.3/src/env/__libc_start_main.c:95:2\r\n\r\n0x616000003380 is located 0 bytes inside of 638-byte region [0x616000003380,0x6160000035fe)\r\nfreed by thread T0 here:\r\n    #0 0x564702beed3f in __interceptor_free /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.3.src/lib/asan/asan_malloc_linux.cpp:52:3\r\n    #1 0x5647032c6bb4 in xfree /home/demon/src/neovim/src/nvim/memory.c:122:3\r\n    #2 0x5647033cce44 in free_string_option /home/demon/src/neovim/src/nvim/option.c:2107:5\r\n    #3 0x5647033f14fa in did_set_string_option /home/demon/src/neovim/src/nvim/option.c:3296:7\r\n    #4 0x5647033f8abf in set_string_option /home/demon/src/neovim/src/nvim/option.c:2306:19\r\n    #5 0x5647033cb7a5 in set_option_value /home/demon/src/neovim/src/nvim/option.c:5181:14\r\n    #6 0x564703506857 in add_pack_dir_to_rtp /home/demon/src/neovim/src/nvim/runtime.c:798:3\r\n    #7 0x564703506b53 in add_pack_plugin /home/demon/src/neovim/src/nvim/runtime.c:866:11\r\n    #8 0x5647035039c1 in add_opt_pack_plugin /home/demon/src/neovim/src/nvim/runtime.c:884:3\r\n    #9 0x5647034fc4f6 in do_in_path /home/demon/src/neovim/src/nvim/runtime.c:137:15\r\n    #10 0x56470350397b in ex_packadd /home/demon/src/neovim/src/nvim/runtime.c:995:11\r\n    #11 0x564703048651 in do_one_cmd /home/demon/src/neovim/src/nvim/ex_docmd.c:2356:5\r\n    #12 0x56470303db5e in do_cmdline /home/demon/src/neovim/src/nvim/ex_docmd.c:594:20\r\n    #13 0x564703032dfa in do_source /home/demon/src/neovim/src/nvim/ex_cmds2.c:2087:5\r\n    #14 0x564703502f3c in source_callback /home/demon/src/neovim/src/nvim/runtime.c:63:9\r\n    #15 0x5647034fc4f6 in do_in_path /home/demon/src/neovim/src/nvim/runtime.c:137:15\r\n    #16 0x564703500c30 in do_in_path_and_pp /home/demon/src/neovim/src/nvim/runtime.c:392:13\r\n    #17 0x564703502f7e in source_in_path /home/demon/src/neovim/src/nvim/runtime.c:645:10\r\n    #18 0x564703503580 in load_plugins /home/demon/src/neovim/src/nvim/runtime.c:959:5\r\n    #19 0x564703211e7a in main /home/demon/src/neovim/src/nvim/main.c:395:3\r\n    #20 0x7fc9efd86a21 in libc_start_main_stage2 /home/buildozer/apod680 thread T0\r\n    #0 0x55bd556db83a  (/usr/bin/nvim+0x2a883a)\r\n    #1 0x55bd55e13b0c  (/usr/bin/nvim+0x9e0b0c)\r\n    #2 0x55bd561af1d4  (/usr/bin/nvim+0xd7c1d4)\r\n    #3 0x55bd56048d8f  (/usr/bin/nvim+0xc15d8f)\r\n    #4 0x55bd5604dcf0  (/usr/bin/nvim+0xc1acf0)\r\n    #5 0x55bd5605003e  (/usr/bin/nvim+0xc1d03e)\r\n    #6 0x55bd56050655  (/usr/bin/nvim+0xc1d655)\r\n    #7 0x55bd55d5e08f  (/usr/bin/nvim+0x92b08f)\r\n    #8 0x7f03aeae528f  (/usr/lib/libc.so.6+0x2928f)\r\n    #9 0x7f03aeae5349  (/usr/lib/libc.so.6+0x29349)\r\n    #10 0x55bd556908f4  (/usr/bin/nvim+0x25d8f4)\r\n\r\n0x61300002d680 is located 0 bytes inside of 382-byte region [0x61300002d680,0x61300002d7fe)\r\nfreed by thread T0 here:\r\n    #0 0x55bd5573b2b9  (/usr/bin/nvim+0x3082b9)\r\n    #1 0x55bd55e130a4  (/usr/bin/nvim+0x9e00a4)\r\n    #2 0x55bd55f197b4  (/usr/bin/nvim+0xae67b4)\r\n    #3 0x55bd55f3de9a  (/usr/bin/nvim+0xb0ae9a)\r\n    #4 0x55bd55f4545f  (/usr/bin/nvim+0xb1245f)\r\n    #5 0x55bd55f18115  (/usr/bin/nvim+0xae5115)rts/main/musl/src/v1.2.3/src/env/__libc_start_main.c:95:2\r\n\r\npreviously allocated by thread T0 here:\r\n    #0 0x564702beee79 in malloc /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.3.src/lib/asan/asan_malloc_linux.cpp:69:3\r\n    #1 0x5647032c6952 in try_malloc /home/demon/src/neovim/src/nvim/memory.c:74:15\r\n    #2 0x5647032c6af4 in xmalloc /home/demon/src/neovim/src/nvim/memory.c:108:15\r\n    #3 0x5647032c6ecb in xmallocz /home/demon/src/neovim/src/nvim/memory.c:187:15\r\n    #4 0x5647032c6f38 in xmemdupz /home/demon/src/neovim/src/nvim/memory.c:205:17\r\n    #5 0x5647032c7608 in xstrdup /home/demon/src/neovim/src/nvim/memory.c:424:10\r\n    #6 0x5647033f873c in set_string_option /home/demon/src/neovim/src/nvim/option.c:2283:19\r\n    #7 0x5647033cb7a5 in set_option_value /home/demon/src/neovim/src/nvim/option.c:5181:14\r\n    #8 0x564703506857 in add_pack_dir_to_rtp /home/demon/src/neovim/src/nvim/runtime.c:798:3\r\n    #9 0x5647035031c9 in add_pack_start_dir /home/demon/src/neovim/src/nvim/runtime.c:916:7\r\n    #10 0x5647034fc084 in do_in_path /home/demon/src/neovim/src/nvim/runtime.c:111:9\r\n    #11 0x564703502fda in add_pack_start_dirs /home/demon/src/neovim/src/nvim/runtime.c:891:3\r\n    #12 0x56470350342c in ex_packloadall /home/demon/src/neovim/src/nvim/runtime.c:940:5\r\n    #13 0x564703048651 in do_one_cmd /home/demon/src/neovim/src/nvim/ex_docmd.c:2356:5\r\n    #14 0x56470303db5e in do_cmdline /home/demon/src/neovim/src/nvim/ex_docmd.c:594:20\r\n    #15 0x564703040ff0 in do_cmdline_cmd /home/demon/src/neovim/src/nvim/ex_docmd.c:280:10\r\n    #16 0x564702d888ee in nvim_command /home/demon/src/neovim/src/nvim/api/vimscript.c:114:3\r\n    #17 0x564702c5a864 in nlua_api_nvim_command /home/demon/src/neovim/build/src/nvim/auto/lua_api_c_bindings.generated.c:5282:3\r\n    #18 0x7fc9efc4cf74  (/usr/lib/libluajit-5.1.so.2+0xaf74)\r\n\r\nSUMMARY: AddressSanitizer: heap-use-after-free /home/demon/src/aports/main/compiler-rt/src/compiler-rt-14.0.3.src/lib/asan/../sanitizer_common/sanitizer_common_interceptors.inc:389:5 in strlen\r\nShadow bytes around the buggy address:\r\n  0x0c2c7fff8620: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff8630: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff8640: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff8650: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff8660: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n=>0x0c2c7fff8670:[fd]fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff8680: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff8690: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff86a0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff86b0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x0c2c7fff86c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n==60903==ABORTING\r\n```\r\n\r\n</details>\r\n\r\ni deduced that this actually doesn't happen with no config, but is the cause of calling  \r\n\r\n```\r\nvim.api.nvim_command(\"packloadall\")\r\n```\r\n\r\nwith a plugin directory with a bunch of plugins in it. the list of plugins is generated with packer:  \r\n\r\n```lua\r\nlocal execute = vim.api.nvim_command\r\nlocal fn = vim.fn\r\nlocal install_path = fn.stdpath(\"data\") .. \"/site/pack/packer/start/packer.nvim\"\r\n\r\nif fn.empty(fn.glob(install_path)) > 0 then\r\n  execute(\"!git clone https://github.com/wbthomason/packer.nvim \" .. install_path)\r\n  execute(\"packadd packer.nvim\")\r\nend\r\n\r\nlocal packages = function(use)\r\n  use(\"srcery-colors/srcery-vim\")\r\n\r\n  use({\r\n    \"nvim-treesitter/nvim-treesitter\",\r\n    requires = { \"nvim-treesitter/nvim-treesitter-textobjects\" },\r\n    run = \":TSUpdate\",\r\n  })\r\n\r\n  use({\r\n    \"nvim-telescope/telescope.nvim\",\r\n    wants = {},\r\n    requires = {\r\n      { \"nvim-lua/popup.nvim\" },\r\n      { \"nvim-lua/plenary.nvim\" },\r\n      { \"kyazdani42/nvim-web-devicons\" },\r\n      { \"tami5/sql.nvim\" },\r\n    },\r\n  })\r\n\r\n  use(\"tpope/vim-surround\")\r\n  use(\"tpope/vim-commentary\")\r\n\r\n  use(\"editorconfig/editorconfig-vim\")\r\n  use(\"tpope/vim-sleuth\")\r\n\r\n  use(\"neomake/neomake\")\r\n  use(\"sbdchd/neoformat\")\r\n\r\n  use(\"mhinz/vim-startify\")\r\n  use(\"svermeulen/vimpeccable\")\r\n\r\n  use(\"hrsh7th/cmp-buffer\")\r\n  use(\"hrsh7th/cmp-calc\")\r\n  use(\"hrsh7th/cmp-cmdline\")\r\n  use(\"hrsh7th/cmp-nvim-lsp\")\r\n  use(\"hrsh7th/cmp-nvim-lua\")\r\n  use(\"hrsh7th/cmp-path\")\r\n  use(\"hrsh7th/nvim-cmp\")\r\n  use(\"hrsh7th/vim-vsnip\")\r\n  use(\"ray-x/cmp-treesitter\")\r\n  use(\"uga-rosa/cmp-dictionary\")\r\n\r\n  use(\"neovim/nvim-lspconfig\")\r\n  use(\"nvim-lua/lsp_extensions.nvim\")\r\n\r\n  use(\"wbthomason/packer.nvim\")\r\nend\r\n\r\nrequire(\"packer\").startup({ packages })\r\n```\r\n\r\nafter even not sourcing this plugins.lua file anymore, and having an empty init.lua with only the `vim.api.nvim_command(\"packloadall\")`, it then crashes in asan with the above.  \r\n\r\ni managed to reproduce this on arch linux (glibc), with:  \r\n\r\n- clone latest master (14d653b421d3ee4e0d641e45e67dafe43809e502 for me)   \r\n- `CFLAGS=\"-fsanitize=address -O0 -g3\" CC=clang cmake -B build -G Ninja -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=/usr`\r\n- `ASAN_OPTIONS=halt_on_error=0 cmake --build build`\r\n- `cmake --install build`\r\n- copy packer config above to ~/.config/nvim/init.lua\r\n- run `:PackerSync`, perhaps more than once to make sure everything is up to date\r\n- add an innocent `vim.api.nvim_command(\"packloadall\")` at the bottom of the same init.lua file. you can even delete everything in it and leave only the packloadall.\r\n- open `nvim` again.\r\n\r\nsadly i cannot get a better debug asan trace on arch for some reason, the above one is still from alpine. but i would imagine it's the same issue. or is perhaps calling packloadall like this not allowed? (i call it early somewhere in some other part of the config, of which i trimmed everything down to this minimal repro)",
            "created_at": "2022-05-16T12:38:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/18315#issuecomment-1127621531",
            "id": 1127621531,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18315",
            "node_id": "IC_kwDOAPphoM5DNiOb",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1127621531/reactions"
            },
            "updated_at": "2022-05-16T12:44:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1127621531",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/102837530?v=4",
                "events_url": "https://api.github.com/users/nekopsykose/events{/privacy}",
                "followers_url": "https://api.github.com/users/nekopsykose/followers",
                "following_url": "https://api.github.com/users/nekopsykose/following{/other_user}",
                "gists_url": "https://api.github.com/users/nekopsykose/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nekopsykose",
                "id": 102837530,
                "login": "nekopsykose",
                "node_id": "U_kgDOBiEtGg",
                "organizations_url": "https://api.github.com/users/nekopsykose/orgs",
                "received_events_url": "https://api.github.com/users/nekopsykose/received_events",
                "repos_url": "https://api.github.com/users/nekopsykose/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nekopsykose/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nekopsykose/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nekopsykose"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I managed to find a repro for this, however, it doesn't seem to work after 516b173:\r\n\r\n```\r\nmkdir plugin/\r\necho 'let &rtp=&rtp' > plugin/foo.vim\r\nnvim --clean --cmd 'set rtp+=. | packloadall!'\r\n```\r\n\r\nThis seems to be caused by a `:packloadall` that's run before `plugin/` files are sourced, where one of the sourced plugin files changes `&rtp` (which causes `p_rtp` to be freed while `rtp_copy` in `load_plugins()` still points to it, because it wasn't `xstrdup()`'d as `did_source_packages == true` from `:packloadall`).\r\n\r\nI haven't quite looked into why that commit fixes this yet, though.\r\n\r\n<details>\r\n<summary>ASAN from commit prior to 516b173</summary>\r\n\r\n```\r\n=================================================================\r\n==540315==ERROR: AddressSanitizer: heap-use-after-free on address 0x614000002040 at pc 0x00000048f96d bp 0x7ffc47bd7cf0 sp 0x7ffc47bd74b8\r\nREAD of size 3 at 0x614000002040 thread T0\r\n    #0 0x48f96c in strlen (neovim/build/bin/nvim+0x48f96c) (BuildId: a69f9aa09dbc7ebbd0690cd91590492f5ad407a2)\r\n    #1 0x135454c in xstrdup neovim/src/nvim/memory.c:431:24\r\n    #2 0x18577a5 in do_in_path neovim/src/nvim/runtime.c:293:20\r\n    #3 0x185f821 in do_in_path_and_pp neovim/src/nvim/runtime.c:597:13\r\n    #4 0x1862f71 in source_in_path neovim/src/nvim/runtime.c:847:10\r\n    #5 0x1863981 in load_plugins neovim/src/nvim/runtime.c:1169:5\r\n    #6 0x55271f in main neovim/src/nvim/main.c:460:3\r\n    #7 0x7f116f6bfb49 in __libc_start_call_main (/lib64/libc.so.6+0x27b49) (BuildId: 245240a31888ad5c11bbc55b18e02d87388f59a9)\r\n    #8 0x7f116f6bfc0a in __libc_start_main@GLIBC_2.2.5 (/lib64/libc.so.6+0x27c0a) (BuildId: 245240a31888ad5c11bbc55b18e02d87388f59a9)\r\n    #9 0x478fd4 in _start (neovim/build/bin/nvim+0x478fd4) (BuildId: a69f9aa09dbc7ebbd0690cd91590492f5ad407a2)\r\n\r\n0x614000002040 is located 0 bytes inside of 426-byte region [0x614000002040,0x6140000021ea)\r\nfreed by thread T0 here:\r\n    #0 0x51397a in free (neovim/build/bin/nvim+0x51397a) (BuildId: a69f9aa09dbc7ebbd0690cd91590492f5ad407a2)\r\n    #1 0x1352cd9 in xfree neovim/src/nvim/memory.c:134:3\r\n    #2 0x16195a8 in free_string_option neovim/src/nvim/optionstr.c:285:5\r\n    #3 0x163738e in did_set_string_option_for neovim/src/nvim/optionstr.c:2123:7\r\n    #4 0x161b919 in did_set_string_option neovim/src/nvim/optionstr.c:2181:10\r\n    #5 0x161b20f in set_string_option neovim/src/nvim/optionstr.c:449:30\r\n    #6 0x15b879d in set_option_value neovim/src/nvim/option.c:3766:14\r\n    #7 0x159df62 in set_option_value_give_err neovim/src/nvim/option.c:3781:24\r\n    #8 0x187e165 in add_pack_dir_to_rtp neovim/src/nvim/runtime.c:1009:3\r\n    #9 0x187e55b in add_pack_plugin neovim/src/nvim/runtime.c:1077:11\r\n    #10 0x1864061 in add_opt_pack_plugin neovim/src/nvim/runtime.c:1095:3\r\n    #11 0x1858322 in do_in_path neovim/src/nvim/runtime.c:346:15\r\n    #12 0x1863fd6 in ex_packadd neovim/src/nvim/runtime.c:1205:7\r\n    #13 0xe77524 in execute_cmd0 neovim/src/nvim/ex_docmd.c:1634:7\r\n    #14 0xe53229 in do_one_cmd neovim/src/nvim/ex_docmd.c:2293:7\r\n    #15 0xe431da in do_cmdline neovim/src/nvim/ex_docmd.c:592:20\r\n    #16 0x186f7c1 in do_source neovim/src/nvim/runtime.c:2159:5\r\n    #17 0x1862f30 in source_callback neovim/src/nvim/runtime.c:274:9\r\n    #18 0x1858322 in do_in_path neovim/src/nvim/runtime.c:346:15\r\n    #19 0x185f821 in do_in_path_and_pp neovim/src/nvim/runtime.c:597:13\r\n    #20 0x1862f71 in source_in_path neovim/src/nvim/runtime.c:847:10\r\n    #21 0x1863969 in load_plugins neovim/src/nvim/runtime.c:1168:5\r\n    #22 0x55271f in main neovim/src/nvim/main.c:460:3\r\n    #23 0x7f116f6bfb49 in __libc_start_call_main (/lib64/libc.so.6+0x27b49) (BuildId: 245240a31888ad5c11bbc55b18e02d87388f59a9)\r\n    #24 0x7f116f6bfc0a in __libc_start_main@GLIBC_2.2.5 (/lib64/libc.so.6+0x27c0a) (BuildId: 245240a31888ad5c11bbc55b18e02d87388f59a9)\r\n    #25 0x478fd4 in _start (neovim/build/bin/nvim+0x478fd4) (BuildId: a69f9aa09dbc7ebbd0690cd91590492f5ad407a2)\r\n\r\npreviously allocated by thread T0 here:\r\n    #0 0x513c22 in __interceptor_malloc (neovim/build/bin/nvim+0x513c22) (BuildId: a69f9aa09dbc7ebbd0690cd91590492f5ad407a2)\r\n    #1 0x1352a27 in try_malloc neovim/src/nvim/memory.c:88:15\r\n    #2 0x1352c1c in xmalloc neovim/src/nvim/memory.c:122:15\r\n    #3 0x1612a83 in stropt_copy_value neovim/src/nvim/option.c:950:18\r\n    #4 0x1610689 in stropt_get_newval neovim/src/nvim/option.c:1112:14\r\n    #5 0x160ede3 in do_set_option_string neovim/src/nvim/option.c:1210:18\r\n    #6 0x160bf6e in do_set_option_value neovim/src/nvim/option.c:1416:5\r\n    #7 0x15ad380 in do_set_option neovim/src/nvim/option.c:1564:3\r\n    #8 0x15a6fd7 in do_set neovim/src/nvim/option.c:1614:9\r\n    #9 0x15a6428 in ex_set neovim/src/nvim/option.c:747:9\r\n    #10 0xe77524 in execute_cmd0 neovim/src/nvim/ex_docmd.c:1634:7\r\n    #11 0xe53229 in do_one_cmd neovim/src/nvim/ex_docmd.c:2293:7\r\n    #12 0xe431da in do_cmdline neovim/src/nvim/ex_docmd.c:592:20\r\n    #13 0xe486c0 in do_cmdline_cmd neovim/src/nvim/ex_docmd.c:291:10\r\n    #14 0x56942b in exe_pre_commands neovim/src/nvim/main.c:1884:5\r\n    #15 0x5524dd in main neovim/src/nvim/main.c:438:3\r\n    #16 0x7f116f6bfb49 in __libc_start_call_main (/lib64/libc.so.6+0x27b49) (BuildId: 245240a31888ad5c11bbc55b18e02d87388f59a9)\r\n    #17 0x7f116f6bfc0a in __libc_start_main@GLIBC_2.2.5 (/lib64/libc.so.6+0x27c0a) (BuildId: 245240a31888ad5c11bbc55b18e02d87388f59a9)\r\n    #18 0x478fd4 in _start (neovim/build/bin/nvim+0x478fd4) (BuildId: a69f9aa09dbc7ebbd0690cd91590492f5ad407a2)\r\n\r\nSUMMARY: AddressSanitizer: heap-use-after-free (neovim/build/bin/nvim+0x48f96c) (BuildId: a69f9aa09dbc7ebbd0690cd91590492f5ad407a2) in strlen\r\nShadow bytes around the buggy address:\r\n  0x614000001d80: fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa fa\r\n  0x614000001e00: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00\r\n  0x614000001e80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x614000001f00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x614000001f80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa\r\n=>0x614000002000: fa fa fa fa fa fa fa fa[fd]fd fd fd fd fd fd fd\r\n  0x614000002080: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x614000002100: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\n  0x614000002180: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa fa\r\n  0x614000002200: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd\r\n  0x614000002280: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n==540315==ABORTING\r\n```\r\n\r\n</details>",
            "created_at": "2023-07-18T22:09:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/18315#issuecomment-1641057131",
            "id": 1641057131,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18315",
            "node_id": "IC_kwDOAPphoM5h0Itr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641057131/reactions"
            },
            "updated_at": "2023-07-18T22:38:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641057131",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6256228?v=4",
                "events_url": "https://api.github.com/users/seandewar/events{/privacy}",
                "followers_url": "https://api.github.com/users/seandewar/followers",
                "following_url": "https://api.github.com/users/seandewar/following{/other_user}",
                "gists_url": "https://api.github.com/users/seandewar/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seandewar",
                "id": 6256228,
                "login": "seandewar",
                "node_id": "MDQ6VXNlcjYyNTYyMjg=",
                "organizations_url": "https://api.github.com/users/seandewar/orgs",
                "received_events_url": "https://api.github.com/users/seandewar/received_events",
                "repos_url": "https://api.github.com/users/seandewar/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seandewar/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seandewar/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seandewar"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I think this is because `rtp_copy` is now only used once, before any plugin code is executed. Before https://github.com/neovim/neovim/commit/516b173780e39de3ce1e4525f0a8f0ff250c992b it was used twice, and the heap-use-after-free happens the second time it is used.",
            "created_at": "2023-07-18T22:24:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/18315#issuecomment-1641069374",
            "id": 1641069374,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18315",
            "node_id": "IC_kwDOAPphoM5h0Ls-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641069374/reactions"
            },
            "updated_at": "2023-07-18T22:26:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641069374",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Ah. Given that, I can't think of another way to repro this in `load_plugins()`. Maybe this can be considered fixed now?",
            "created_at": "2023-07-18T22:44:47Z",
            "html_url": "https://github.com/neovim/neovim/issues/18315#issuecomment-1641084736",
            "id": 1641084736,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18315",
            "node_id": "IC_kwDOAPphoM5h0PdA",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641084736/reactions"
            },
            "updated_at": "2023-07-18T22:45:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641084736",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6256228?v=4",
                "events_url": "https://api.github.com/users/seandewar/events{/privacy}",
                "followers_url": "https://api.github.com/users/seandewar/followers",
                "following_url": "https://api.github.com/users/seandewar/following{/other_user}",
                "gists_url": "https://api.github.com/users/seandewar/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/seandewar",
                "id": 6256228,
                "login": "seandewar",
                "node_id": "MDQ6VXNlcjYyNTYyMjg=",
                "organizations_url": "https://api.github.com/users/seandewar/orgs",
                "received_events_url": "https://api.github.com/users/seandewar/received_events",
                "repos_url": "https://api.github.com/users/seandewar/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/seandewar/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seandewar/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/seandewar"
            }
        },
        {
            "author_association": "NONE",
            "body": "thanks!",
            "created_at": "2023-07-18T23:45:02Z",
            "html_url": "https://github.com/neovim/neovim/issues/18315#issuecomment-1641132592",
            "id": 1641132592,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18315",
            "node_id": "IC_kwDOAPphoM5h0bIw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641132592/reactions"
            },
            "updated_at": "2023-07-18T23:45:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641132592",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/102837530?v=4",
                "events_url": "https://api.github.com/users/nekopsykose/events{/privacy}",
                "followers_url": "https://api.github.com/users/nekopsykose/followers",
                "following_url": "https://api.github.com/users/nekopsykose/following{/other_user}",
                "gists_url": "https://api.github.com/users/nekopsykose/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nekopsykose",
                "id": 102837530,
                "login": "nekopsykose",
                "node_id": "U_kgDOBiEtGg",
                "organizations_url": "https://api.github.com/users/nekopsykose/orgs",
                "received_events_url": "https://api.github.com/users/nekopsykose/received_events",
                "repos_url": "https://api.github.com/users/nekopsykose/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nekopsykose/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nekopsykose/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nekopsykose"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/18315/comments",
    "created_at": "2022-04-30T10:50:37Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/18315/events",
    "html_url": "https://github.com/neovim/neovim/issues/18315",
    "id": 1221801697,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "funtime",
            "id": 120251370,
            "name": "runtime",
            "node_id": "MDU6TGFiZWwxMjAyNTEzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/runtime"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains minimal reproducing steps",
            "id": 435851959,
            "name": "has:repro",
            "node_id": "MDU6TGFiZWw0MzU4NTE5NTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:repro"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains a stacktrace/ASAN log",
            "id": 435854079,
            "name": "has:backtrace",
            "node_id": "MDU6TGFiZWw0MzU4NTQwNzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:backtrace"
        },
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "Nvim startup sequence (`:h startup`)",
            "id": 870629450,
            "name": "startup",
            "node_id": "MDU6TGFiZWw4NzA2Mjk0NTA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/startup"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/18315/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5I0zbh",
    "number": 18315,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/18315/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/18315/timeline",
    "title": "segfault on startup in do_in_path",
    "updated_at": "2023-07-18T23:45:02Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/18315",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/102837530?v=4",
        "events_url": "https://api.github.com/users/nekopsykose/events{/privacy}",
        "followers_url": "https://api.github.com/users/nekopsykose/followers",
        "following_url": "https://api.github.com/users/nekopsykose/following{/other_user}",
        "gists_url": "https://api.github.com/users/nekopsykose/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/nekopsykose",
        "id": 102837530,
        "login": "nekopsykose",
        "node_id": "U_kgDOBiEtGg",
        "organizations_url": "https://api.github.com/users/nekopsykose/orgs",
        "received_events_url": "https://api.github.com/users/nekopsykose/received_events",
        "repos_url": "https://api.github.com/users/nekopsykose/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/nekopsykose/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/nekopsykose/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/nekopsykose"
    }
}