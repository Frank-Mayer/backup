{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nneovim crashed with\n```corrupted unsorted chunks```\nI have tried my best to narrow it down in four plugins,can not cut down any plugins.\nHere is my init.lua:\n```lua\nlocal plugins_path = vim.fn.stdpath(\"data\") .. \"/lazy\"\n\nlocal function boot(name, url)\n\tlocal package_path = plugins_path .. \"/\" .. name\n\tif not vim.uv.fs_stat(package_path) then\n\t\tvim.fn.system({\n\t\t\t\"git\",\n\t\t\t\"clone\",\n\t\t\t\"--filter=blob:none\",\n\t\t\t\"--single-branch\",\n\t\t\turl,\n\t\t\tpackage_path,\n\t\t})\n\tend\n\tvim.opt.runtimepath:prepend(package_path)\nend\n\nboot(\"lazy.nvim\", \"https://github.com/folke/lazy.nvim.git\")\nrequire(\"lazy\").setup({\n\tspec = {\n\t\t{\n\t\t\t\"rebelot/heirline.nvim\",\n\t\t\topts = {\n\t\t\t\tstatusline = {\n\t\t\t\t\t{\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprovider = function()\n\t\t\t\t\t\t\t\trequire(\"orgmode.api\").load()\n\t\t\t\t\t\t\tend,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\t\"folke/noice.nvim\",\n\t\t\tconfig = true,\n\t\t\tevent = \"VeryLazy\",\n\t\t},\n\t\t{\n\t\t\t\"nvim-orgmode/orgmode\",\n\t\t\tconfig = true,\n\t\t},\n\t},\n})\n```\ncrash on 0.10.2/nightly btw.\n\n### Steps to reproduce\n\njust run nvim\nand then crash\n\n### Expected behavior\n\nno crash\n\n### Nvim version (nvim -v)\n\nNVIM v0.11.0-dev LuaJIT 2.1.1713773202\n\n### Vim (not Nvim) behaves the same?\n\nno\n\n### Operating system/version\n\nnixos 25.05.20241115.5e4fbfb (Warbler)\n\n### Terminal name/version\n\nckitty 0.37.0\n\n### $TERM environment variable\n\ntmux-256color\n\n### Installation\n\ninstall from neovim-nightly-overlay",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "With the steps I get:\n```\nNo parser for language \"org\"\n```",
            "created_at": "2024-11-18T13:44:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483091034",
            "id": 2483091034,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UAPZa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483091034/reactions"
            },
            "updated_at": "2024-11-18T13:44:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483091034",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> With the steps I get:\n> \n> ```\n> No parser for language \"org\"\n> ```\n\nIt's a expected message if you are using nightly version...\ntry 0.10.2 first and then you can reproduce it with stable and nightly version",
            "created_at": "2024-11-18T13:46:34Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483097731",
            "id": 2483097731,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UARCD",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483097731/reactions"
            },
            "updated_at": "2024-11-18T13:46:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483097731",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/165387956?v=4",
                "events_url": "https://api.github.com/users/rogtino/events{/privacy}",
                "followers_url": "https://api.github.com/users/rogtino/followers",
                "following_url": "https://api.github.com/users/rogtino/following{/other_user}",
                "gists_url": "https://api.github.com/users/rogtino/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rogtino",
                "id": 165387956,
                "login": "rogtino",
                "node_id": "U_kgDOCduetA",
                "organizations_url": "https://api.github.com/users/rogtino/orgs",
                "received_events_url": "https://api.github.com/users/rogtino/received_events",
                "repos_url": "https://api.github.com/users/rogtino/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rogtino/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rogtino/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rogtino",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "`corrupted unsorted chunks` does not appear in this codebase. What do you mean by \"crash\"? Where is the backtrace? ",
            "created_at": "2024-11-18T14:12:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483161626",
            "id": 2483161626,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UAgoa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483161626/reactions"
            },
            "updated_at": "2024-11-18T14:12:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483161626",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "It has no response and then exit like this:\n![Image](https://github.com/user-attachments/assets/77656743-d108-4775-970e-5be4cf7989ca)\n[backtrace.txt](https://github.com/user-attachments/files/17801851/backtrace.txt)\n",
            "created_at": "2024-11-18T14:26:08Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483207794",
            "id": 2483207794,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UAr5y",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483207794/reactions"
            },
            "updated_at": "2024-11-18T14:33:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483207794",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/165387956?v=4",
                "events_url": "https://api.github.com/users/rogtino/events{/privacy}",
                "followers_url": "https://api.github.com/users/rogtino/followers",
                "following_url": "https://api.github.com/users/rogtino/following{/other_user}",
                "gists_url": "https://api.github.com/users/rogtino/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rogtino",
                "id": 165387956,
                "login": "rogtino",
                "node_id": "U_kgDOCduetA",
                "organizations_url": "https://api.github.com/users/rogtino/orgs",
                "received_events_url": "https://api.github.com/users/rogtino/received_events",
                "repos_url": "https://api.github.com/users/rogtino/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rogtino/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rogtino/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rogtino",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Please use a Debug build of Nvim (and its dependencies). Almost surely, this is the fault of the tree-sitter-org parser (which orgmode uses a forked version of).",
            "created_at": "2024-11-18T14:42:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483250930",
            "id": 2483250930,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UA2by",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483250930/reactions"
            },
            "updated_at": "2024-11-18T14:42:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483250930",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> `corrupted unsorted chunks` does not appear in this codebase. What do you mean by \"crash\"? Where is the backtrace?\n\nThis is from glibc when heap meta-data is corrupted (usually by writing beyond the allocated buffer).",
            "created_at": "2024-11-18T14:56:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483292394",
            "id": 2483292394,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UBAjq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483292394/reactions"
            },
            "updated_at": "2024-11-18T14:56:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483292394",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The issue template literally includes: \"Please do not include a package manager in the reproduction steps.\". Including a package manager makes it more difficult for developers to debug so please don't do it.",
            "created_at": "2024-11-18T15:10:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483328743",
            "id": 2483328743,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UBJbn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483328743/reactions"
            },
            "updated_at": "2024-11-18T15:10:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483328743",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I have tried my best to narrow it down in four plugins,can not cut down any plugins.\n\nAnd definitely don't include `noice`. If, as you say, it is absolutely necessary to reproduce the crash, then this needs to be reported to `noice` (first).\n\nMinimal steps also include the exact file you're opening, and step-by-step instructions starting with `nvim --clean -u minimal.lua` (never install test files into your actual stdpath!)",
            "created_at": "2024-11-18T15:12:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2483335704",
            "id": 2483335704,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UBLIY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483335704/reactions"
            },
            "updated_at": "2024-11-18T15:14:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2483335704",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Why are you calling `require(\"orgmode.api\").load()` as a statusline \"provider\". That function does not seem to return something that you would want in the statusline? In any case it calls `vim.wait()` which creates some kind of infinite event loop through `ui_refresh() -> ui_schedule_refresh()`  when called from a statusline callback expression. I guess we should avoid that.",
            "created_at": "2024-11-18T22:21:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2484254981",
            "id": 2484254981,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UErkF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2484254981/reactions"
            },
            "updated_at": "2024-11-18T22:23:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2484254981",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Not sure what to do with it. Do you remember why [this](https://github.com/neovim/neovim/pull/18375/files#diff-23468d92a00f5092dcc849c220e58d33f524b6c36faa3b12a0e785bbd998ca87L188) change was made @bfredl? reverting that avoids the issue in this repro.",
            "created_at": "2024-11-18T22:42:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2484285442",
            "id": 2484285442,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UEzAC",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2484285442/reactions"
            },
            "updated_at": "2024-11-18T22:42:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2484285442",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> Why are you calling `require(\"orgmode.api\").load()` as a statusline \"provider\". That function does not seem to return something that you would want in the statusline? In any case it calls `vim.wait()` which creates some kind of infinite event loop through `ui_refresh() -> ui_schedule_refresh()` when called from a statusline callback expression. I guess we should avoid that.\n\nI want to show the number of `TODO`s today.\nthe init.lua above removes any useless code.\n<details>\n<summary>\nMy actual statusline config related to <b>orgmode</b> looks like this:\n</summary>\n\n```lua\nOrg = {\n  {\n    hl = 'Special',\n    provider = function()\n      local api = require 'orgmode.api'\n      local files = api.load()\n      local today_all = 0\n      local today_todo = 0\n      for _, file in ipairs(files) do\n        for _, headline in ipairs(file.headlines) do\n          if headline.deadline and headline.deadline:is_today() then\n            if headline.todo_type == 'DONE' then\n              today_todo = today_todo + 1\n            end\n            today_all = 1 + today_all\n          end\n        end\n      end\n      return ' ' .. today_todo .. '/' .. today_all\n    end,\n  },\n  Space,\n\n  {\n    hl = 'DiagnosticError',\n    provider = function()\n      local api = require 'orgmode.api'\n      local files = api.load()\n      local undone = 0\n      for _, file in ipairs(files) do\n        for _, headline in ipairs(file.headlines) do\n          if headline.deadline and headline.deadline:is_past 'day' then\n            if headline.todo_type ~= 'DONE' then\n              undone = undone + 1\n            end\n          end\n        end\n      end\n      return ' ' .. undone\n    end,\n  },\n  update = { 'BufLeave', pattern = '*.org' },\n}\n```\n</details>",
            "created_at": "2024-11-19T02:35:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/31252#issuecomment-2484583029",
            "id": 2484583029,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31252",
            "node_id": "IC_kwDOAPphoM6UF7p1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2484583029/reactions"
            },
            "updated_at": "2024-11-19T02:35:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2484583029",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/165387956?v=4",
                "events_url": "https://api.github.com/users/rogtino/events{/privacy}",
                "followers_url": "https://api.github.com/users/rogtino/followers",
                "following_url": "https://api.github.com/users/rogtino/following{/other_user}",
                "gists_url": "https://api.github.com/users/rogtino/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rogtino",
                "id": 165387956,
                "login": "rogtino",
                "node_id": "U_kgDOCduetA",
                "organizations_url": "https://api.github.com/users/rogtino/orgs",
                "received_events_url": "https://api.github.com/users/rogtino/received_events",
                "repos_url": "https://api.github.com/users/rogtino/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rogtino/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rogtino/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rogtino",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 11,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/31252/comments",
    "created_at": "2024-11-18T13:37:57Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/31252/events",
    "html_url": "https://github.com/neovim/neovim/issues/31252",
    "id": 2668595212,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "We need minimal steps to reproduce the issue",
            "id": 298863445,
            "name": "needs:repro",
            "node_id": "MDU6TGFiZWwyOTg4NjM0NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:repro"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1799626557,
            "name": "treesitter",
            "node_id": "MDU6TGFiZWwxNzk5NjI2NTU3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/treesitter"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/31252/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6fD4gM",
    "number": 31252,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/31252/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/31252/timeline",
    "title": "corrupted unsorted chunks",
    "updated_at": "2024-11-19T02:35:42Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/31252",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/165387956?v=4",
        "events_url": "https://api.github.com/users/rogtino/events{/privacy}",
        "followers_url": "https://api.github.com/users/rogtino/followers",
        "following_url": "https://api.github.com/users/rogtino/following{/other_user}",
        "gists_url": "https://api.github.com/users/rogtino/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/rogtino",
        "id": 165387956,
        "login": "rogtino",
        "node_id": "U_kgDOCduetA",
        "organizations_url": "https://api.github.com/users/rogtino/orgs",
        "received_events_url": "https://api.github.com/users/rogtino/received_events",
        "repos_url": "https://api.github.com/users/rogtino/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/rogtino/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rogtino/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/rogtino",
        "user_view_type": "public"
    }
}