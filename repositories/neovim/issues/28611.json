{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\nWindows Terminal supports OSC52-base copying but not pasting (for security reasons). Using the new OSC52 support in nvim 0.10 works in Windows Terminal however it is very slow (over 10 seconds). The apparent cause of this is that yanking actually first attempts a *paste*, which isn't supported and so times out, and only afterwards performs the copy.\r\n\r\nTherefore, there is a simple way to resolve this problem for users. Instead of the currently recommended configuration to force OSC52 to be used, instead do the following which makes pasting a no-op (since it wouldn't work anyway):\r\n\r\n``` lua\r\nfunction no_paste(reg)\r\n    return function(lines)\r\n        -- Do nothing! We can't paste with OSC52\r\n    end\r\nend\r\n\r\nvim.g.clipboard = {\r\n    name = \"OSC 52\",\r\n    copy = {\r\n         [\"+\"] = require(\"vim.ui.clipboard.osc52\").copy(\"+\"),\r\n         [\"*\"] = require(\"vim.ui.clipboard.osc52\").copy(\"*\"),\r\n    },\r\n    paste = {\r\n        [\"+\"] = no_paste(\"+\"), -- Pasting disabled\r\n        [\"*\"] = no_paste(\"*\"), -- Pasting disabled\r\n    }\r\n}\r\n```\r\n\r\nAfter doing this, copying is immediate. This seems counter intuitive and I don't understand why the paste function is called when yanking (it appears to be called twice: if you replace my `no_paste` function with something that prints out, you'll see it).\r\n\r\nPresumably, this work around would help any other terminal that supports OSC52 copying but not pasting, apparently including wezterm/alacritty, but I have not tested. See also this discussion: #28010 I have also seen this problem [mentioned elsewhere](https://www.reddit.com/r/neovim/comments/17rbbec/neovim_nightly_now_you_can_copy_via_ssh_with/).\r\n\r\n### Steps to reproduce\r\n\r\nUsing Windows Terminal, ssh to a machine with neovim 0.10. (Or any other situation where OSC52 is used.) Run nvim and yank a line of text, `\"+yy`. Neovim then hangs for a second and eventually displays a message that it timed out waiting for a response from the terminal.\r\n\r\n### Expected behavior\r\n\r\nYanking to clipboard should be instantaneous even if paste is not available.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.10.0-dev\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nNo\r\n\r\n### Operating system/version\r\n\r\nWindows 11 (Terminal) / Linux (nvim)\r\n\r\n### Terminal name/version\r\n\r\nWindows Terminal Version: 1.19.10821.0\r\n\r\n### $TERM environment variable\r\n\r\nxterm-256color\r\n\r\n### Installation\r\n\r\nbuild from repo",
    "closed_at": "2024-05-03T18:09:28Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> This seems counter intuitive and I don't understand why the paste function is called when yanking\r\n\r\nHmm. And this happens with `nvim --clean` ?",
            "created_at": "2024-05-03T09:45:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/28611#issuecomment-2092666432",
            "id": 2092666432,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28611",
            "node_id": "IC_kwDOAPphoM58u45A",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2092666432/reactions"
            },
            "updated_at": "2024-05-03T09:45:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2092666432",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "No, it doesn't! Apologies for not checking that before submitting. Must be something in LazyVim then.",
            "created_at": "2024-05-03T18:09:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/28611#issuecomment-2093518330",
            "id": 2093518330,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28611",
            "node_id": "IC_kwDOAPphoM58yI36",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2093518330/reactions"
            },
            "updated_at": "2024-05-03T18:09:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2093518330",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1789527?v=4",
                "events_url": "https://api.github.com/users/tgbrooks/events{/privacy}",
                "followers_url": "https://api.github.com/users/tgbrooks/followers",
                "following_url": "https://api.github.com/users/tgbrooks/following{/other_user}",
                "gists_url": "https://api.github.com/users/tgbrooks/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tgbrooks",
                "id": 1789527,
                "login": "tgbrooks",
                "node_id": "MDQ6VXNlcjE3ODk1Mjc=",
                "organizations_url": "https://api.github.com/users/tgbrooks/orgs",
                "received_events_url": "https://api.github.com/users/tgbrooks/received_events",
                "repos_url": "https://api.github.com/users/tgbrooks/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tgbrooks/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tgbrooks/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tgbrooks"
            }
        },
        {
            "author_association": "NONE",
            "body": "In case anyone ends up here with the same problem, the culprit appears to be the [which-key](https://github.com/folke/which-key.nvim) plugin. This displays the contents of various registers when you type `\"`. But that was triggering the OSC52 paste functionality and hanging everything until the paste timed out, even if you only wanted to yank/copy.",
            "created_at": "2024-05-07T18:24:33Z",
            "html_url": "https://github.com/neovim/neovim/issues/28611#issuecomment-2099048213",
            "id": 2099048213,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28611",
            "node_id": "IC_kwDOAPphoM59HO8V",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2099048213/reactions"
            },
            "updated_at": "2024-05-07T18:24:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2099048213",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1789527?v=4",
                "events_url": "https://api.github.com/users/tgbrooks/events{/privacy}",
                "followers_url": "https://api.github.com/users/tgbrooks/followers",
                "following_url": "https://api.github.com/users/tgbrooks/following{/other_user}",
                "gists_url": "https://api.github.com/users/tgbrooks/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tgbrooks",
                "id": 1789527,
                "login": "tgbrooks",
                "node_id": "MDQ6VXNlcjE3ODk1Mjc=",
                "organizations_url": "https://api.github.com/users/tgbrooks/orgs",
                "received_events_url": "https://api.github.com/users/tgbrooks/received_events",
                "repos_url": "https://api.github.com/users/tgbrooks/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tgbrooks/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tgbrooks/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tgbrooks"
            }
        },
        {
            "author_association": "NONE",
            "body": "@tgbrooks I don't use which-key plugin, but I met the same problem",
            "created_at": "2024-05-29T11:35:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/28611#issuecomment-2137197057",
            "id": 2137197057,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28611",
            "node_id": "IC_kwDOAPphoM5_YwoB",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2137197057/reactions"
            },
            "updated_at": "2024-05-29T11:35:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2137197057",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/25260092?v=4",
                "events_url": "https://api.github.com/users/MrZLeo/events{/privacy}",
                "followers_url": "https://api.github.com/users/MrZLeo/followers",
                "following_url": "https://api.github.com/users/MrZLeo/following{/other_user}",
                "gists_url": "https://api.github.com/users/MrZLeo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MrZLeo",
                "id": 25260092,
                "login": "MrZLeo",
                "node_id": "MDQ6VXNlcjI1MjYwMDky",
                "organizations_url": "https://api.github.com/users/MrZLeo/orgs",
                "received_events_url": "https://api.github.com/users/MrZLeo/received_events",
                "repos_url": "https://api.github.com/users/MrZLeo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MrZLeo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MrZLeo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MrZLeo"
            }
        },
        {
            "author_association": "NONE",
            "body": "I ran into this problem as well with WezTerm and Windows Terminal both using --clean(though I had to make a minimal init for Windows Terminal to force OSC52).\r\n",
            "created_at": "2024-05-30T05:07:13Z",
            "html_url": "https://github.com/neovim/neovim/issues/28611#issuecomment-2138690270",
            "id": 2138690270,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28611",
            "node_id": "IC_kwDOAPphoM5_edLe",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2138690270/reactions"
            },
            "updated_at": "2024-05-30T05:07:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2138690270",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91633986?v=4",
                "events_url": "https://api.github.com/users/zevelix/events{/privacy}",
                "followers_url": "https://api.github.com/users/zevelix/followers",
                "following_url": "https://api.github.com/users/zevelix/following{/other_user}",
                "gists_url": "https://api.github.com/users/zevelix/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zevelix",
                "id": 91633986,
                "login": "zevelix",
                "node_id": "U_kgDOBXY5Qg",
                "organizations_url": "https://api.github.com/users/zevelix/orgs",
                "received_events_url": "https://api.github.com/users/zevelix/received_events",
                "repos_url": "https://api.github.com/users/zevelix/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zevelix/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zevelix/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zevelix"
            }
        },
        {
            "author_association": "NONE",
            "body": "And this happens when yanking not just when pasting? If so, I would recommend modifying the `no_paste` function in my example so that a traceback is printed out whenever paste is performed. That way you can find what's calling `paste`. That's how I figured out it was `which-key` for me.",
            "created_at": "2024-05-30T17:11:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/28611#issuecomment-2140316178",
            "id": 2140316178,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28611",
            "node_id": "IC_kwDOAPphoM5_kqIS",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2140316178/reactions"
            },
            "updated_at": "2024-05-30T17:11:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2140316178",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1789527?v=4",
                "events_url": "https://api.github.com/users/tgbrooks/events{/privacy}",
                "followers_url": "https://api.github.com/users/tgbrooks/followers",
                "following_url": "https://api.github.com/users/tgbrooks/following{/other_user}",
                "gists_url": "https://api.github.com/users/tgbrooks/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tgbrooks",
                "id": 1789527,
                "login": "tgbrooks",
                "node_id": "MDQ6VXNlcjE3ODk1Mjc=",
                "organizations_url": "https://api.github.com/users/tgbrooks/orgs",
                "received_events_url": "https://api.github.com/users/tgbrooks/received_events",
                "repos_url": "https://api.github.com/users/tgbrooks/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tgbrooks/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tgbrooks/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tgbrooks"
            }
        },
        {
            "author_association": "NONE",
            "body": "No, sorry, I didn't read your issue thoroughly enough. My issue is just with things like the :registers command and which-key's `\"` keybind. Since the '+' and '\\*' registers are automatically enabled if a working clipboard tool is found, and, as you mentioned, not all terminals permit querying with OSC 52, I've been experiencing the timeouts. I figure you could get which-key to behave as the registers.lua module sets a string of all register names and then loops through it calling getreg(). Then maybe a workaround would be to just omit those two registers from the string. The :registers command though I don't know as it seems to try to read '+' and '\\*' even when you specify other registers like `:reg 1`",
            "created_at": "2024-05-30T19:51:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/28611#issuecomment-2140763515",
            "id": 2140763515,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/28611",
            "node_id": "IC_kwDOAPphoM5_mXV7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2140763515/reactions"
            },
            "updated_at": "2024-05-30T19:51:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2140763515",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91633986?v=4",
                "events_url": "https://api.github.com/users/zevelix/events{/privacy}",
                "followers_url": "https://api.github.com/users/zevelix/followers",
                "following_url": "https://api.github.com/users/zevelix/following{/other_user}",
                "gists_url": "https://api.github.com/users/zevelix/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zevelix",
                "id": 91633986,
                "login": "zevelix",
                "node_id": "U_kgDOBXY5Qg",
                "organizations_url": "https://api.github.com/users/zevelix/orgs",
                "received_events_url": "https://api.github.com/users/zevelix/received_events",
                "repos_url": "https://api.github.com/users/zevelix/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zevelix/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zevelix/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zevelix"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/28611/comments",
    "created_at": "2024-05-02T16:12:53Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/28611/events",
    "html_url": "https://github.com/neovim/neovim/issues/28611",
    "id": 2275930168,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "d4c5f9",
            "default": false,
            "description": null,
            "id": 109461219,
            "name": "platform:windows",
            "node_id": "MDU6TGFiZWwxMDk0NjEyMTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/platform:windows"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "clipboard, paste",
            "id": 186192409,
            "name": "clipboard",
            "node_id": "MDU6TGFiZWwxODYxOTI0MDk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/clipboard"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue is not fixed but can be circumvented until then",
            "id": 435850181,
            "name": "has:workaround",
            "node_id": "MDU6TGFiZWw0MzU4NTAxODE=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:workaround"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/28611/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6Hp_A4",
    "number": 28611,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/28611/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/28611/timeline",
    "title": "OSC52 very slow in Windows Terminal (workaround provided)",
    "updated_at": "2024-05-30T19:51:53Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/28611",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1789527?v=4",
        "events_url": "https://api.github.com/users/tgbrooks/events{/privacy}",
        "followers_url": "https://api.github.com/users/tgbrooks/followers",
        "following_url": "https://api.github.com/users/tgbrooks/following{/other_user}",
        "gists_url": "https://api.github.com/users/tgbrooks/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tgbrooks",
        "id": 1789527,
        "login": "tgbrooks",
        "node_id": "MDQ6VXNlcjE3ODk1Mjc=",
        "organizations_url": "https://api.github.com/users/tgbrooks/orgs",
        "received_events_url": "https://api.github.com/users/tgbrooks/received_events",
        "repos_url": "https://api.github.com/users/tgbrooks/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tgbrooks/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tgbrooks/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tgbrooks"
    }
}