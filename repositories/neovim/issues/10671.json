{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "When looking into https://github.com/neovim/neovim/issues/9071 I've found that `unibi_from_term` gets called twice usually:\r\nhttps://github.com/neovim/libtermkey/blob/b7fe3af141c53cce71a244282b69ea860452120a/driver-ti.c#L413\r\nhttps://github.com/neovim/neovim/blob/b92a5bc3c4bdfddfc21638556ace6ef3fd90155c/src/nvim/tui/tui.c#L230\r\n\r\nGiven that it pokes at the file system etc it might be nice if this could be done only once, e.g. by re-using the information from libtermkey, or passing the information from Neovim to libtermkey (but currently libtermkey gets it first).",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> it might be nice if this could be done only once, e.g. by re-using the information from libtermkey, or passing the information from Neovim to libtermkey (but currently libtermkey gets it first).\r\n\r\nThat is done in https://github.com/neovim/neovim/pull/9094 . Need to merge that PR, but first need to set up our unibilium fork .",
            "created_at": "2019-08-02T14:31:32Z",
            "html_url": "https://github.com/neovim/neovim/issues/10671#issuecomment-517722832",
            "id": 517722832,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/10671",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzcyMjgzMg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517722832/reactions"
            },
            "updated_at": "2019-08-02T14:31:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517722832",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Appears to only be done for win32 there though?\r\n(assuming you mean https://github.com/neovim/neovim/pull/9094/files#diff-9fe05c714b192fe85bb903baf3355196R54)",
            "created_at": "2019-08-03T13:19:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/10671#issuecomment-517924196",
            "id": 517924196,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/10671",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzkyNDE5Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517924196/reactions"
            },
            "updated_at": "2019-08-03T13:19:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517924196",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9766?v=4",
                "events_url": "https://api.github.com/users/blueyed/events{/privacy}",
                "followers_url": "https://api.github.com/users/blueyed/followers",
                "following_url": "https://api.github.com/users/blueyed/following{/other_user}",
                "gists_url": "https://api.github.com/users/blueyed/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/blueyed",
                "id": 9766,
                "login": "blueyed",
                "node_id": "MDQ6VXNlcjk3NjY=",
                "organizations_url": "https://api.github.com/users/blueyed/orgs",
                "received_events_url": "https://api.github.com/users/blueyed/received_events",
                "repos_url": "https://api.github.com/users/blueyed/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/blueyed/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/blueyed/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/blueyed"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@blueyed yes",
            "created_at": "2019-08-03T13:21:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/10671#issuecomment-517924310",
            "id": 517924310,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/10671",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzkyNDMxMA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517924310/reactions"
            },
            "updated_at": "2019-08-03T13:21:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517924310",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "#9094 is a change to make `libtermkey` use the built-in `terminfo`. Therefore, `unibi_from_term()` is still called twice. I also considered an implementation to pass `unibi_term *` to `libtermkey`, but it was not adopted due to API incompatibility.",
            "created_at": "2019-08-04T06:14:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/10671#issuecomment-517977174",
            "id": 517977174,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/10671",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzk3NzE3NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517977174/reactions"
            },
            "updated_at": "2019-08-04T06:14:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517977174",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11682285?v=4",
                "events_url": "https://api.github.com/users/erw7/events{/privacy}",
                "followers_url": "https://api.github.com/users/erw7/followers",
                "following_url": "https://api.github.com/users/erw7/following{/other_user}",
                "gists_url": "https://api.github.com/users/erw7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/erw7",
                "id": 11682285,
                "login": "erw7",
                "node_id": "MDQ6VXNlcjExNjgyMjg1",
                "organizations_url": "https://api.github.com/users/erw7/orgs",
                "received_events_url": "https://api.github.com/users/erw7/received_events",
                "repos_url": "https://api.github.com/users/erw7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/erw7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/erw7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/erw7"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> #9094 is a change to make `libtermkey` use the built-in `terminfo`. Therefore, `unibi_from_term()` is still called twice.\r\n\r\nYes, but it skips most of the work (\"poking at filesystem\", etc.), right?",
            "created_at": "2019-08-04T11:13:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/10671#issuecomment-517994473",
            "id": 517994473,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/10671",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzk5NDQ3Mw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517994473/reactions"
            },
            "updated_at": "2019-08-04T11:13:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/517994473",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Yes, but it skips most of the work (\"poking at filesystem\", etc.), right?\r\n\r\nI do not understand the meaning of \"porking filesystem\" well, but I don't think #9094 will help this. The implementation examined in #9094  remained [here](https://github.com/neovim/libtermkey/compare/master...erw7:feature-constructor-with-unibi_term). We need an implementation that passes `unibi_term *` like that code to `libtermkey`, or an implementation where` libtermkey` returns `unibi_term *`.",
            "created_at": "2019-08-05T05:40:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/10671#issuecomment-518092949",
            "id": 518092949,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/10671",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUxODA5Mjk0OQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/518092949/reactions"
            },
            "updated_at": "2019-08-09T12:27:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/518092949",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11682285?v=4",
                "events_url": "https://api.github.com/users/erw7/events{/privacy}",
                "followers_url": "https://api.github.com/users/erw7/followers",
                "following_url": "https://api.github.com/users/erw7/following{/other_user}",
                "gists_url": "https://api.github.com/users/erw7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/erw7",
                "id": 11682285,
                "login": "erw7",
                "node_id": "MDQ6VXNlcjExNjgyMjg1",
                "organizations_url": "https://api.github.com/users/erw7/orgs",
                "received_events_url": "https://api.github.com/users/erw7/received_events",
                "repos_url": "https://api.github.com/users/erw7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/erw7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/erw7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/erw7"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> > Yes, but it skips most of the work (\"poking at filesystem\", etc.), right?\r\n> \r\n> I do not understand the meaning of \"porking filesystem\" well, but I don't think #9014 will help this. The implementation examined in #9014 remained [here](https://github.com/neovim/libtermkey/compare/master...erw7:feature-constructor-with-unibi_term). We need an implementation that passes `unibi_term *` like that code to `libtermkey`, or an implementation where` libtermkey` returns `unibi_term *`.\r\n\r\nYeah, that's unlikely to get merged into libtermkey because the change to `driver-csi.c` is awkward. \r\n\r\nI think it would work if we modify unibilium to have something like `unibi_override(unibi_term *unibi)` which forces later calls to `unibi_from_term` to always return the forced `unibi_term` object. It's somewhat ugly, but might be the least-complicated and least amount of code. https://github.com/neovim/neovim/pull/9094/files#r312457100",
            "created_at": "2019-08-09T12:33:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/10671#issuecomment-519901100",
            "id": 519901100,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/10671",
            "node_id": "MDEyOklzc3VlQ29tbWVudDUxOTkwMTEwMA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/519901100/reactions"
            },
            "updated_at": "2019-08-09T12:33:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/519901100",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/10671/comments",
    "created_at": "2019-08-02T10:57:31Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/10671/events",
    "html_url": "https://github.com/neovim/neovim/issues/10671",
    "id": 476122888,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "",
            "id": 392811090,
            "name": "revisit-at-release",
            "node_id": "MDU6TGFiZWwzOTI4MTEwOTA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/revisit-at-release"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/10671/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 601,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Low priority. Not planned for the current target, may be reassigned.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 515,
        "state": "open",
        "title": "backlog",
        "updated_at": "2024-04-01T02:46:11Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "MDU6SXNzdWU0NzYxMjI4ODg=",
    "number": 10671,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/10671/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/10671/timeline",
    "title": "unibi_from_term called twice (via libtermkey and neovim)",
    "updated_at": "2024-03-30T13:13:52Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/10671",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/9766?v=4",
        "events_url": "https://api.github.com/users/blueyed/events{/privacy}",
        "followers_url": "https://api.github.com/users/blueyed/followers",
        "following_url": "https://api.github.com/users/blueyed/following{/other_user}",
        "gists_url": "https://api.github.com/users/blueyed/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/blueyed",
        "id": 9766,
        "login": "blueyed",
        "node_id": "MDQ6VXNlcjk3NjY=",
        "organizations_url": "https://api.github.com/users/blueyed/orgs",
        "received_events_url": "https://api.github.com/users/blueyed/received_events",
        "repos_url": "https://api.github.com/users/blueyed/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/blueyed/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/blueyed/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/blueyed"
    }
}