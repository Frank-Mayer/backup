{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\n![bugged](https://github.com/neovim/neovim/assets/34775764/f3619126-e3ac-41c0-8067-e06326ec64c4)\r\nWhen you split a fold (that has a closed nested fold within it) by inserting (in the middle of the fold) a line with less indentation, the nested fold opens.\r\n\r\nI could not successfully bisect because the old builds cannot be built, but I believe the regression happened when the optimization that I mention below was added.\n\n### Steps to reproduce\n\nnvim --clean [file.txt](https://github.com/neovim/neovim/files/12029406/file.txt)\r\n1. Run \":set foldmethod=indent\" and \":set sw=2\".\r\n2. Open the current fold by typing \"zo\".\r\n3. Under the first line, insert a line with no indent by typing \"o<BS>a<Esc>\".\r\n4. See that the inner fold opened even though it should have stayed closed.\r\n\r\nI also wrote this test:\r\n```diff\r\n--- a/test/functional/editor/fold_spec.lua\r\n+++ b/test/functional/editor/fold_spec.lua\r\n@@ -7,6 +7,7 @@ local expect = helpers.expect\r\n local command = helpers.command\r\n local funcs = helpers.funcs\r\n local eq = helpers.eq\r\n+local neq = helpers.neq\r\n \r\n describe('Folds', function()\r\n   local tempfname = 'Xtest-fold.txt'\r\n@@ -417,4 +418,32 @@ a]], '13m7')\r\n     eq(1, funcs.foldlevel(1))\r\n     eq(1, funcs.foldlevel(2))\r\n   end)\r\n+\r\n+  it(\"doesn't open folds with indent method when inserting lower foldlevel line\", function()\r\n+    insert([[\r\n+      insert under this line\r\n+      keep the lines under this line folded\r\n+        keep this line folded 1\r\n+        keep this line folded 2\r\n+    ]])\r\n+    command('set foldmethod=indent shiftwidth=2')\r\n+    eq(1, funcs.foldlevel(1))\r\n+    eq(1, funcs.foldlevel(2))\r\n+    eq(2, funcs.foldlevel(3))\r\n+    eq(2, funcs.foldlevel(4))\r\n+\r\n+    feed('zo') -- open the outer fold\r\n+\r\n+    -- TODO it seems like the test behaves as if noautoindent is set, but if i\r\n+    -- explicitly set it, the test behaves differently...\r\n+    feed('gg0oa<Esc>') -- TODO\r\n+    --funcs.append(1, 'a')\r\n+\r\n+    eq(1, funcs.foldlevel(1))\r\n+    eq(0, funcs.foldlevel(2))\r\n+    eq(1, funcs.foldlevel(3))\r\n+    eq(2, funcs.foldlevel(4))\r\n+    eq(2, funcs.foldlevel(5))\r\n+    neq(-1, funcs.foldclosed(4)) -- make sure the inner fold is not open\r\n+  end)\r\n end)\r\n```\n\n### Expected behavior\n\n![expected](https://github.com/neovim/neovim/assets/34775764/c0b2714f-f4f9-4836-96eb-2d1337d5956b)\r\nWhen you split a fold (that has a closed nested fold within it) by inserting (in the middle of the fold) a line with less indentation, the nested fold should not open.\r\n\r\nI have found that removing the following optimization fixes the bug, but I'm not sure how important that optimization is.\r\n```diff\r\n--- a/src/nvim/fold.c\r\n+++ b/src/nvim/fold.c\r\n@@ -771,7 +771,7 @@ void clearFolding(win_T *win)\r\n /// The changes in lines from top to bot (inclusive).\r\n void foldUpdate(win_T *wp, linenr_T top, linenr_T bot)\r\n {\r\n-  if (disable_fold_update || State & MODE_INSERT) {\r\n+  if (disable_fold_update) {\r\n     return;\r\n   }\r\n```\n\n### Neovim version (nvim -v)\n\nv0.10.0-dev-659+gbf5703042\n\n### Vim (not Nvim) behaves the same?\n\nNo, vim 9.0.1677\n\n### Operating system/version\n\nLinux\n\n### Terminal name/version\n\nKonsole\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nBuilt from repo",
    "closed_at": "2023-07-21T00:56:10Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks for providing a failing test, that is very helpful. However this is an intentional performance decision, documented in `:help vim_diff` : https://github.com/neovim/neovim/blob/ef94fb69c65bc2e4c67826de6373c202b55b7d5a/runtime/doc/vim_diff.txt#L723-L724\r\n\r\nSee also:\r\n\r\n- https://github.com/neovim/neovim/pull/5299\r\n- https://github.com/neovim/neovim/issues/5055\r\n\r\nThe idea is that immediately-updated folds in insert-mode is not important enough to justify permanent, extremely slow, insert-mode typing. If that performance issue is no longer a problem we could revisit.",
            "created_at": "2023-07-12T16:46:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1632878376",
            "id": 1632878376,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5hU78o",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1632878376/reactions"
            },
            "updated_at": "2023-07-12T16:52:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1632878376",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I thought of a potential second solution that doesn't involve removing the optimization:\r\n```diff\r\n--- a/src/nvim/edit.c\r\n+++ b/src/nvim/edit.c\r\n@@ -347,7 +347,7 @@ static void insert_enter(InsertState *s)\r\n \r\n   pum_check_clear();\r\n \r\n-  foldUpdateAfterInsert();\r\n+  foldUpdate(curwin, (linenr_T)2, (linenr_T)2);\r\n   // When CTRL-C was typed got_int will be set, with the result\r\n   // that the autocommands won't be executed. When mapped got_int\r\n   // is not set, but let's keep the behavior the same.\r\n```\r\nThis fixes the test case from the manual reproduction steps, but it has hardcoded line numbers specific to that case. If somebody else who is more familiar with the source code could generalize the line numbers to the lines that the insertion effected, that would be amazing!\r\n\r\nI had this idea because, during debugging, it seemed like vim always knew the specific line numbers that were changed and was able to call foldSplit() to neatly split the fold without resetting the open/close status of any of the folds. But neovim, instead, just updates the folds across the entire buffer after insertion, without passing any specific line numbers of which lines were effected. I think this loss of information is the cause of the bug.\r\n\r\n@justinmk \r\n> However this is an intentional performance decision\r\n\r\nI see. And thanks for giving background and links about the optimization. That helped me understand it better.\r\nRemoving the optimization was one quick solution I found to fix the bug, but I don't think that it is the only solution (see above), so I think it would be best to not have this bug marked as closed, at least until somebody continues looking into my second solution.\r\nThanks!!",
            "created_at": "2023-07-12T20:09:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1633141233",
            "id": 1633141233,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5hV8Hx",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1633141233/reactions"
            },
            "updated_at": "2023-07-12T20:10:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1633141233",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "You're very welcome to keep looking into your solution (and open a PR), even without an open issue. The point is just that nobody on the team is likely to work on this, because of different priorities. Closing the issue is one way of managing expectations here.",
            "created_at": "2023-07-12T20:19:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1633152452",
            "id": 1633152452,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5hV-3E",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1633152452/reactions"
            },
            "updated_at": "2023-07-12T20:19:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1633152452",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Oh, I understand now. Thanks.",
            "created_at": "2023-07-12T20:21:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1633154928",
            "id": 1633154928,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5hV_dw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1633154928/reactions"
            },
            "updated_at": "2023-07-12T20:21:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1633154928",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I explored my second solution but it does not look feasible because I think you'd have to recreate too much logic for determining which line numbers to pass based on all the different line changes (line addition/deletion, single/multiple line(s)) that could have happened during Insert mode.\r\n\r\nI briefly considered if it would be possible to fix the bug while keeping the logic that simply waits until Insert is over and then updates the folds across the entire buffer, but I do not think it's possible because when the outer fold is truncated (to the line that you inserted with a lower indentation amount), the open/close state of the inner folds below is forgetten because I think those inner folds will be recreated after a new outer fold (that they will now be in) is created below the original outer fold.\r\n\r\nTherefore, removing the optimization is the only solution I see. So I wanted to run performance tests from the original discussion, but the history of this optimization is difficult to follow, and every page I read is lacking in exact reproduction files and steps (although there are performance results and some syntax highlighting rules). I could be missing something, of course, but I simply cannot find any tests to recreate to see if this buggy performance optimization is still making neovim significantly faster. Perhaps other changes made in the past ~7 years have rendered this optimization obsolete.\r\n\r\nI know that probably nobody will work on this, but for the future: Does anybody know how to create a performance test that proves that this optimization is still needed? Thanks.",
            "created_at": "2023-07-18T14:38:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1640356093",
            "id": 1640356093,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5hxdj9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1640356093/reactions"
            },
            "updated_at": "2023-07-18T14:38:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1640356093",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Does anybody know how to create a performance test that proves that this optimization is still needed? \r\n\r\nWe could revert it and see if people complain. What motivated it in the first place was that people were very sensitive to the slowness while using foldmethod=indent. Presumably if it's still an issue then we'll hear from those people.",
            "created_at": "2023-07-18T23:45:52Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1641133158",
            "id": 1641133158,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h0bRm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641133158/reactions"
            },
            "updated_at": "2023-07-18T23:45:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641133158",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> We could revert it and see if people complain.\r\n\r\nThat is what I would do, but I didn't suggest it because I didn't know if you guys would be comfortable doing that.\r\nIf neovim becomes slower in this use case, it should not be any slower than vim anyway (unless there are other differences from vim that would make it so).\r\n\r\nIf you want to do this, I can write the pull request.",
            "created_at": "2023-07-19T01:47:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1641264161",
            "id": 1641264161,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h07Qh",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641264161/reactions"
            },
            "updated_at": "2023-07-19T01:47:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1641264161",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> If neovim becomes slower in this use case, it should not be any slower than vim anyway\r\n\r\nThe point is to be faster than vim. It's a tradeoff. Yes, it makes folds temporarily inaccurate, but ESC updates the folds, right?",
            "created_at": "2023-07-19T12:54:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642032681",
            "id": 1642032681,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h324p",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642032681/reactions"
            },
            "updated_at": "2023-07-19T12:55:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642032681",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> It's a tradeoff. Yes, it makes folds temporarily inaccurate, but ESC updates the folds, right?\r\n\r\nIt's not that the folds are temporarily inaccurate (I have not noticed that) -- it's that when they are updated after ESC is pressed, they are not updated correctly; that is the bug. The bounds / line numbers of all the folds are correct, but the open/close states of some of them get reset. In practice, if you have a large file with lots of nested folds in particular open/close states, this bug can reset (open) tons of them, which is what would happen to me in my todo list file before I removed the optimization.",
            "created_at": "2023-07-19T14:42:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642224562",
            "id": 1642224562,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h4luy",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642224562/reactions"
            },
            "updated_at": "2023-07-19T14:42:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642224562",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "So removing the optimisation is just a workaround for a deeper bug?",
            "created_at": "2023-07-19T15:40:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642327072",
            "id": 1642327072,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h4-wg",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 1,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642327072/reactions"
            },
            "updated_at": "2023-07-19T15:56:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642327072",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> The removing the optimisation is just a workaround for a deeper bug?\r\n\r\nNo. Maybe what I wrote was confusing. Sorry.\r\nRemoving the optimization fixes this bug, and is the only practical way (that I know of) to fix the bug.",
            "created_at": "2023-07-19T15:56:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642351870",
            "id": 1642351870,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h5Ez-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642351870/reactions"
            },
            "updated_at": "2023-07-19T15:56:10Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642351870",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> it's that when they are updated after ESC is pressed, they are not updated correctly; that is the bug.\r\n\r\nSo then we need to update them correctly? Removing the optimisation just seems like a workaround.",
            "created_at": "2023-07-19T15:57:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642354335",
            "id": 1642354335,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h5Faf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642354335/reactions"
            },
            "updated_at": "2023-07-19T15:57:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642354335",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> So then we need to update them correctly? Removing the optimisation just seems like a workaround.\r\n\r\nI thought the same thing and have explored different solutions. If you read my previous comments, the closest non-workaround fix is what I was called the \"second solution\".\r\n\r\nFrom my debugging, this is my conclusion: Vim works because it always knows and passes the exact line numbers for what is changing during Insert mode when it updates the folds. Neovim does not know the line numbers; it just updates folds for all lines after Insert mode is exited. This causes different functions to be run, which recreates some folds instead of splitting them (which would preserve the open/close states). This causes the bug.\r\nIf you wanted to keep the optimization, you'd have to find all the spread-out logic that Vim uses to determine which line numbers to pass when updating the folds, depending on what happened (1 or >1 line added, 1 or >1 line deleted, etc) and recreate all of it where Insert mode ends in Neovim. I hoped that all this logic would be in one place, but if you start tracing where foldUpdate() gets called related to Insert mode in Vim, you will be lead to the calls to the functions changed_lines() and changed_bytes(), which seem to be called in so many different ways with different line number arguments. That's where I stopped.\r\n\r\nSo, yes, it's probably technically possible, but I don't think that the amount of work it would require would make much sense, especially since we don't know if this optimization is currently useful.",
            "created_at": "2023-07-19T16:32:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642405386",
            "id": 1642405386,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h5R4K",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642405386/reactions"
            },
            "updated_at": "2023-07-19T16:34:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642405386",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I'm pretty confident this optimization is useful for `foldmethod=expr` which I think was the main motivation for the change.\r\n\r\nAs well as improving performance, it also stops folds changing whilst you are typing which is often distracting.",
            "created_at": "2023-07-19T16:59:06Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642441386",
            "id": 1642441386,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h5aqq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642441386/reactions"
            },
            "updated_at": "2023-07-19T16:59:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642441386",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I'm pretty confident this optimization is useful for `foldmethod=expr` which I think was the main motivation for the change.\r\n> \r\n> As well as improving performance, it also stops folds changing whilst you are typing which is often distracting.\r\n\r\nSo do you think it would be ok to make the optimization only happen when `foldmethod` does not equal `indent`? In other words, run the optimization (by skipping fold updating during insert mode) but not if `foldmethod` is `indent`.",
            "created_at": "2023-07-19T17:38:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642491533",
            "id": 1642491533,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h5m6N",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642491533/reactions"
            },
            "updated_at": "2023-07-19T17:38:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642491533",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "That might be a reasonable compromise.\n\nWe'll need a good test case added to justify this special casing though.",
            "created_at": "2023-07-19T17:43:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642497579",
            "id": 1642497579,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h5oYr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642497579/reactions"
            },
            "updated_at": "2023-07-19T17:43:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642497579",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> We'll need a good test case added to justify this special casing though.\r\n\r\nCan you explain what you mean? I already wrote a test for this bug. Do you mean some kind of additional performance test?",
            "created_at": "2023-07-19T17:50:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642507077",
            "id": 1642507077,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h5qtF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642507077/reactions"
            },
            "updated_at": "2023-07-19T17:50:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642507077",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Ah yes, that test should be fine.",
            "created_at": "2023-07-19T18:47:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642582724",
            "id": 1642582724,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h59LE",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642582724/reactions"
            },
            "updated_at": "2023-07-19T18:47:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642582724",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Ok, I'll start on a pull request.",
            "created_at": "2023-07-19T19:24:16Z",
            "html_url": "https://github.com/neovim/neovim/issues/24324#issuecomment-1642635271",
            "id": 1642635271,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24324",
            "node_id": "IC_kwDOAPphoM5h6KAH",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642635271/reactions"
            },
            "updated_at": "2023-07-19T19:24:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1642635271",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
                "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/simmsbra/followers",
                "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/simmsbra",
                "id": 34775764,
                "login": "simmsbra",
                "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
                "organizations_url": "https://api.github.com/users/simmsbra/orgs",
                "received_events_url": "https://api.github.com/users/simmsbra/received_events",
                "repos_url": "https://api.github.com/users/simmsbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/simmsbra"
            }
        }
    ],
    "comments": 19,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/24324/comments",
    "created_at": "2023-07-12T16:02:36Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/24324/events",
    "html_url": "https://github.com/neovim/neovim/issues/24324",
    "id": 1801303579,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 2598645343,
            "name": "folds",
            "node_id": "MDU6TGFiZWwyNTk4NjQ1MzQz",
            "url": "https://api.github.com/repos/neovim/neovim/labels/folds"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/24324/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 51,
        "created_at": "2023-05-26T09:57:35Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
            "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
            "followers_url": "https://api.github.com/users/zeertzjq/followers",
            "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
            "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/zeertzjq",
            "id": 35768171,
            "login": "zeertzjq",
            "node_id": "MDQ6VXNlcjM1NzY4MTcx",
            "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
            "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
            "repos_url": "https://api.github.com/users/zeertzjq/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/zeertzjq"
        },
        "description": "",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/38",
        "id": 9446345,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/38/labels",
        "node_id": "MI_kwDOAPphoM4AkCPJ",
        "number": 38,
        "open_issues": 10,
        "state": "open",
        "title": "0.9.2",
        "updated_at": "2023-07-25T19:19:51Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/38"
    },
    "node_id": "I_kwDOAPphoM5rXbYb",
    "number": 24324,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/24324/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/24324/timeline",
    "title": "Splitting a fold by inserting line with less indent resets open/close state of inner folds, with foldmethod=indent",
    "updated_at": "2023-07-25T14:54:45Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/24324",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/34775764?v=4",
        "events_url": "https://api.github.com/users/simmsbra/events{/privacy}",
        "followers_url": "https://api.github.com/users/simmsbra/followers",
        "following_url": "https://api.github.com/users/simmsbra/following{/other_user}",
        "gists_url": "https://api.github.com/users/simmsbra/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/simmsbra",
        "id": 34775764,
        "login": "simmsbra",
        "node_id": "MDQ6VXNlcjM0Nzc1NzY0",
        "organizations_url": "https://api.github.com/users/simmsbra/orgs",
        "received_events_url": "https://api.github.com/users/simmsbra/received_events",
        "repos_url": "https://api.github.com/users/simmsbra/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/simmsbra/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/simmsbra/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/simmsbra"
    }
}