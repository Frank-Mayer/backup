{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nWhen you are in insert mode and you switch focus the window of another process (not another nvim window) you get a focused lost event. When you refocus the window you will not get a focus gained event.\n\n### Steps to reproduce\n\n```\r\nfor name, url in pairs {\r\n  -- ADD PLUGINS _NECESSARY_ TO REPRODUCE THE ISSUE, e.g:\r\n  -- some_plugin = 'https://github.com/author/plugin.nvim'\r\n} do\r\n  local install_path = vim.fn.fnamemodify('nvim_issue/' .. name, ':p')\r\n  if vim.fn.isdirectory(install_path) == 0 then\r\n    vim.fn.system { 'git', 'clone', '--depth=1', url, install_path }\r\n  end\r\n  vim.opt.runtimepath:append(install_path)\r\nend\r\n\r\nvim.opt.number = true\r\nvim.opt.relativenumber = true\r\nvim.api.nvim_create_augroup(\"custom-numbertoggle\", {clear = true})\r\n\r\nvim.api.nvim_create_autocmd({\"FocusGained\"}, {\r\n\tdesc = \"Toggle on relative numbers\",\r\n\tgroup = \"custom-numbertoggle\",\r\n\tcallback = function()\r\n\t\tif vim.opt.number and (vim.fn.mode() ~= 'i') then\r\n\t\t\tvim.opt.relativenumber = true\r\n\t\tend\r\n\tend,\r\n})\r\nvim.api.nvim_create_autocmd({\"FocusLost\"}, {\r\n\tdesc = \"Toggle off relative numbers\",\r\n\tgroup = \"custom-numbertoggle\",\r\n\tcallback = function()\r\n\t\tif vim.opt.number then\r\n\t\t\tvim.opt.relativenumber = false\r\n\t\tend\r\n\tend,\r\n})\r\n\r\n```\r\nadd this to a standalone config, run `nvim --clean -u <the config>`, insert a few blank lines so that you can see what happens to the numbers on the left.\r\nYou can tab to/focus another program and the numbers will become absolute numbers, then if you go back to nvim then you will get relative numbers back. \r\nIf you go into insert mode, then do the exact same procedure you will see the issue. When focusing the second program it will go to absolute numbers, but when you refocus nvim it will not go back to relative line numbers as it should.\r\n\n\n### Expected behavior\n\nrefocusing neovim should produce a focus gained event, even while in insert mode.\n\n### Neovim version (nvim -v)\n\nNVIM v0.10.0\n\n### Vim (not Nvim) behaves the same?\n\nnot sure\n\n### Operating system/version\n\nFedora 40\n\n### Terminal name/version\n\nalacritty 0.13.2\n\n### $TERM environment variable\n\nreproducable on both alacritty or ansi-256color\n\n### Installation\n\nfrom fedora repos",
    "closed_at": "2024-07-10T06:51:54Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Relative numbers aren't enabled because the autocommand has an explicit check `(vim.fn.mode() ~= 'i')`. If you remove this condition it will work.",
            "created_at": "2024-07-10T06:51:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/29642#issuecomment-2219697919",
            "id": 2219697919,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29642",
            "node_id": "IC_kwDOAPphoM6ETeb_",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2219697919/reactions"
            },
            "updated_at": "2024-07-10T06:51:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2219697919",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "NONE",
            "body": "Damn i really should have seen that. I just blindly translated that from vim script, my bad.",
            "created_at": "2024-07-10T07:07:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/29642#issuecomment-2219723278",
            "id": 2219723278,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29642",
            "node_id": "IC_kwDOAPphoM6ETkoO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2219723278/reactions"
            },
            "updated_at": "2024-07-10T07:07:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2219723278",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/98568237?v=4",
                "events_url": "https://api.github.com/users/a73s/events{/privacy}",
                "followers_url": "https://api.github.com/users/a73s/followers",
                "following_url": "https://api.github.com/users/a73s/following{/other_user}",
                "gists_url": "https://api.github.com/users/a73s/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/a73s",
                "id": 98568237,
                "login": "a73s",
                "node_id": "U_kgDOBeAILQ",
                "organizations_url": "https://api.github.com/users/a73s/orgs",
                "received_events_url": "https://api.github.com/users/a73s/received_events",
                "repos_url": "https://api.github.com/users/a73s/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/a73s/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/a73s/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/a73s"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/29642/comments",
    "created_at": "2024-07-10T06:42:54Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/29642/events",
    "html_url": "https://github.com/neovim/neovim/issues/29642",
    "id": 2399889886,
    "labels": [
        {
            "color": "e6e6e6",
            "default": false,
            "description": "Issues that are closed as \"invalid\"",
            "id": 77997477,
            "name": "closed:invalid",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Nw==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/closed:invalid"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/29642/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6PC2ne",
    "number": 29642,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/29642/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/29642/timeline",
    "title": "No focus gained event while in insert mode",
    "updated_at": "2024-07-10T07:07:55Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/29642",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/98568237?v=4",
        "events_url": "https://api.github.com/users/a73s/events{/privacy}",
        "followers_url": "https://api.github.com/users/a73s/followers",
        "following_url": "https://api.github.com/users/a73s/following{/other_user}",
        "gists_url": "https://api.github.com/users/a73s/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/a73s",
        "id": 98568237,
        "login": "a73s",
        "node_id": "U_kgDOBeAILQ",
        "organizations_url": "https://api.github.com/users/a73s/orgs",
        "received_events_url": "https://api.github.com/users/a73s/received_events",
        "repos_url": "https://api.github.com/users/a73s/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/a73s/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/a73s/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/a73s"
    }
}