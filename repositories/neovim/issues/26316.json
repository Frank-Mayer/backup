{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nOriginally found in nvim-treesitter/nvim-treesitter#5736, I think it's better to report here as well.\r\n\r\nUsing injection.combined seems to be inconsistent with certain languages.\n\n### Steps to reproduce\n\n- `minimal_init.lua`:\r\n```lua\r\nfor name, url in pairs{\r\n  -- ADD PLUGINS _NECESSARY_ TO REPRODUCE THE ISSUE, e.g:\r\n  [\"nvim-treesitter\"] = 'https://github.com/amaanq/nvim-treesitter'\r\n} do\r\n  local install_path = vim.fn.fnamemodify('nvim_issue/'..name, ':p')\r\n  if vim.fn.isdirectory(install_path) == 0 then\r\n    vim.fn.system { 'git', 'clone', '--depth=1', url, '--branch', 'rust-inj', install_path }\r\n  end\r\n  vim.opt.runtimepath:append(install_path)\r\nend\r\n\r\nrequire('nvim-treesitter.configs').setup({\r\n  ensure_installed = { \"rust\" },\r\n  highlight = { enable = true }\r\n})\r\n```\r\n\r\n- `nvim --clean -u minimal_init.lua nvim_issue/nvim-treesitter/tests/indent/rust/macro.rs`\r\n- Received this error:\r\n```\r\n  vim/_editor.lua:0: command line..script nvim_exec2() called at command line:0..BufReadPost Autocommands for \"*\": Vim(append):Error executing lua callback: ...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:24: Error executing lua: ...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:25: command line..script nvim_exec2() called at command line:0..BufReadPost Autocommands for \"*\"..FileType Autocommands for \"*\": Vim(append):Error executing lua callback: ...4/share/nvim/runtime/lua/vim/treesitter/languagetree.lua:264: Ranges can only be made from 6 element long tables or nodes.\r\n            stack traceback:\r\n            \t[C]: in function 'set_included_ranges'\r\n            \t...4/share/nvim/runtime/lua/vim/treesitter/languagetree.lua:264: in function 'parse'\r\n            \t...4/share/nvim/runtime/lua/vim/treesitter/languagetree.lua:316: in function 'parse'\r\n            \t...r/nvim-linux64/share/nvim/runtime/lua/vim/treesitter.lua:89: in function '_create_parser'\r\n            \t...r/nvim-linux64/share/nvim/runtime/lua/vim/treesitter.lua:131: in function 'get_parser'\r\n            \t...r/nvim-linux64/share/nvim/runtime/lua/vim/treesitter.lua:459: in function 'start'\r\n            \t.../start/nvim-treesitter/lua/nvim-treesitter/highlight.lua:20: in function 'attach'\r\n            \t...er/start/nvim-treesitter/lua/nvim-treesitter/configs.lua:509: in function 'attach_module'\r\n            \t...er/start/nvim-treesitter/lua/nvim-treesitter/configs.lua:532: in function 'reattach_module'\r\n            \t...er/start/nvim-treesitter/lua/nvim-treesitter/configs.lua:133: in function <...er/start/nvim-treesitter/lua/nvim-treesitter/configs.lua:132>\r\n            \t[C]: in function 'nvim_cmd'\r\n            \t...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:25: in function <...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:24>\r\n            \t[C]: in function 'nvim_buf_call'\r\n            \t...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:24: in function <...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:10>\r\n            \t[builtin#36]: at 0x5638e2e473e0\r\n            \t...k/plenary.nvim/start/plenary.nvim/lua/plenary/busted.lua:267: in function 'run'\r\n            \t[string \":lua\"]:1: in main chunk\r\n            stack traceback:\r\n            \t[C]: in function 'nvim_cmd'\r\n            \t...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:25: in function <...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:24>\r\n            \t[C]: in function 'nvim_buf_call'\r\n            \t...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:24: in function <...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:10>\r\n            \t[builtin#36]: at 0x5638e2e473e0\r\n            \t...k/plenary.nvim/start/plenary.nvim/lua/plenary/busted.lua:267: in function 'run'\r\n            \t[string \":lua\"]:1: in main chunk\r\n            stack traceback:\r\n            \t[C]: in function 'nvim_buf_call'\r\n            \t...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:24: in function <...-treesitter/nvim-linux64/share/nvim/runtime/filetype.lua:10>\r\n            \t[builtin#36]: at 0x5638e2e473e0\r\n            \t...k/plenary.nvim/start/plenary.nvim/lua/plenary/busted.lua:267: in function 'run'\r\n            \t[string \":lua\"]:1: in main chunk\r\n            \r\n            stack traceback:\r\n            \tvim/_editor.lua: in function 'cmd'\r\n            \t./tests/indent/common.lua:98: in function 'run_indent_test'\r\n            \t./tests/indent/common.lua:118: in function 'indent_whole_file'\r\n            \t./tests/indent/common.lua:187: in function <./tests/indent/common.lua:186>\r\n```\n\n### Expected behavior\n\nIt should not errors out if possible\n\n### Neovim version (nvim -v)\n\n0.9.5-dev-dbe27f45b2ddc233e47d4150562850e429580bfa\n\n### Vim (not Nvim) behaves the same?\n\nN/A\n\n### Operating system/version\n\nLinux 6.6.2\n\n### Terminal name/version\n\nkitty 0.31.0\n\n### $TERM environment variable\n\nxterm-kitty\n\n### Installation\n\nBuild from repo",
    "closed_at": "2024-01-23T18:58:49Z",
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "maybe https://github.com/neovim/neovim/pull/25195 fixed the issue, but it's not ported to stable.",
            "created_at": "2023-12-23T14:53:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/26316#issuecomment-1868310009",
            "id": 1868310009,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26316",
            "node_id": "IC_kwDOAPphoM5vXCX5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1868310009/reactions"
            },
            "updated_at": "2023-12-23T14:53:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1868310009",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/19489738?v=4",
                "events_url": "https://api.github.com/users/tomtomjhj/events{/privacy}",
                "followers_url": "https://api.github.com/users/tomtomjhj/followers",
                "following_url": "https://api.github.com/users/tomtomjhj/following{/other_user}",
                "gists_url": "https://api.github.com/users/tomtomjhj/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tomtomjhj",
                "id": 19489738,
                "login": "tomtomjhj",
                "node_id": "MDQ6VXNlcjE5NDg5NzM4",
                "organizations_url": "https://api.github.com/users/tomtomjhj/orgs",
                "received_events_url": "https://api.github.com/users/tomtomjhj/received_events",
                "repos_url": "https://api.github.com/users/tomtomjhj/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tomtomjhj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tomtomjhj/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tomtomjhj"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "It is #25195. The combined table on stable is the same as before the PR",
            "created_at": "2023-12-24T07:58:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/26316#issuecomment-1868456671",
            "id": 1868456671,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/26316",
            "node_id": "IC_kwDOAPphoM5vXmLf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1868456671/reactions"
            },
            "updated_at": "2023-12-24T07:58:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1868456671",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/29790821?v=4",
                "events_url": "https://api.github.com/users/lucario387/events{/privacy}",
                "followers_url": "https://api.github.com/users/lucario387/followers",
                "following_url": "https://api.github.com/users/lucario387/following{/other_user}",
                "gists_url": "https://api.github.com/users/lucario387/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lucario387",
                "id": 29790821,
                "login": "lucario387",
                "node_id": "MDQ6VXNlcjI5NzkwODIx",
                "organizations_url": "https://api.github.com/users/lucario387/orgs",
                "received_events_url": "https://api.github.com/users/lucario387/received_events",
                "repos_url": "https://api.github.com/users/lucario387/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lucario387/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lucario387/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lucario387"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/26316/comments",
    "created_at": "2023-11-30T04:12:04Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/26316/events",
    "html_url": "https://github.com/neovim/neovim/issues/26316",
    "id": 2017838585,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1799626557,
            "name": "treesitter",
            "node_id": "MDU6TGFiZWwxNzk5NjI2NTU3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/treesitter"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/26316/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM54RcX5",
    "number": 26316,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/26316/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/26316/timeline",
    "title": "`injection.combined` seems to be treated differently between nightly and stable",
    "updated_at": "2024-01-23T18:58:49Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/26316",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/29790821?v=4",
        "events_url": "https://api.github.com/users/lucario387/events{/privacy}",
        "followers_url": "https://api.github.com/users/lucario387/followers",
        "following_url": "https://api.github.com/users/lucario387/following{/other_user}",
        "gists_url": "https://api.github.com/users/lucario387/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/lucario387",
        "id": 29790821,
        "login": "lucario387",
        "node_id": "MDQ6VXNlcjI5NzkwODIx",
        "organizations_url": "https://api.github.com/users/lucario387/orgs",
        "received_events_url": "https://api.github.com/users/lucario387/received_events",
        "repos_url": "https://api.github.com/users/lucario387/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/lucario387/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lucario387/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/lucario387"
    }
}