{
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
        "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
        "followers_url": "https://api.github.com/users/MariaSolOs/followers",
        "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
        "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/MariaSolOs",
        "id": 62502207,
        "login": "MariaSolOs",
        "node_id": "MDQ6VXNlcjYyNTAyMjA3",
        "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
        "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
        "repos_url": "https://api.github.com/users/MariaSolOs/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/MariaSolOs"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
            "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
            "followers_url": "https://api.github.com/users/MariaSolOs/followers",
            "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
            "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/MariaSolOs",
            "id": 62502207,
            "login": "MariaSolOs",
            "node_id": "MDQ6VXNlcjYyNTAyMjA3",
            "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
            "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
            "repos_url": "https://api.github.com/users/MariaSolOs/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/MariaSolOs"
        }
    ],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\r\n\r\nCommit 853f647 refactors how the values for `textDocument.completion.completionItemKind.valueSet` are calculated. Before this commit the value was\r\n```\r\nvalueSet = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25 }\r\n```\r\ni.e. a simple array. With this commit it changed into a complex type:\r\n```\r\nvalueSet = { { 1, \"Text\",\r\n  <metatable> = <1>{}\r\n}, { 2, \"Method\",\r\n  <metatable> = <table 1>\r\n}, { 3, \"Function\",\r\n  <metatable> = <table 1>\r\n}, { 4, \"Constructor\",\r\n  <metatable> = <table 1>\r\n}, { 5, \"Field\",\r\n  <metatable> = <table 1>\r\n}, { 6, \"Variable\",\r\n  <metatable> = <table 1>\r\n}, { 7, \"Class\",\r\n  <metatable> = <table 1>\r\n}, { 8, \"Interface\",\r\n  <metatable> = <table 1>\r\n}, { 9, \"Module\",\r\n  <metatable> = <table 1>\r\n}, { 10, \"Property\",\r\n  <metatable> = <table 1>\r\n}, { 11, \"Unit\",\r\n  <metatable> = <table 1>\r\n}, { 12, \"Value\",\r\n  <metatable> = <table 1>\r\n}, { 13, \"Enum\",\r\n  <metatable> = <table 1>\r\n}, { 14, \"Keyword\",\r\n  <metatable> = <table 1>\r\n}, { 15, \"Snippet\",\r\n  <metatable> = <table 1>\r\n}, { 16, \"Color\",\r\n  <metatable> = <table 1>\r\n}, { 17, \"File\",\r\n  <metatable> = <table 1>\r\n}, { 18, \"Reference\",\r\n  <metatable> = <table 1>\r\n}, { 19, \"Folder\",\r\n  <metatable> = <table 1>\r\n}, { 20, \"EnumMember\",\r\n  <metatable> = <table 1>\r\n}, { 21, \"Constant\",\r\n  <metatable> = <table 1>\r\n}, { 22, \"Struct\",\r\n  <metatable> = <table 1>\r\n}, { 23, \"Event\",\r\n  <metatable> = <table 1>\r\n}, { 24, \"Operator\",\r\n  <metatable> = <table 1>\r\n}, { 25, \"TypeParameter\",\r\n  <metatable> = <table 1>\r\n} }\r\n```\r\nand when sending this to `gopls` it will respond with\r\n```\r\nRPC[Error] code_name = ParseError, message = \"JSON RPC parse error: json: cannot unmarshal array into Go struct field\r\n ClientSymbolKindOptions.capabilities.workspace.symbol.symbolKind.valueSet of type protocol.SymbolKind\r\n```\r\n\r\nP.S.: This most likely also affects the other `valueSet` elements that use the new `get_value_set()` function but `gopls` will stop on the first error from the top.\r\n\r\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\r\n\r\n```lua\r\nlocal pattern = \"go\"\r\nlocal cmd = { \"gopls\" }\r\n-- Add files/folders here that indicate the root of a project\r\nlocal root_markers = { \".git\", \".editorconfig\" }\r\n-- Change to table with settings if required\r\nlocal settings = vim.empty_dict()\r\n\r\nvim.api.nvim_create_autocmd(\"FileType\", {\r\n\tpattern = pattern,\r\n\tcallback = function(args)\r\n\t\tlocal match = vim.fs.find(root_markers, { path = args.file, upward = true })[1]\r\n\t\tlocal root_dir = match and vim.fn.fnamemodify(match, \":p:h\") or nil\r\n\t\tvim.lsp.start({\r\n\t\t\tname = \"gopls\",\r\n\t\t\tcmd = cmd,\r\n\t\t\troot_dir = root_dir,\r\n\t\t\tsettings = settings,\r\n\t\t})\r\n\tend,\r\n})\r\n```\r\n\r\n### Expected behavior\r\n\r\nThe language server should not complain about values sent to it and start regularly.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nv0.10.0-dev-2480+g0eaae1bc0\r\n\r\n### Language server name/version\r\n\r\ngopls 0.15.1\r\n\r\n### Operating system/version\r\n\r\nArch Linux\r\n\r\n### Log file\r\n\r\n_No response_",
    "closed_at": "2024-02-29T10:37:32Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "I can confirm that I'm getting the same `RPC[Error]` and that the issue started from commit [853f647](https://github.com/neovim/neovim/commit/853f647da618d2891e4ac513fb96d3c8a42fa131). Prior to the offending commit there were no issues.",
            "created_at": "2024-02-29T09:10:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/27669#issuecomment-1970711250",
            "id": 1970711250,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27669",
            "node_id": "IC_kwDOAPphoM51dqrS",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1970711250/reactions"
            },
            "updated_at": "2024-02-29T09:10:50Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1970711250",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/13462818?v=4",
                "events_url": "https://api.github.com/users/cleong14/events{/privacy}",
                "followers_url": "https://api.github.com/users/cleong14/followers",
                "following_url": "https://api.github.com/users/cleong14/following{/other_user}",
                "gists_url": "https://api.github.com/users/cleong14/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/cleong14",
                "id": 13462818,
                "login": "cleong14",
                "node_id": "MDQ6VXNlcjEzNDYyODE4",
                "organizations_url": "https://api.github.com/users/cleong14/orgs",
                "received_events_url": "https://api.github.com/users/cleong14/received_events",
                "repos_url": "https://api.github.com/users/cleong14/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/cleong14/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cleong14/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/cleong14"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "should work ,  seems like no reason to use iterators here.  you always have to range through the entire kind table before sending the rpc request.\r\n\r\n```diff\r\ndiff --git a/runtime/lua/vim/lsp/protocol.lua b/runtime/lua/vim/lsp/protocol.lua\r\nindex fa614780c..90d625ff8 100644\r\n--- a/runtime/lua/vim/lsp/protocol.lua\r\n+++ b/runtime/lua/vim/lsp/protocol.lua\r\n@@ -1,9 +1,14 @@\r\n --- @diagnostic disable: duplicate-doc-alias\r\n\r\n local function get_value_set(t)\r\n-  return vim.iter.filter(function(i)\r\n+  local it = vim.iter(t):filter(function(i)\r\n     return type(i) == 'number'\r\n-  end, ipairs(t))\r\n+  end)\r\n+  local tbl = {}\r\n+  for i in it:enumerate() do\r\n+    tbl[#tbl + 1] = i\r\n+  end\r\n+  return tbl\r\n end\r\n\r\n```",
            "created_at": "2024-02-29T09:13:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/27669#issuecomment-1970715941",
            "id": 1970715941,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27669",
            "node_id": "IC_kwDOAPphoM51dr0l",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1970715941/reactions"
            },
            "updated_at": "2024-02-29T09:14:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1970715941",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The issue here is that the table fastpath doesn't work if the input is not a list. You'll have to manually `fold` the result.\r\n\r\n(This is another reason why putting the reverse lookup in the same table is bad. _really_ bad.)",
            "created_at": "2024-02-29T09:35:37Z",
            "html_url": "https://github.com/neovim/neovim/issues/27669#issuecomment-1970750564",
            "id": 1970750564,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27669",
            "node_id": "IC_kwDOAPphoM51d0Rk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1970750564/reactions"
            },
            "updated_at": "2024-02-29T09:35:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1970750564",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27669/comments",
    "created_at": "2024-02-29T08:24:15Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27669/events",
    "html_url": "https://github.com/neovim/neovim/issues/27669",
    "id": 2160685268,
    "labels": [
        {
            "color": "f9d0c4",
            "default": false,
            "description": "wrong behavior that was introduced in a previous commit (please bisect)",
            "id": 619474658,
            "name": "bug-regression",
            "node_id": "MDU6TGFiZWw2MTk0NzQ2NTg=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-regression"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue has been tracked to a specific commit",
            "id": 1481421490,
            "name": "has:bisected",
            "node_id": "MDU6TGFiZWwxNDgxNDIxNDkw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:bisected"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27669/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6AyXDU",
    "number": 27669,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27669/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27669/timeline",
    "title": "853f647 breaks textDocument.completion.completionItemKind.valueSet (at least for gopls)",
    "updated_at": "2024-02-29T10:37:32Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27669",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/886200?v=4",
        "events_url": "https://api.github.com/users/wilriker/events{/privacy}",
        "followers_url": "https://api.github.com/users/wilriker/followers",
        "following_url": "https://api.github.com/users/wilriker/following{/other_user}",
        "gists_url": "https://api.github.com/users/wilriker/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/wilriker",
        "id": 886200,
        "login": "wilriker",
        "node_id": "MDQ6VXNlcjg4NjIwMA==",
        "organizations_url": "https://api.github.com/users/wilriker/orgs",
        "received_events_url": "https://api.github.com/users/wilriker/received_events",
        "repos_url": "https://api.github.com/users/wilriker/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/wilriker/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/wilriker/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/wilriker"
    }
}