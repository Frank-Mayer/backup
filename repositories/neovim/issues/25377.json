{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nI'm looking for a way to improve the startup experience of Neovide, to create the window with the correct size from the start and fix some other startup related sizing issue.\r\n\r\nBut the problem is that there does not seem to any way to ensure that all the GUI options (for example the font), all our options related to the window, (for example padding), the `lines`, `columns`, and the `colorscheme` are set. This is required in order to be able to correctly resize the window. \r\n\r\nIf the options are set directly in `init.vim/lua` then we receive several draw batches where each one sets a single option. So, this is not good.\r\n\r\nSetting all those options inside the `UIEnter` autocommand is a little bit better as long as none of the options are set elsewhere.\r\n\r\nBut this is totally out of the user control when using a plugin like `lazy.nvim`, which can potentially do a lot of stuff before `UIEnter`, making it basically useless for about anything. This happens for example when new plugins are installed at startup.\r\n\r\nThe workaround is to load a `ginit.vim/lua` file or similar before calling `nvim_ui_attach`. But the problem is that anyhing setup there is overwritten by what's passed to `nvim_ui_attach`. So, the only workaround I see is to get the option values manually, and then pass them on to `nvim_ui_attach`. \r\n\r\nI consider this a bug, and IMO `UIEnter` should always be called before anything is requested to be drawn on the screen. NOTE: the workaround of waiting for `UIEnter` before showing anything does not work, since then nothing is displayed when `lazy.nvim` installs the plugins.\n\n### Steps to reproduce\n\nLaunch a lazy.nvim configuration with some plugins not installed.\r\nObserve that multiple UI draw batches are received until UIEnter is called.\n\n### Expected behavior\n\n`UIEnter` should be called before anything is drawn.\n\n### Neovim version (nvim -v)\n\n0.9.2\n\n### Vim (not Nvim) behaves the same?\n\nN/A\n\n### Operating system/version\n\nWindows 11 / Arch Linux WSL\n\n### Terminal name/version\n\nNeovide 11.2\n\n### $TERM environment variable\n\nN/A\n\n### Installation\n\npacman",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "I don't think it's possible to fix this without cause other breakages:\r\n- User config may check for attached UI\r\n- User config may cause redraw and UI flush\r\n- User config may even require UI interaction\r\n- UIEnter needs to be triggered after user config is sourced",
            "created_at": "2023-09-26T22:16:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/25377#issuecomment-1736378345",
            "id": 1736378345,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25377",
            "node_id": "IC_kwDOAPphoM5nfwfp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1736378345/reactions"
            },
            "updated_at": "2023-09-26T22:21:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1736378345",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I was thinking that `UIEnter` could be called if it's setup when the first draw request is made, but I think you are right that there are potentially too many breakages.\r\n\r\nI wonder what the options could be, I imagine that we are not the only one that would like to setup our GUI options before anything is drawn. \r\n\r\nHere are a few alternatives:\r\n1. Do nothing, let the GUIs use their own setup files like `ginit.vim/lua` if they prefer.\r\n2. Make `ginit.vim/lua` more officially supported\r\n3. Don't send any flushes until an actual draw request needs to be done (just setting columns/lines is not considered as a such)\r\n4. Add another autocommand that can be used for this\r\n5. Have some kind of signal in the config that triggers the UI ready to be shown. And this is automatically set when an error is shown or when `UIEnter` happens, in case the user forgets, and would not deal with `lazy.nvim` for example.\r\n\r\nI think, I would prefer 3. But that also means that there's no good workarounds until it's implemented and a new release of Neovim is made. I could implement 1. now, and move on to 2. when it's supported.",
            "created_at": "2023-09-26T23:06:44Z",
            "html_url": "https://github.com/neovim/neovim/issues/25377#issuecomment-1736420927",
            "id": 1736420927,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25377",
            "node_id": "IC_kwDOAPphoM5nf64_",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1736420927/reactions"
            },
            "updated_at": "2023-09-26T23:06:44Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1736420927",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "And it looks like @justinmk wasn't that enthusiastic about `ginit` here https://github.com/neovim/neovim/issues/3656#issuecomment-155856453",
            "created_at": "2023-09-26T23:12:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/25377#issuecomment-1736424973",
            "id": 1736424973,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25377",
            "node_id": "IC_kwDOAPphoM5nf74N",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1736424973/reactions"
            },
            "updated_at": "2023-09-26T23:12:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1736424973",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think the real problems are these:\r\n> User config may cause redraw and UI flush\r\n> User config may even require UI interaction\r\n\r\nVim does not allow this https://vimhelp.org/gui.txt.html#GUI\r\n> But the [GUI](https://vimhelp.org/gui.txt.html#GUI) [window](https://vimhelp.org/windows.txt.html#window) [is](https://vimhelp.org/motion.txt.html#is) only opened after all the initializations have been\r\ncarried out.\r\n\r\nAllowing interaction and redrawing also does not go well with the possibility of starting Neovim without an UI with `--headless`. \r\n\r\nThe original design of calling `GUIEnter` before `VimEnter` also neatly solves a lot of the problems, since then we are guaranteed to have the correct grid size for example, when `VimEnter` is called. Furthermore `lazy.nvim` could start its installation process here, or preferably even after that, but before `VimEnter` is called.",
            "created_at": "2023-09-27T09:54:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/25377#issuecomment-1737080563",
            "id": 1737080563,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/25377",
            "node_id": "IC_kwDOAPphoM5nib7z",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1737080563/reactions"
            },
            "updated_at": "2023-09-27T09:54:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1737080563",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/25377/comments",
    "created_at": "2023-09-26T22:00:17Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/25377/events",
    "html_url": "https://github.com/neovim/neovim/issues/25377",
    "id": 1914362675,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "UI extensibility, events, protocol",
            "id": 640132777,
            "name": "ui-ext",
            "node_id": "MDU6TGFiZWw2NDAxMzI3Nzc=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui-ext"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "Nvim startup sequence (`:h startup`)",
            "id": 870629450,
            "name": "startup",
            "node_id": "MDU6TGFiZWw4NzA2Mjk0NTA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/startup"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "events, autocommands",
            "id": 3341085842,
            "name": "events",
            "node_id": "MDU6TGFiZWwzMzQxMDg1ODQy",
            "url": "https://api.github.com/repos/neovim/neovim/labels/events"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/25377/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5yGtsz",
    "number": 25377,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/25377/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/25377/timeline",
    "title": "UI flush can be called before UIEnter",
    "updated_at": "2023-09-27T09:54:20Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/25377",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
        "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
        "followers_url": "https://api.github.com/users/fredizzimo/followers",
        "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
        "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/fredizzimo",
        "id": 9946255,
        "login": "fredizzimo",
        "node_id": "MDQ6VXNlcjk5NDYyNTU=",
        "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
        "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
        "repos_url": "https://api.github.com/users/fredizzimo/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/fredizzimo"
    }
}