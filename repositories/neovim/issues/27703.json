{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\nSemantics highlighting gets shifted after leaving insert mode on indented line in Dart, tried to reproduce it in Typescript but everything seemed to be working fine.\r\n\r\nDisabling Dart client semantics capability stops this behaviour.\r\n\r\nhttps://github.com/neovim/neovim/assets/44223680/c8c840d3-220a-4dc3-a82f-d9c966f177c4\r\n\r\n\r\n\r\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\r\n\r\n1. Create pubspec.yaml\r\n```yaml\r\nname: example\r\ndescription: A sample command-line application.\r\nversion: 1.0.0\r\n``` \r\n2. Create example.dart file\r\n```dart\r\nclass Example {\r\n  final Example? child;\r\n  final Example Function(Example example)? fn;\r\n\r\n  Example({this.child, this.fn});\r\n\r\n  Example build() => Example(\r\n        fn: (Example example) => Example(\r\n          child: Example(child: example.identity()),\r\n        ),\r\n      );\r\n\r\n  Example identity() {\r\n    return this;\r\n  }\r\n}\r\n```\r\n3. Install treesitter & setup Dart (https://dart.dev/get-dart)\r\n```lua\r\nlocal lazypath = \"/tmp/semantics-lazy\"\r\nif not vim.loop.fs_stat(lazypath) then\r\n    vim.fn.system({\r\n        \"git\",\r\n        \"clone\",\r\n        \"--filter=blob:none\",\r\n        \"https://github.com/folke/lazy.nvim.git\",\r\n        \"--branch=stable\", -- latest stable release\r\n        lazypath,\r\n    })\r\nend\r\n\r\nvim.opt.rtp:prepend(lazypath)\r\n\r\nrequire(\"lazy\").setup({\r\n    {\r\n        \"neovim/nvim-lspconfig\",\r\n        config = function()\r\n            require(\"lspconfig\").dartls.setup({\r\n                capabilities = vim.lsp.protocol.make_client_capabilities(),\r\n            })\r\n        end\r\n    },\r\n})\r\n```\r\n4. Start new line where created indent would be big enough and go to normal mode\r\n\r\n### Expected behavior\r\n\r\nHighlighting should not shift.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.9.5 (tried to build nvim from master too, same thing)\r\n\r\n### Language server name/version\r\n\r\nDart SDK version: 3.3.0 (stable)\r\n\r\n### Operating system/version\r\n\r\nMacos\r\n\r\n### Log file\r\n\r\nhttps://gist.github.com/dainiusm07/e3e43a5499cdda39e9b457caf45aeccc",
    "closed_at": "2024-03-02T09:39:17Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Is the nvim-treesitter bit really necessary?",
            "created_at": "2024-03-02T09:12:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/27703#issuecomment-1974739540",
            "id": 1974739540,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27703",
            "node_id": "IC_kwDOAPphoM51tCJU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974739540/reactions"
            },
            "updated_at": "2024-03-02T09:16:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974739540",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "You are right, it is not. I thought without it there will be no highlighting at all. My bad ",
            "created_at": "2024-03-02T09:13:29Z",
            "html_url": "https://github.com/neovim/neovim/issues/27703#issuecomment-1974739840",
            "id": 1974739840,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27703",
            "node_id": "IC_kwDOAPphoM51tCOA",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974739840/reactions"
            },
            "updated_at": "2024-03-02T09:16:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974739840",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/44223680?v=4",
                "events_url": "https://api.github.com/users/dainiusm07/events{/privacy}",
                "followers_url": "https://api.github.com/users/dainiusm07/followers",
                "following_url": "https://api.github.com/users/dainiusm07/following{/other_user}",
                "gists_url": "https://api.github.com/users/dainiusm07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dainiusm07",
                "id": 44223680,
                "login": "dainiusm07",
                "node_id": "MDQ6VXNlcjQ0MjIzNjgw",
                "organizations_url": "https://api.github.com/users/dainiusm07/orgs",
                "received_events_url": "https://api.github.com/users/dainiusm07/received_events",
                "repos_url": "https://api.github.com/users/dainiusm07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dainiusm07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dainiusm07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dainiusm07"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Unless you can produce the same problem with a different server, this is most definitely an issue with dartls.",
            "created_at": "2024-03-02T09:18:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/27703#issuecomment-1974743091",
            "id": 1974743091,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27703",
            "node_id": "IC_kwDOAPphoM51tDAz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974743091/reactions"
            },
            "updated_at": "2024-03-02T09:18:50Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974743091",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991"
            }
        },
        {
            "author_association": "NONE",
            "body": "Tried gopls too, no issue with that. Yeah, will be an dartls issue.",
            "created_at": "2024-03-02T09:39:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/27703#issuecomment-1974747395",
            "id": 1974747395,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27703",
            "node_id": "IC_kwDOAPphoM51tEED",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974747395/reactions"
            },
            "updated_at": "2024-03-02T09:39:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1974747395",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/44223680?v=4",
                "events_url": "https://api.github.com/users/dainiusm07/events{/privacy}",
                "followers_url": "https://api.github.com/users/dainiusm07/followers",
                "following_url": "https://api.github.com/users/dainiusm07/following{/other_user}",
                "gists_url": "https://api.github.com/users/dainiusm07/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dainiusm07",
                "id": 44223680,
                "login": "dainiusm07",
                "node_id": "MDQ6VXNlcjQ0MjIzNjgw",
                "organizations_url": "https://api.github.com/users/dainiusm07/orgs",
                "received_events_url": "https://api.github.com/users/dainiusm07/received_events",
                "repos_url": "https://api.github.com/users/dainiusm07/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dainiusm07/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dainiusm07/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dainiusm07"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27703/comments",
    "created_at": "2024-03-02T09:09:43Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27703/events",
    "html_url": "https://github.com/neovim/neovim/issues/27703",
    "id": 2164720311,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27703/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6BBwK3",
    "number": 27703,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27703/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27703/timeline",
    "title": "Semantics highlighting gets shifted",
    "updated_at": "2024-03-02T09:39:17Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27703",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/44223680?v=4",
        "events_url": "https://api.github.com/users/dainiusm07/events{/privacy}",
        "followers_url": "https://api.github.com/users/dainiusm07/followers",
        "following_url": "https://api.github.com/users/dainiusm07/following{/other_user}",
        "gists_url": "https://api.github.com/users/dainiusm07/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/dainiusm07",
        "id": 44223680,
        "login": "dainiusm07",
        "node_id": "MDQ6VXNlcjQ0MjIzNjgw",
        "organizations_url": "https://api.github.com/users/dainiusm07/orgs",
        "received_events_url": "https://api.github.com/users/dainiusm07/received_events",
        "repos_url": "https://api.github.com/users/dainiusm07/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/dainiusm07/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dainiusm07/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/dainiusm07"
    }
}