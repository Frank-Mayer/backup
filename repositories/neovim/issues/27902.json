{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nScrolling up/down in output window from running command `:!/bin/cat file.txt` for example does not properly keep contents\n\n### Steps to reproduce\n\nCreate file called `file.txt` with contents:\r\n```\r\n============== SIGNED INTEGERS: \r\n-------------- i8 + ...\r\nvalue = 10\r\n-------------- i16 + ...\r\nvalue = 10\r\nvalue = 10\r\n-------------- i32 + ...\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\n-------------- i64 + ...\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\n-------------- int + ...\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\n============== UNSIGNED INTEGERS: \r\n-------------- u8 + ...\r\nvalue = 10\r\n-------------- u16 + ...\r\nvalue = 10\r\nvalue = 10\r\n-------------- u32 + ...\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\n-------------- u64 + ...\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\n-------------- uint + ...\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\nvalue = 10\r\n```\r\n\r\n- `nvim --clean`\r\n- `:!/bin/cat file.txt`\r\n- scroll up in output window\r\n- scroll down in output window\r\n- the content in the output window is no longer what is was originally\r\n\n\n### Expected behavior\n\nScrolling back down should show the rest of the command output, instead of mixing/forgetting lines of it.\n\n### Neovim version (nvim -v)\n\nv0.9.5\n\n### Vim (not Nvim) behaves the same?\n\nno, vim 9.0\n\n### Operating system/version\n\nmacOS 14.2.1\n\n### Terminal name/version\n\nkitty 0.28.1\n\n### $TERM environment variable\n\nxterm-kitty\n\n### Installation\n\nhomebrew",
    "closed_at": "2024-03-18T14:25:57Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Cannot reproduce. What is the size of the kitty terminal? Or, what does `set lines? columns?` print in Nvim?\r\n\r\nAnd, are you scrolling up/down using the mouse? Maybe you can provide a screen recording?",
            "created_at": "2024-03-17T20:36:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/27902#issuecomment-2002609511",
            "id": 2002609511,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27902",
            "node_id": "IC_kwDOAPphoM53XWVn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002609511/reactions"
            },
            "updated_at": "2024-03-17T22:18:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002609511",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "NONE",
            "body": "Yes here's the size it's running at and also a recording\r\n\r\nIt seems to only happen at certain window sizes\r\n```\r\ninitial_window_width 120c\r\ninitial_window_height 31c\r\n```\r\n\r\nUsing mouse\r\n\r\nhttps://github.com/neovim/neovim/assets/14429506/6f8798a5-8d1a-4360-9bed-c229fdfccdbc\r\n\r\nAlso `lines=31` and `columns=120`\r\n",
            "created_at": "2024-03-18T00:04:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/27902#issuecomment-2002669361",
            "id": 2002669361,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27902",
            "node_id": "IC_kwDOAPphoM53Xk8x",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002669361/reactions"
            },
            "updated_at": "2024-03-18T00:06:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002669361",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/14429506?v=4",
                "events_url": "https://api.github.com/users/IsaacShelton/events{/privacy}",
                "followers_url": "https://api.github.com/users/IsaacShelton/followers",
                "following_url": "https://api.github.com/users/IsaacShelton/following{/other_user}",
                "gists_url": "https://api.github.com/users/IsaacShelton/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/IsaacShelton",
                "id": 14429506,
                "login": "IsaacShelton",
                "node_id": "MDQ6VXNlcjE0NDI5NTA2",
                "organizations_url": "https://api.github.com/users/IsaacShelton/orgs",
                "received_events_url": "https://api.github.com/users/IsaacShelton/received_events",
                "repos_url": "https://api.github.com/users/IsaacShelton/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/IsaacShelton/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/IsaacShelton/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/IsaacShelton"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This bug seems to happen whenever output ends with a new line. It happens with `:echo` too:\r\n```vim\r\n:echo range(1000)->join(\"\\n\") .. \"\\n\"\r\n```",
            "created_at": "2024-03-18T02:51:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/27902#issuecomment-2002780826",
            "id": 2002780826,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27902",
            "node_id": "IC_kwDOAPphoM53YAKa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002780826/reactions"
            },
            "updated_at": "2024-03-18T02:51:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2002780826",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This change seems to fix the problem:\r\n```diff\r\ndiff --git a/src/nvim/message.c b/src/nvim/message.c\r\nindex 2725ad02c..06fd0511d 100644\r\n--- a/src/nvim/message.c\r\n+++ b/src/nvim/message.c\r\n@@ -1317,10 +1317,10 @@ static void hit_return_msg(void)\r\n {\r\n   int save_p_more = p_more;\r\n \r\n-  p_more = false;       // don't want to see this message when scrolling back\r\n   if (msg_didout) {     // start on a new line\r\n     msg_putchar('\\n');\r\n   }\r\n+  p_more = false;       // don't want to see this message when scrolling back\r\n   msg_ext_set_kind(\"return_prompt\");\r\n   if (got_int) {\r\n     msg_puts(_(\"Interrupt: \"));\r\n```\r\nBut I'm not entirely sure about it.",
            "created_at": "2024-03-18T12:45:36Z",
            "html_url": "https://github.com/neovim/neovim/issues/27902#issuecomment-2003816246",
            "id": 2003816246,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27902",
            "node_id": "IC_kwDOAPphoM53b882",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2003816246/reactions"
            },
            "updated_at": "2024-03-18T12:45:36Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2003816246",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27902/comments",
    "created_at": "2024-03-17T18:22:45Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27902/events",
    "html_url": "https://github.com/neovim/neovim/issues/27902",
    "id": 2190801976,
    "labels": [
        {
            "color": "F9D0C4",
            "default": false,
            "description": "wrong behavior inherited from vim",
            "id": 154310492,
            "name": "bug-vim",
            "node_id": "MDU6TGFiZWwxNTQzMTA0OTI=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-vim"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 2699293736,
            "name": "pager",
            "node_id": "MDU6TGFiZWwyNjk5MjkzNzM2",
            "url": "https://api.github.com/repos/neovim/neovim/labels/pager"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "UI messages, log messages",
            "id": 5637083595,
            "name": "messages",
            "node_id": "LA_kwDOAPphoM8AAAABT_8Ryw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/messages"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27902/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6ClPw4",
    "number": 27902,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27902/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27902/timeline",
    "title": "[bug] Scrolling in command output window shows incorrect text",
    "updated_at": "2024-03-18T14:25:57Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27902",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/14429506?v=4",
        "events_url": "https://api.github.com/users/IsaacShelton/events{/privacy}",
        "followers_url": "https://api.github.com/users/IsaacShelton/followers",
        "following_url": "https://api.github.com/users/IsaacShelton/following{/other_user}",
        "gists_url": "https://api.github.com/users/IsaacShelton/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/IsaacShelton",
        "id": 14429506,
        "login": "IsaacShelton",
        "node_id": "MDQ6VXNlcjE0NDI5NTA2",
        "organizations_url": "https://api.github.com/users/IsaacShelton/orgs",
        "received_events_url": "https://api.github.com/users/IsaacShelton/received_events",
        "repos_url": "https://api.github.com/users/IsaacShelton/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/IsaacShelton/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/IsaacShelton/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/IsaacShelton"
    }
}