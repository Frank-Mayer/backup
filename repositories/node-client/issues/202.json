{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "I set `NVIM_NODE_LOG_FILE=\"$HOME/nvim_node_log\"` and I see logging from the node client but not from any of the log statements in my plugin.\r\n\r\nExample logs I'm seeing:\r\n\r\n```\r\n{\"level\":\"debug\",\"message\":\"getPlugin.alwaysInit\"}\r\n{\"level\":\"debug\",\"message\":\"request -> neovim.api.nvim_out_write\"}\r\n{\"level\":\"debug\",\"message\":\"response -> neovim.api.nvim_out_write: null\"}\r\n{\"level\":\"debug\",\"message\":\"host.disconnected\"}\r\n{\"level\":\"debug\",\"message\":\"host.start\"}\r\n{\"level\":\"info\",\"message\":\"handleRequest: \"}\r\n{\"level\":\"debug\",\"message\":\"request received: \"}\r\n{\"level\":\"info\",\"message\":\"handleRequest: \"}\r\n{\"level\":\"debug\",\"message\":\"host.start\"}\r\n```\r\n\r\nI would expect to see the log statements defined in the plugin as well. To reproduce just check if the logs are working in the example bundled with this repo: https://github.com/neovim/node-client/tree/master/examples/rplugin/node/nvim-example\r\n\r\nI'm also not sure if `ALLOW_CONSOLE` has anything to do with this but whenever I set it to `1` for instance but that doesn't seem to do anything either.",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Just some notes:\r\n\r\n- I recently updated the winston dep, maybe it's worth trying again: https://github.com/neovim/node-client/commit/33e6559d032c29c13206a8cfdcb9a8f64b46ed65\r\n- You already are aware, but for reference, node-client seems to monkeypatch console with winston logger: https://github.com/neovim/node-client/blob/c4ba03108dbf5360d17205f43f17a717de95cfa7/README.md?plain=1#L68\r\n\r\n\r\n> not sure if `ALLOW_CONSOLE` has anything to do with this but whenever I set it to `1` for instance but that doesn't seem to do anything either.\r\n\r\nFor reference: https://github.com/neovim/node-client/blob/c4ba03108dbf5360d17205f43f17a717de95cfa7/packages/neovim/src/utils/logger.ts#L21-L27",
            "created_at": "2023-07-16T15:49:18Z",
            "html_url": "https://github.com/neovim/node-client/issues/202#issuecomment-1637124424",
            "id": 1637124424,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/202",
            "node_id": "IC_kwDOAdOzk85hlIlI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1637124424/reactions"
            },
            "updated_at": "2023-07-16T15:49:46Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1637124424",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "This is what I'm seeing now:\r\n\r\n![image](https://github.com/neovim/node-client/assets/29136904/e32161bc-5165-41e4-86ed-275252640873)\r\n\r\nLog:\r\n```\r\nERR 2023-07-27T00:03:39.147 nvim.40391.0 chan_close_with_error:626: RPC: failed to decode msgpack\r\n```\r\n\r\nCode:\r\n\r\n```javascript\r\nmodule.exports = plugin => {\r\n  plugin.setOptions({ dev: false });\r\n\r\n  plugin.registerCommand('EchoMessage', async () => {\r\n    try {\r\n      console.log('EchoMessage'); // <---- this is what is causing the error\r\n      await plugin.nvim.outWrite('Dayman (ah-ah-ah) \\n');\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  }, { sync: false });\r\n};\r\n```\r\n\r\nNode version: v16.18.0\r\nNeovim version: NVIM v0.10.0-dev-722+g7668f89d5\r\nNode Client from checkhealth: \r\n```\r\nNode.js provider (optional) ~\r\n- Node.js: v16.18.0\r\n- Nvim node.js host: /Users/chris/Library/Application Support/fnm/node-versions/v16.18.0/installation/lib/node_modules/neovim/bin/cli.js\r\n- OK Latest \"neovim\" npm/yarn/pnpm package is installed: 4.10.1\r\n```",
            "created_at": "2023-07-27T04:13:28Z",
            "html_url": "https://github.com/neovim/node-client/issues/202#issuecomment-1652882466",
            "id": 1652882466,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/202",
            "node_id": "IC_kwDOAdOzk85ihPwi",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1652882466/reactions"
            },
            "updated_at": "2023-07-27T04:13:28Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1652882466",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/29136904?v=4",
                "events_url": "https://api.github.com/users/ChristianChiarulli/events{/privacy}",
                "followers_url": "https://api.github.com/users/ChristianChiarulli/followers",
                "following_url": "https://api.github.com/users/ChristianChiarulli/following{/other_user}",
                "gists_url": "https://api.github.com/users/ChristianChiarulli/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ChristianChiarulli",
                "id": 29136904,
                "login": "ChristianChiarulli",
                "node_id": "MDQ6VXNlcjI5MTM2OTA0",
                "organizations_url": "https://api.github.com/users/ChristianChiarulli/orgs",
                "received_events_url": "https://api.github.com/users/ChristianChiarulli/received_events",
                "repos_url": "https://api.github.com/users/ChristianChiarulli/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ChristianChiarulli/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ChristianChiarulli/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ChristianChiarulli"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> chan_close_with_error:626: RPC: failed to decode msgpack\r\n\r\nThat sounds like something is writing to the channel, which can happen if code prints to stdout while you are using a stdio channel (as opposed to unix socket / named pipe / TCP). If `console` isn't _actually_ getting patched, I guess it would write to stdout? Can you confirm whether `console` is actually getting monkeypatched?\r\n",
            "created_at": "2023-07-28T23:15:44Z",
            "html_url": "https://github.com/neovim/node-client/issues/202#issuecomment-1656430295",
            "id": 1656430295,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/202",
            "node_id": "IC_kwDOAdOzk85iux7X",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1656430295/reactions"
            },
            "updated_at": "2023-07-28T23:15:44Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1656430295",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/node-client/issues/202/comments",
    "created_at": "2023-05-06T04:40:26Z",
    "events_url": "https://api.github.com/repos/neovim/node-client/issues/202/events",
    "html_url": "https://github.com/neovim/node-client/issues/202",
    "id": 1698441914,
    "labels": [
        {
            "color": "C5DEF5",
            "default": true,
            "description": "",
            "id": 5741349845,
            "name": "documentation",
            "node_id": "LA_kwDOAdOzk88AAAABVjYL1Q",
            "url": "https://api.github.com/repos/neovim/node-client/labels/documentation"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/node-client/issues/202/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAdOzk85lPCq6",
    "number": 202,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/node-client/issues/202/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/node-client",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/node-client/issues/202/timeline",
    "title": "Not seeing logs from my plugin",
    "updated_at": "2024-02-03T00:29:13Z",
    "url": "https://api.github.com/repos/neovim/node-client/issues/202",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/29136904?v=4",
        "events_url": "https://api.github.com/users/ChristianChiarulli/events{/privacy}",
        "followers_url": "https://api.github.com/users/ChristianChiarulli/followers",
        "following_url": "https://api.github.com/users/ChristianChiarulli/following{/other_user}",
        "gists_url": "https://api.github.com/users/ChristianChiarulli/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ChristianChiarulli",
        "id": 29136904,
        "login": "ChristianChiarulli",
        "node_id": "MDQ6VXNlcjI5MTM2OTA0",
        "organizations_url": "https://api.github.com/users/ChristianChiarulli/orgs",
        "received_events_url": "https://api.github.com/users/ChristianChiarulli/received_events",
        "repos_url": "https://api.github.com/users/ChristianChiarulli/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ChristianChiarulli/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ChristianChiarulli/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ChristianChiarulli"
    }
}