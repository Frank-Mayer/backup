{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "`getNvimFromEnv` fails due to a space in the path? We can see it triggers a `'C:\\Program' is not recognized as an internal or external command, operable program or batch file.` error below when it is called which implies it tried to run it.\r\n\r\n```\r\nC:\\>node demo.mjs\r\n'C:\\Program' is not recognized as an internal or external command,\r\noperable program or batch file.\r\nfound:\r\n{\r\n  matches: [],\r\n  invalid: [\r\n    {\r\n      path: 'C:\\\\Program Files\\\\Neovim\\\\bin\\\\nvim.exe',\r\n      error: [Error]\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nhowever then if I hardcode the path it works as shown below\r\n\r\n```lua\r\n  const found = getNvimFromEnv({ orderBy: \"desc\", minVersion: \"0.9.0\" });\r\n  console.log(\"found:\");\r\n  console.log(found)\r\n  const nvim_proc = child_process.spawn(\r\n    // `C:\\\\Program Files\\\\Neovim\\\\bin\\\\nvim-qt.exe`,\r\n    `C:\\\\Program Files\\\\Neovim\\\\bin\\\\nvim.exe`,\r\n    [\"--clean\", \"--embed\"],\r\n    {}\r\n  );\r\n\r\n\r\n  const nvim = attach({ proc: nvim_proc });\r\n  nvim.command(\"vsp | vsp | vsp\");\r\n\r\n  console.log(\"awaiting window\");\r\n  const windows = await nvim.windows;\r\n  assert.deepStrictEqual(windows.length, 4);\r\n  assert.ok(windows[0] instanceof nvim.Window);\r\n\r\n  nvim.window = windows[2];\r\n  console.log(\"awaiting window #2\");\r\n  const win = await nvim.window;\r\n```\r\n\r\n```\r\n\r\nC:\\>node demo.mjs\r\n'C:\\Program' is not recognized as an internal or external command,\r\noperable program or batch file.\r\nfound:\r\n{\r\n  matches: [],\r\n  invalid: [\r\n    {\r\n      path: 'C:\\\\Program Files\\\\Neovim\\\\bin\\\\nvim.exe',\r\n      error: [Error]\r\n    }\r\n  ]\r\n}\r\nawaiting window\r\nawaiting window #2\r\nwaiting for Nvim (pid 968) to exit\r\nNvim exit code: 0\r\n```\r\n\r\nnote that I haven't been able to have it working with `nvim-qt.exe`. Is that expected?\r\n\r\n",
    "closed_at": "2024-03-01T17:15:10Z",
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks for reporting this! Will fix.\r\n\r\n> note that I haven't been able to have it working with `nvim-qt.exe`. Is that expected?\r\n\r\nwhat does \"have it work with nvim-qt\" mean? List the exact steps.",
            "created_at": "2024-02-22T17:56:28Z",
            "html_url": "https://github.com/neovim/node-client/issues/319#issuecomment-1959972019",
            "id": 1959972019,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/319",
            "node_id": "IC_kwDOAdOzk8500syz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1959972019/reactions"
            },
            "updated_at": "2024-02-22T17:57:31Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1959972019",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "You can ignore that nvim-qt.exe but it is basically an alternative binary on Windows. And the node client works in nvim-qt.exe when using the remote plugin",
            "created_at": "2024-02-22T18:48:59Z",
            "html_url": "https://github.com/neovim/node-client/issues/319#issuecomment-1960053486",
            "id": 1960053486,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/319",
            "node_id": "IC_kwDOAdOzk8501Aru",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1960053486/reactions"
            },
            "updated_at": "2024-02-22T18:48:59Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1960053486",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/387346?v=4",
                "events_url": "https://api.github.com/users/saidelike/events{/privacy}",
                "followers_url": "https://api.github.com/users/saidelike/followers",
                "following_url": "https://api.github.com/users/saidelike/following{/other_user}",
                "gists_url": "https://api.github.com/users/saidelike/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/saidelike",
                "id": 387346,
                "login": "saidelike",
                "node_id": "MDQ6VXNlcjM4NzM0Ng==",
                "organizations_url": "https://api.github.com/users/saidelike/orgs",
                "received_events_url": "https://api.github.com/users/saidelike/received_events",
                "repos_url": "https://api.github.com/users/saidelike/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/saidelike/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/saidelike/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/saidelike"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I still don't understand what you mean. I need you to list the exact steps that you expect to work with nvim-qt.exe. \r\n\r\n`nvim-qt.exe` is a GUI which starts a `nvim.exe` child. If you are trying to `attach()` to `nvim-qt.exe`, that won't work. You need to `attach()` to `nvim.exe`.",
            "created_at": "2024-03-01T06:32:53Z",
            "html_url": "https://github.com/neovim/node-client/issues/319#issuecomment-1972593901",
            "id": 1972593901,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/319",
            "node_id": "IC_kwDOAdOzk851k2Tt",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1972593901/reactions"
            },
            "updated_at": "2024-03-01T06:33:52Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1972593901",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "NONE",
            "body": "Yes i also think it won't work as indeed I was trying what you mentions. Sorry for the confusion but i won't list steps as it does not make sense imho. \r\n\r\nBy the way, in the demo.mjs example, i noticed we don't see the gui at all and it is hidden (at least on Windows in my environment). It's that expected? \r\n\r\nAm i missing something obvious here and is there a way to show the nvim.exe window? That would be handy to visually see the lines changed etc. ",
            "created_at": "2024-03-01T07:17:12Z",
            "html_url": "https://github.com/neovim/node-client/issues/319#issuecomment-1972638572",
            "id": 1972638572,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/319",
            "node_id": "IC_kwDOAdOzk851lBNs",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1972638572/reactions"
            },
            "updated_at": "2024-03-01T07:17:34Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1972638572",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/387346?v=4",
                "events_url": "https://api.github.com/users/saidelike/events{/privacy}",
                "followers_url": "https://api.github.com/users/saidelike/followers",
                "following_url": "https://api.github.com/users/saidelike/following{/other_user}",
                "gists_url": "https://api.github.com/users/saidelike/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/saidelike",
                "id": 387346,
                "login": "saidelike",
                "node_id": "MDQ6VXNlcjM4NzM0Ng==",
                "organizations_url": "https://api.github.com/users/saidelike/orgs",
                "received_events_url": "https://api.github.com/users/saidelike/received_events",
                "repos_url": "https://api.github.com/users/saidelike/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/saidelike/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/saidelike/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/saidelike"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Am i missing something obvious here and is there a way to show the nvim.exe window?\r\n\r\nTo attach to a already-running Nvim, you can need to get the socket name from the running Nvim via `:echo v:servername` for example. Then pass the socket name to `attach()`.",
            "created_at": "2024-03-01T07:20:28Z",
            "html_url": "https://github.com/neovim/node-client/issues/319#issuecomment-1972648331",
            "id": 1972648331,
            "issue_url": "https://api.github.com/repos/neovim/node-client/issues/319",
            "node_id": "IC_kwDOAdOzk851lDmL",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1972648331/reactions"
            },
            "updated_at": "2024-03-01T07:20:28Z",
            "url": "https://api.github.com/repos/neovim/node-client/issues/comments/1972648331",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/node-client/issues/319/comments",
    "created_at": "2024-02-22T15:53:37Z",
    "events_url": "https://api.github.com/repos/neovim/node-client/issues/319/events",
    "html_url": "https://github.com/neovim/node-client/issues/319",
    "id": 2149383399,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "",
            "id": 176078510,
            "name": "bug",
            "node_id": "MDU6TGFiZWwxNzYwNzg1MTA=",
            "url": "https://api.github.com/repos/neovim/node-client/labels/bug"
        },
        {
            "color": "C5DEF5",
            "default": true,
            "description": "",
            "id": 5741349845,
            "name": "documentation",
            "node_id": "LA_kwDOAdOzk88AAAABVjYL1Q",
            "url": "https://api.github.com/repos/neovim/node-client/labels/documentation"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/node-client/issues/319/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAdOzk86AHPzn",
    "number": 319,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/node-client/issues/319/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/node-client",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/node-client/issues/319/timeline",
    "title": "Quick start example does not work on Windows: getNvimFromEnv fails",
    "updated_at": "2024-03-01T17:15:10Z",
    "url": "https://api.github.com/repos/neovim/node-client/issues/319",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/387346?v=4",
        "events_url": "https://api.github.com/users/saidelike/events{/privacy}",
        "followers_url": "https://api.github.com/users/saidelike/followers",
        "following_url": "https://api.github.com/users/saidelike/following{/other_user}",
        "gists_url": "https://api.github.com/users/saidelike/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/saidelike",
        "id": 387346,
        "login": "saidelike",
        "node_id": "MDQ6VXNlcjM4NzM0Ng==",
        "organizations_url": "https://api.github.com/users/saidelike/orgs",
        "received_events_url": "https://api.github.com/users/saidelike/received_events",
        "repos_url": "https://api.github.com/users/saidelike/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/saidelike/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/saidelike/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/saidelike"
    }
}